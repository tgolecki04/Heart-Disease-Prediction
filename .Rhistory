gotowy_wykres_2 <- (my_plots[[5]] + my_plots[[6]]) / (my_plots[[7]] + my_plots[[8]])
ggsave(paste0("images/plots/", typ_zmiennej, "_", typ_wykresu, "1.png"), gotowy_wykres_1)
ggsave(paste0("images/plots/", typ_zmiennej, "_", typ_wykresu, "2.png"), gotowy_wykres_2)
}
#| label: Kategoryczne_Wstep
zmienna_wykres(badania, "kategoryczna", "barplot")
zmienna_wykres(badania, "kategoryczna", "pie")
#| warning: false
zmienna_wykres <- function(dane, typ_zmiennej, typ_wykresu) {
my_plots = list()
if (typ_zmiennej == "kategoryczna") {
dane <- dane |>
dplyr::select(where(is.factor))
} else if (typ_zmiennej == "numeryczna") {
dane <- dane |>
dplyr::select(where(is.numeric))
} else {
# nic nie robimy
}
for (i in 1:ncol(dane)) {
kolumna <- colnames(dane)[i]
if (typ_wykresu == "barplot") {
p <- ggplot(dane, aes(x = !!sym(kolumna), fill = !!sym(kolumna))) +
geom_bar(show.legend = FALSE, width = 0.6) +
theme_ipsum_rc() +
ggtitle(kolumna) +
scale_fill_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041"))
} else if (typ_wykresu == "pie") {
p <- dane %>%
dplyr::count(!!sym(kolumna)) %>%
ggplot(aes(x = "", y = n, fill = !!sym(kolumna))) +
geom_bar(stat = "identity", width = 1, color = "white") +
coord_polar(theta = "y") +
theme_minimal() +
ggtitle(kolumna) +
scale_fill_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041"))
} else if (typ_wykresu == "histogram") {
p <- ggplot(dane, aes(x = !!sym(kolumna))) +
geom_histogram(bins = 20, show.legend = FALSE, fill = "#6AAED9", color = "black") +
theme_ipsum_rc() +
ggtitle(kolumna)
} else if (typ_wykresu == "violin") {
p <- ggplot(dane, aes(x = "", y = !!sym(kolumna), fill = "#6AAED9")) +
geom_violin(show.legend = FALSE) +
theme_ipsum_rc() +
ggtitle(kolumna) +
scale_fill_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041"))
} else {
next  # pomiń jeśli nieznany typ wykresu
}
my_plots[[i]] <- p
}
gotowy_wykres_1 <- (my_plots[[1]] + my_plots[[2]]) / (my_plots[[3]] + my_plots[[4]])
gotowy_wykres_2 <- (my_plots[[5]] + my_plots[[6]]) / (my_plots[[7]] + my_plots[[8]])
ggsave(paste0("images/plots/", typ_zmiennej, "_", typ_wykresu, "1.png"), gotowy_wykres_1)
ggsave(paste0("images/plots/", typ_zmiennej, "_", typ_wykresu, "2.png"), gotowy_wykres_2)
}
#| label: Kategoryczne_Wstep
zmienna_wykres(badania, "kategoryczna", "barplot")
zmienna_wykres(badania, "kategoryczna", "pie")
#| echo: false
#| output: false
library(readr)
library(skimr)
library(knitr)
library(tidyverse)
library(corrplot)
library(ggcorrplot)
library(ggthemes)
library(tinythemes)
library(kableExtra)
library(rlang)
library(gridExtra)
library(patchwork)
library(mice)
library(psych)
data <- read.csv2("data/badania.csv", sep=",")
head(data)
tail(data)
nrow(data)
ncol(data)
colnames(data)
skim(data)
badania <- data |>
mutate(
sysBP = as.numeric(sysBP),
diaBP = as.numeric(diaBP),
BMI = as.numeric(BMI),
sex = factor(male, levels = c(0, 1), labels = c("Female", "Male")),
education = factor(education, ordered = TRUE),
currentSmoker = factor(currentSmoker, labels = c("No", "Yes")),
BPMeds = factor(BPMeds, labels = c("No", "Yes")),
prevalentStroke = factor(prevalentStroke, labels = c("No", "Yes")),
prevalentHyp = factor(prevalentHyp, labels = c("No", "Yes")),
diabetes = factor(diabetes, labels = c("No", "Yes")),
TenYearCHD = factor(TenYearCHD, labels = c("No", "Yes"))
) |> dplyr::select(-male)
badania <- badania[order(is.na(badania$glucose), decreasing = TRUE), ]
badania <- dplyr::select(badania, c(1, 16, 2, 10, 11, 13, 12, 9, 14, 8, 4, 3, 5:7, 15))
head(badania)
#| label: NA_columns
#| warning: false
NA_count <- colSums(is.na(badania))[colSums(is.na(badania)) > 0] |>
data.frame()
names(NA_count) <- "count"
NA_count$var = rownames(NA_count)
rownames(NA_count) <- NULL
NA_count <- select(NA_count, c(2,1))
p <- ggplot(NA_count, aes(x = var, y = count)) +
geom_col(show.legend = FALSE, fill = "#6AAED9") +
theme_ipsum_rc() +
geom_text(aes(label = count), vjust = -0.5) +
expand_limits(y = max(NA_count$count) * 1.1) +
labs(title = "Liczba wartości NA w zmiennych")
ggsave("images/plots/na_count_before.png", p)
#| label: NA_rows
NA_df <- data.frame(NA_w_wierszu = rowSums(is.na(badania))) |>
group_by(NA_w_wierszu) |>
summarise(liczebnosc = n())
p <- NA_df |> ggplot(aes(NA_w_wierszu, liczebnosc)) +
geom_col(show.legend = FALSE, fill = "#6AAED9") +
theme_ipsum_rc() +
geom_text(aes(label = liczebnosc), vjust = -0.5) +
expand_limits(y = max(NA_df$liczebnosc) * 1.1) +
labs(title = "Liczba wartości NA w rekordach")
ggsave("images/plots/NA_count_perRow.png", p)
badania <- badania[rowSums(is.na(badania)) <= 1, ]
#| warning: false
#| echo: false
NA_count <- colSums(is.na(badania))[colSums(is.na(badania)) > 0] |>
data.frame()
names(NA_count) <- "count"
NA_count$var = rownames(NA_count)
rownames(NA_count) <- NULL
NA_count <- select(NA_count, c(2,1))
p <- ggplot(NA_count, aes(x = var, y = count)) +
geom_col(show.legend = FALSE, fill = "#6AAED9") +
theme_ipsum_rc() +
geom_text(aes(label = count), vjust = -0.5) +
expand_limits(y = max(NA_count$count) * 1.1) +
labs(title = "Liczba wartości NA w zmiennych")
ggsave("images/plots/na_count_after.png", p)
#| output: false
statystyki_przed <- describe(badania[NA_count$var])
metody <- make.method(badania)
metody["BPMeds"] <- "logreg"        #
metody["education"] <- "polr"
metody["BMI"] <- "pmm"
metody["cigsPerDay"] <- "pmm"
metody["glucose"] <- "pmm"
metody["heartRate"] <- "pmm"
metody["totChol"] <- "pmm"
uzupelnienia <- mice(badania,
m = 5,
method = metody,
seed = 2025)
badania <- complete(uzupelnienia)
statystyki_po <- describe(badania[NA_count$var])
round(data.frame(t(statystyki_przed))[c(2:9,10:12), ], 3)
round(data.frame(t(statystyki_po))[c(2:9,10:12), ], 3)
badania <- mutate(badania, ID = 1:nrow(badania))
zdrowi <- badania |>
subset(TenYearCHD == "No")
chorzy <- badania |>
subset(TenYearCHD == "Yes")
#| warning: false
zmienna_wykres <- function(dane, typ_zmiennej, typ_wykresu) {
my_plots = list()
if (typ_zmiennej == "kategoryczna") {
dane <- dane |>
dplyr::select(where(is.factor))
} else if (typ_zmiennej == "numeryczna") {
dane <- dane |>
dplyr::select(where(is.numeric))
} else {
# nic nie robimy
}
for (i in 1:ncol(dane)) {
kolumna <- colnames(dane)[i]
if (typ_wykresu == "barplot") {
p <- ggplot(dane, aes(x = !!sym(kolumna), fill = !!sym(kolumna))) +
geom_bar(show.legend = FALSE, width = 0.6) +
theme_ipsum_rc() +
ggtitle(kolumna) +
scale_fill_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041"))
} else if (typ_wykresu == "pie") {
p <- dane %>%
dplyr::count(!!sym(kolumna)) %>%
ggplot(aes(x = "", y = n, fill = !!sym(kolumna))) +
geom_bar(stat = "identity", width = 1, color = "white") +
coord_polar(theta = "y") +
theme_minimal() +
ggtitle(kolumna) +
scale_fill_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041"))
} else if (typ_wykresu == "histogram") {
p <- ggplot(dane, aes(x = !!sym(kolumna))) +
geom_histogram(bins = 20, show.legend = FALSE, fill = "#6AAED9", color = "black") +
theme_ipsum_rc() +
ggtitle(kolumna)
} else if (typ_wykresu == "violin") {
p <- ggplot(dane, aes(x = "", y = !!sym(kolumna), fill = "#6AAED9")) +
geom_violin(show.legend = FALSE) +
theme_ipsum_rc() +
ggtitle(kolumna) +
scale_fill_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041"))
} else {
next  # pomiń jeśli nieznany typ wykresu
}
my_plots[[i]] <- p
}
gotowy_wykres_1 <- (my_plots[[1]] + my_plots[[2]]) / (my_plots[[3]] + my_plots[[4]])
gotowy_wykres_2 <- (my_plots[[5]] + my_plots[[6]]) / (my_plots[[7]] + my_plots[[8]])
ggsave(paste0("images/plots/", typ_zmiennej, "_", typ_wykresu, "1.png"), gotowy_wykres_1)
ggsave(paste0("images/plots/", typ_zmiennej, "_", typ_wykresu, "2.png"), gotowy_wykres_2)
}
#| label: Kategoryczne_Wstep
zmienna_wykres(badania, "kategoryczna", "barplot")
zmienna_wykres(badania, "kategoryczna", "pie")
#| warning: false
zmienna_wykres <- function(dane, typ_zmiennej, typ_wykresu) {
my_plots = list()
if (typ_zmiennej == "kategoryczna") {
dane <- dane |>
dplyr::select(where(is.factor))
} else if (typ_zmiennej == "numeryczna") {
dane <- dane |>
dplyr::select(where(is.numeric))
} else {
# nic nie robimy
}
for (i in 1:ncol(dane)) {
kolumna <- colnames(dane)[i]
if (typ_wykresu == "barplot") {
p <- ggplot(dane, aes(x = !!sym(kolumna), fill = !!sym(kolumna))) +
geom_bar(show.legend = FALSE, width = 0.6) +
theme_ipsum_rc() +
ggtitle(kolumna) +
scale_fill_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041"))
} else if (typ_wykresu == "pie") {
p <- dane %>%
dplyr::count(!!sym(kolumna)) %>%
ggplot(aes(x = "", y = n, fill = !!sym(kolumna))) +
geom_bar(stat = "identity", width = 1, color = "white") +
coord_polar(theta = "y") +
theme_clean() +
ggtitle(kolumna) +
scale_fill_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041"))
} else if (typ_wykresu == "histogram") {
p <- ggplot(dane, aes(x = !!sym(kolumna))) +
geom_histogram(bins = 20, show.legend = FALSE, fill = "#6AAED9", color = "black") +
theme_ipsum_rc() +
ggtitle(kolumna)
} else if (typ_wykresu == "violin") {
p <- ggplot(dane, aes(x = "", y = !!sym(kolumna), fill = "#6AAED9")) +
geom_violin(show.legend = FALSE) +
theme_ipsum_rc() +
ggtitle(kolumna) +
scale_fill_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041"))
} else {
next  # pomiń jeśli nieznany typ wykresu
}
my_plots[[i]] <- p
}
gotowy_wykres_1 <- (my_plots[[1]] + my_plots[[2]]) / (my_plots[[3]] + my_plots[[4]])
gotowy_wykres_2 <- (my_plots[[5]] + my_plots[[6]]) / (my_plots[[7]] + my_plots[[8]])
ggsave(paste0("images/plots/", typ_zmiennej, "_", typ_wykresu, "1.png"), gotowy_wykres_1)
ggsave(paste0("images/plots/", typ_zmiennej, "_", typ_wykresu, "2.png"), gotowy_wykres_2)
}
#| label: Kategoryczne_Wstep
zmienna_wykres(badania, "kategoryczna", "barplot")
zmienna_wykres(badania, "kategoryczna", "pie")
#| label: Numeryczne_Wstep
zmienna_wykres(badania, "numeryczna", "violin")
zmienna_wykres(badania, "numeryczna", "histogram")
#| warning: false
zmienna_wykres <- function(dane, typ_zmiennej, typ_wykresu) {
my_plots = list()
if (typ_zmiennej == "kategoryczna") {
dane <- dane |>
dplyr::select(where(is.factor))
} else if (typ_zmiennej == "numeryczna") {
dane <- dane |>
dplyr::select(where(is.numeric))
} else {
# nic nie robimy
}
for (i in 1:ncol(dane)) {
kolumna <- colnames(dane)[i]
if (typ_wykresu == "barplot") {
p <- ggplot(dane, aes(x = !!sym(kolumna), fill = !!sym(kolumna))) +
geom_bar(show.legend = FALSE, width = 0.6) +
theme_ipsum_rc() +
ggtitle(kolumna) +
scale_fill_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041"))
} else if (typ_wykresu == "pie") {
p <- dane %>%
dplyr::count(!!sym(kolumna)) %>%
ggplot(aes(x = "", y = n, fill = !!sym(kolumna))) +
geom_bar(stat = "identity", width = 1, color = "white") +
coord_polar(theta = "y") +
theme_void() +
ggtitle(kolumna) +
scale_fill_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041"))
} else if (typ_wykresu == "histogram") {
p <- ggplot(dane, aes(x = !!sym(kolumna))) +
geom_histogram(bins = 20, show.legend = FALSE, fill = "#6AAED9", color = "black") +
theme_ipsum_rc() +
ggtitle(kolumna)
} else if (typ_wykresu == "violin") {
p <- ggplot(dane, aes(x = "", y = !!sym(kolumna), fill = "#6AAED9")) +
geom_violin(show.legend = FALSE) +
theme_ipsum_rc() +
ggtitle(kolumna) +
scale_fill_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041"))
} else {
next  # pomiń jeśli nieznany typ wykresu
}
my_plots[[i]] <- p
}
gotowy_wykres_1 <- (my_plots[[1]] + my_plots[[2]]) / (my_plots[[3]] + my_plots[[4]])
gotowy_wykres_2 <- (my_plots[[5]] + my_plots[[6]]) / (my_plots[[7]] + my_plots[[8]])
ggsave(paste0("images/plots/", typ_zmiennej, "_", typ_wykresu, "1.png"), gotowy_wykres_1)
ggsave(paste0("images/plots/", typ_zmiennej, "_", typ_wykresu, "2.png"), gotowy_wykres_2)
}
#| label: Kategoryczne_Wstep
zmienna_wykres(badania, "kategoryczna", "barplot")
zmienna_wykres(badania, "kategoryczna", "pie")
#| label: Numeryczne_Wstep
zmienna_wykres(badania, "numeryczna", "violin")
zmienna_wykres(badania, "numeryczna", "histogram")
#| label: Korelacja
cor_mat <- badania %>%
select(where(is.numeric)) %>%
cor()
p <- ggcorrplot(
cor_mat,
lab = TRUE,
type = "lower",
hc.order = TRUE,          #
outline.col = "white",
ggtheme = ggplot2::theme_minimal(),
colors = c("#6AAED9", "white", "#F25041")
) + ggtitle("Macierz Korelacji")
ggsave("images/plots/korelacja.jpg", p)
#| label: sysBP_wzgledem_diaBP
p1 <- ggplot(badania, aes(x = diaBP, y = sysBP, color = sex, shape = sex)) +
geom_point() +
theme_ipsum_rc() +
ggtitle("sysBP ~ diaBP") +
scale_color_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041")) +
theme(legend.position = "bottom")
ggsave("images/plots/sysBP_wzgledem_diaBP.jpg", p1)
#| label: diaBP
p1 <- ggplot(badania, aes(x = diaBP, color = sex)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("Distribution of diaBP by Sex") +
scale_color_manual(values = c("#6AAED9", "#F2A391")) +
theme(legend.position = "bottom")
p2 <- ggplot(badania, aes(x = diaBP, color = education)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("Distribution of diaBP by Education Level") +
scale_color_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041")) +
theme(legend.position = "bottom")
p3 <- ggplot(badania, aes(x = diaBP, color = currentSmoker)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("Distribution of diaBP by Smoking") +
scale_color_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041")) +
theme(legend.position = "bottom")
ggsave("images/plots/diaBP_bySex.jpg", p1)
ggsave("images/plots/diaBP_byEducation.jpg", p2)
ggsave("images/plots/diaBP_byCurrentSmoker.jpg", p3)
#| label: sysBP
p1 <- ggplot(badania, aes(x = sysBP, color = sex)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("Distribution of sysBP by Sex") +
scale_color_manual(values = c("#6AAED9", "#F2A391")) +
theme(legend.position = "bottom")
p2 <- ggplot(badania, aes(x = sysBP, color = education)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("Distribution of sysBP by Education Level") +
scale_color_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041")) +
theme(legend.position = "bottom")
p3 <- ggplot(badania, aes(x = sysBP, color = currentSmoker)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("Distribution of sysBP by Smoking") +
scale_color_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041")) +
theme(legend.position = "bottom")
ggsave("images/plots/sysBP_bySex.jpg", p1)
ggsave("images/plots/sysBP_byEducation.jpg", p2)
ggsave("images/plots/sysBP_byCurrentSmoker.jpg", p3)
#| label: Pulse_pressure
#| warning: false
p1 <- badania |>
mutate(range_diff = sysBP - diaBP) |>
arrange(range_diff) |>
ggplot(aes(x = range_diff, color = TenYearCHD)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391")) +
labs(title = "Pulse pressure distribution", x = "sysBP - diaBP")
p2 <- badania |>
mutate(range_diff = sysBP - diaBP) |>
arrange(range_diff) |>
ggplot(aes(x = range_diff, color = prevalentHyp)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391")) +
labs(title = "Pulse pressure distribution", x = "sysBP - diaBP")
p3 <- badania |>
mutate(range_diff = sysBP - diaBP) |>
arrange(range_diff) |>
ggplot(aes(x = range_diff, color = diabetes)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041")) +
labs(title = "Pulse pressure distribution", x = "sysBP - diaBP")
ggsave("images/plots/pulse_pressure_1.jpg", p1)
ggsave("images/plots/pulse_pressure_2.jpg", p2)
ggsave("images/plots/pulse_pressure_3.jpg", p3)
#| label: diaBP
p1 <- ggplot(badania, aes(x = diaBP, color = sex)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("Distribution of diaBP by Sex") +
scale_color_manual(values = c("#6AAED9", "#F2A391")) +
theme(legend.position = "bottom")
p2 <- ggplot(badania, aes(x = diaBP, color = education)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("Distribution of diaBP by Education Level") +
scale_color_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041")) +
theme(legend.position = "bottom")
p3 <- ggplot(badania, aes(x = diaBP, color = currentSmoker)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("Distribution of diaBP by Smoking") +
scale_color_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041")) +
theme(legend.position = "bottom")
ggsave("images/plots/diaBP_bySex.jpg", p1)
ggsave("images/plots/diaBP_byEducation.jpg", p2)
ggsave("images/plots/diaBP_byCurrentSmoker.jpg", p3)
#| label: sysBP
p1 <- ggplot(badania, aes(x = sysBP, color = sex)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("Distribution of sysBP by Sex") +
scale_color_manual(values = c("#6AAED9", "#F2A391")) +
theme(legend.position = "bottom")
p2 <- ggplot(badania, aes(x = sysBP, color = education)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("Distribution of sysBP by Education Level") +
scale_color_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041")) +
theme(legend.position = "bottom")
p3 <- ggplot(badania, aes(x = sysBP, color = currentSmoker)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
ggtitle("Distribution of sysBP by Smoking") +
scale_color_manual(values = c("#6AAED9", "#F2A391", "#2C5DBF", "#F25041")) +
theme(legend.position = "bottom")
ggsave("images/plots/sysBP_bySex.jpg", p1)
ggsave("images/plots/sysBP_byEducation.jpg", p2)
ggsave("images/plots/sysBP_byCurrentSmoker.jpg", p3)
#| label: Cisnienie_wzgledem_ryzyka
#| warning: false
p1 <- badania |>
ggplot(aes(x = TenYearCHD, y = sysBP, color = sex)) +
geom_boxplot() +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391")) +
ggtitle("Value of sysBP by Sex")
p2 <- badania |>
ggplot(aes(x = TenYearCHD, y = diaBP, color = sex)) +
geom_boxplot() +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391")) +
ggtitle("Value of diaBP by Sex")
ggsave("images/plots/cisnienie_wzlgedem_ryzyka_bySex_1.png", p1)
ggsave("images/plots/cisnienie_wzlgedem_ryzyka_bySex_2.png", p2)
#| warning: false
p1 <- badania |>
ggplot(aes(x = sysBP, color = TenYearCHD)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
p2 <- badania |>
ggplot(aes(x = diaBP, color = TenYearCHD)) +
geom_density(lwd = 1.2) +
theme_ipsum_rc() +
scale_color_manual(values = c("#6AAED9", "#F2A391"))
#| warning: false
p1 <- badania |>
ggplot(aes(x = currentSmoker, fill = currentSmoker)) +
geom_bar(fill = c("#6AAED9", "#F2A391"), width = 0.4, color = "black") +
theme_ipsum_rc()
p2 <- badania |>
ggplot(aes(x = currentSmoker, fill = sex)) +
geom_bar(position = "dodge", color = "black") +
theme_ipsum_rc() +
scale_fill_manual(values = c("#6AAED9", "#F2A391"))
p3 <- badania |>
ggplot(aes(x = currentSmoker, fill = TenYearCHD)) +
geom_bar(position = "dodge", color = "black") +
theme_ipsum_rc() +
scale_fill_manual(values = c("#6AAED9", "#F2A391"))
p1; p2; p3
