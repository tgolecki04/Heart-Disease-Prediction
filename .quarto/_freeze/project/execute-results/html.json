{
  "hash": "9c9aa8e3364616779152a7661b0e7f36",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Wczesne Wykrywanie Ryzyka Zawału Serca\"\nwarning: false\n---\n\n\n::: {.cell}\n\n:::\n\n\n<div>\n\n![](images/clipboard-393030803.jpeg)\n\n</div>\n\n## Plan Projektu\n\n### Wstęp Teoretyczny\n\nLorem ipsum dolor sit amet consectetur adipiscing elit quisque faucibus ex sapien vitae pellentesque sem placerat in id cursus mi pretium tellus duis convallis tempus leo eu aenean sed diam urna tempor pulvinar vivamus fringilla lacus nec metus bibendum egestas iaculis massa nisl malesuada lacinia integer nunc posuere ut hendrerit semper vel class aptent taciti sociosqu ad litora torquent per conubia nostra inceptos himenaeos orci varius natoque penatibus et magnis dis parturient montes nascetur ridiculus mus donec rhoncus eros lobortis.\n\n### Wyjaśnienie Problemu\n\nLorem ipsum dolor sit amet consectetur adipiscing elit quisque faucibus ex sapien vitae pellentesque sem placerat in id cursus mi pretium tellus duis convallis tempus leo eu aenean sed diam urna tempor pulvinar vivamus fringilla lacus nec metus bibendum egestas iaculis massa nisl malesuada lacinia integer nunc posuere ut hendrerit semper vel class aptent taciti sociosqu ad litora torquent per conubia nostra inceptos himenaeos orci varius natoque penatibus et magnis dis parturient montes nascetur ridiculus mus donec rhoncus eros lobortis nulla molestie mattis scelerisque maximus eget fermentum odio phasellus non purus est efficitur laoreet mauris pharetra vestibulum fusce dictum risus blandit quis suspendisse aliquet nisi sodales consequat magna ante condimentum neque at luctus nibh finibus facilisis dapibus etiam interdum tortor ligula congue sollicitudin erat viverra ac tincidunt nam porta elementum.\n\n### Omówienie Danych\n\nLorem ipsum dolor sit amet consectetur adipiscing elit quisque faucibus ex sapien vitae pellentesque sem placerat in id cursus mi pretium tellus duis convallis tempus leo eu aenean sed diam urna tempor pulvinar vivamus fringilla lacus nec metus bibendum egestas iaculis massa nisl malesuada lacinia integer nunc posuere ut hendrerit semper vel class aptent taciti sociosqu ad litora torquent per conubia nostra inceptos himenaeos orci varius natoque penatibus et magnis dis parturient montes nascetur ridiculus mus donec rhoncus eros lobortis nulla molestie mattis scelerisque maximus eget fermentum odio phasellus non purus est efficitur laoreet mauris pharetra vestibulum fusce dictum risus blandit quis suspendisse aliquet nisi sodales consequat magna ante condimentum neque at luctus nibh finibus facilisis dapibus etiam interdum tortor ligula congue sollicitudin erat viverra ac tincidunt nam porta elementum a enim euismod quam justo lectus commodo augue arcu dignissim velit aliquam imperdiet mollis nullam volutpat porttitor ullamcorper rutrum gravida cras eleifend turpis fames primis vulputate ornare sagittis vehicula praesent dui felis venenatis ultrices proin libero feugiat tristique accumsan maecenas potenti ultricies habitant morbi senectus netus suscipit auctor curabitur facilisi cubilia curae hac habitasse platea dictumst lorem ipsum dolor sit amet consectetur adipiscing elit quisque faucibus ex sapien vitae pellentesque sem placerat in id cursus mi pretium tellus duis convallis tempus leo eu aenean sed diam urna tempor pulvinar vivamus fringilla lacus nec metus bibendum egestas iaculis massa nisl malesuada lacinia integer nunc posuere ut hendrerit semper vel class aptent.\n\n### Źródło Pomysłu\n\nLorem ipsum dolor sit amet consectetur adipiscing elit quisque faucibus ex sapien vitae pellentesque sem placerat in id cursus mi pretium tellus duis convallis tempus leo eu aenean sed diam urna tempor pulvinar vivamus fringilla lacus nec metus bibendum egestas iaculis massa nisl malesuada lacinia integer nunc posuere ut hendrerit semper vel class aptent taciti sociosqu ad litora torquent per.\n\n## Dane {#informacje}\n\n### Zapoznanie z danymi\n\nWczytanie pliku z rozszerzeniem `csv` do zmiennej o nazwie `data`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read.csv2(\"data/badania.csv\", sep=\",\")\n```\n:::\n\n\nSprawdźmy jak wyglądają nasze dane. Użyjemy do tego funkcji `head()` oraz `tail()` do podglądu kilku pierwszych i ostatnich obserwacji w naszym zbiorze danych. Pierwsze 10 obserwacji ma postać:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(data)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| male| age| education| currentSmoker| cigsPerDay| BPMeds| prevalentStroke| prevalentHyp| diabetes| totChol|sysBP |diaBP |BMI   | heartRate| glucose| TenYearCHD|\n|----:|---:|---------:|-------------:|----------:|------:|---------------:|------------:|--------:|-------:|:-----|:-----|:-----|---------:|-------:|----------:|\n|    1|  39|         4|             0|          0|      0|               0|            0|        0|     195|106   |70    |26.97 |        80|      77|          0|\n|    0|  46|         2|             0|          0|      0|               0|            0|        0|     250|121   |81    |28.73 |        95|      76|          0|\n|    1|  48|         1|             1|         20|      0|               0|            0|        0|     245|127.5 |80    |25.34 |        75|      70|          0|\n|    0|  61|         3|             1|         30|      0|               0|            1|        0|     225|150   |95    |28.58 |        65|     103|          1|\n|    0|  46|         3|             1|         23|      0|               0|            0|        0|     285|130   |84    |23.1  |        85|      85|          0|\n|    0|  43|         2|             0|          0|      0|               0|            1|        0|     228|180   |110   |30.3  |        77|      99|          0|\n\n</div>\n:::\n:::\n\n\nNatomiast kilka ostatnich obserwcji nad którymi bedziemy pracować mają postać:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntail(data)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|     | male| age| education| currentSmoker| cigsPerDay| BPMeds| prevalentStroke| prevalentHyp| diabetes| totChol|sysBP |diaBP |BMI   | heartRate| glucose| TenYearCHD|\n|:----|----:|---:|---------:|-------------:|----------:|------:|---------------:|------------:|--------:|-------:|:-----|:-----|:-----|---------:|-------:|----------:|\n|4235 |    1|  51|         3|             1|         43|      0|               0|            0|        0|     207|126.5 |80    |19.71 |        65|      68|          0|\n|4236 |    0|  48|         2|             1|         20|     NA|               0|            0|        0|     248|131   |72    |22    |        84|      86|          0|\n|4237 |    0|  44|         1|             1|         15|      0|               0|            0|        0|     210|126.5 |87    |19.16 |        86|      NA|          0|\n|4238 |    0|  52|         2|             0|          0|      0|               0|            0|        0|     269|133.5 |83    |21.47 |        80|     107|          0|\n|4239 |    1|  40|         3|             0|          0|      0|               0|            1|        0|     185|141   |98    |25.6  |        67|      72|          0|\n|4240 |    0|  39|         3|             1|         30|      0|               0|            0|        0|     196|133   |86    |20.91 |        85|      80|          0|\n\n</div>\n:::\n:::\n\n\nSpradźmy rozmiary naszej ramki danych. W tym celu posłużymy się funkcjami `nrow()` oraz `ncol()`, które zawracają odpowiednio **liczbę wierszy** oraz **liczbę kolumn**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnrow(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4240\n```\n\n\n:::\n\n```{.r .cell-code}\nncol(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 16\n```\n\n\n:::\n:::\n\n\nWidzimy że mamy ponad 4200 obserwacji i 16 zmiennych, które posłużą nam do stworzenia kilku modeli predykcyjnych i wyboru tego, który najlepiej będzie oceniał ryzyko zawału serca. Jest to naprawdę duży zasób danych, które mogą odpowiedzieć na wiele interesujących pytań. Nadszedł czas sprawdzić zmienne, które posiadamy. Użyjemy do tego funkcji `colnames().`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"male\"            \"age\"             \"education\"       \"currentSmoker\"  \n [5] \"cigsPerDay\"      \"BPMeds\"          \"prevalentStroke\" \"prevalentHyp\"   \n [9] \"diabetes\"        \"totChol\"         \"sysBP\"           \"diaBP\"          \n[13] \"BMI\"             \"heartRate\"       \"glucose\"         \"TenYearCHD\"     \n```\n\n\n:::\n:::\n\n\nOkazuje się, że nasz zbiór zawiera cenne informacje medyczne takie jak:\n\n1.  Tętno\n\n2.  BMI\n\n3.  Ciśnienie skurczowe i rozkurczowe\n\n4.  Poziom cholesterolu i glukozy\n\n5.  Informacje o tym, czy pacjent był palaczem, czy też nie\n\nDokładniej przyjrzymy się naszym zmiennym w dalszej części analizy zbioru danych. Wyjaśnimy dokładniej cechy poszczególnych kolumn zbioru danych oraz ich podstawowe statystyki. Czas sprawdzić podstawowe statystki dotyczące danych oraz to z jakimi typami danych będziemy pracować.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nskim(data)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |     |\n|:------------------------|:----|\n|Name                     |data |\n|Number of rows           |4240 |\n|Number of columns        |16   |\n|_______________________  |     |\n|Column type frequency:   |     |\n|character                |3    |\n|numeric                  |13   |\n|________________________ |     |\n|Group variables          |None |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|sysBP         |         0|             1|   2|   5|     0|      234|          0|\n|diaBP         |         0|             1|   2|   5|     0|      146|          0|\n|BMI           |        19|             1|   2|   5|     0|     1364|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable   | n_missing| complete_rate|   mean|    sd|  p0| p25| p50| p75| p100|hist  |\n|:---------------|---------:|-------------:|------:|-----:|---:|---:|---:|---:|----:|:-----|\n|male            |         0|          1.00|   0.43|  0.50|   0|   0|   0|   1|    1|▇▁▁▁▆ |\n|age             |         0|          1.00|  49.58|  8.57|  32|  42|  49|  56|   70|▃▇▆▆▂ |\n|education       |       105|          0.98|   1.98|  1.02|   1|   1|   2|   3|    4|▇▆▁▃▂ |\n|currentSmoker   |         0|          1.00|   0.49|  0.50|   0|   0|   0|   1|    1|▇▁▁▁▇ |\n|cigsPerDay      |        29|          0.99|   9.01| 11.92|   0|   0|   0|  20|   70|▇▃▁▁▁ |\n|BPMeds          |        53|          0.99|   0.03|  0.17|   0|   0|   0|   0|    1|▇▁▁▁▁ |\n|prevalentStroke |         0|          1.00|   0.01|  0.08|   0|   0|   0|   0|    1|▇▁▁▁▁ |\n|prevalentHyp    |         0|          1.00|   0.31|  0.46|   0|   0|   0|   1|    1|▇▁▁▁▃ |\n|diabetes        |         0|          1.00|   0.03|  0.16|   0|   0|   0|   0|    1|▇▁▁▁▁ |\n|totChol         |        50|          0.99| 236.70| 44.59| 107| 206| 234| 263|  696|▆▇▁▁▁ |\n|heartRate       |         1|          1.00|  75.88| 12.03|  44|  68|  75|  83|  143|▂▇▃▁▁ |\n|glucose         |       388|          0.91|  81.96| 23.95|  40|  71|  78|  87|  394|▇▁▁▁▁ |\n|TenYearCHD      |         0|          1.00|   0.15|  0.36|   0|   0|   0|   0|    1|▇▁▁▁▂ |\n\n\n:::\n:::\n\n\nTak jak widać na powyższym raporcie, zaczytując dane otrzymujemy 3 zmienne typu `character` oraz 13 zmiennych typu `numeric`. Taki podział ze względu na typ zmiennych nie jest odpowiedni. Wszystkie cechy typu `character` mają w naszym przypadku błędne formatowanie. Dodatkowo będziemy musieli dodać nowe typy zmiennych takie jak `boolean` oraz `factor`, aby móc szybko i praktycznie pracować z danymi. Odpowiedni wybór typów zmiennych jest podstawowym krokiem rozpczynając analizę zbioru danych. Zrobimy to w następujący sposób.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbadania <- data |> \n  mutate(\n    sysBP = as.numeric(sysBP),\n    diaBP = as.numeric(diaBP),\n    BMI = as.numeric(BMI),\n    sex = factor(male, levels = c(0, 1), labels = c(\"Female\", \"Male\")),\n    education = as.factor(education),\n    currentSmoker = factor(currentSmoker, labels = c(\"No\", \"Yes\")),\n    BPMeds = factor(BPMeds, labels = c(\"No\", \"Yes\")),\n    prevalentStroke = factor(prevalentStroke, labels = c(\"No\", \"Yes\")),\n    prevalentHyp = factor(prevalentHyp, labels = c(\"No\", \"Yes\")),\n    diabetes = factor(diabetes, labels = c(\"No\", \"Yes\")),\n    TenYearCHD = factor(TenYearCHD, labels = c(\"No\", \"Yes\"))\n  ) |> dplyr::select(-male)\n```\n:::\n\n\nW tym momencie wszystkie zmienne mają przypisane odpowiednie typy danych, co pozwoli zaoszczędzić czas podczas przeprowadzania obliczeń i analizy nad nimi. Dla wygody uporządkujemy teraz kolumny w odpowiedniej dla nas kolejności, tak aby informacje powiązane ze sobą były obok siebie (Np. zmienna `glucose` obok zmiennej `diabetes`)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbadania <- dplyr::select(badania, c(1, 16, 2, 10, 11, 13, 12, 9, 14, 8, 4, 3, 5:7, 15))\nhead(badania)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| age|sex    |education | sysBP| diaBP| heartRate|   BMI| totChol| glucose|diabetes | cigsPerDay|currentSmoker |BPMeds |prevalentStroke |prevalentHyp |TenYearCHD |\n|---:|:------|:---------|-----:|-----:|---------:|-----:|-------:|-------:|:--------|----------:|:-------------|:------|:---------------|:------------|:----------|\n|  39|Male   |4         | 106.0|    70|        80| 26.97|     195|      77|No       |          0|No            |No     |No              |No           |No         |\n|  46|Female |2         | 121.0|    81|        95| 28.73|     250|      76|No       |          0|No            |No     |No              |No           |No         |\n|  48|Male   |1         | 127.5|    80|        75| 25.34|     245|      70|No       |         20|Yes           |No     |No              |No           |No         |\n|  61|Female |3         | 150.0|    95|        65| 28.58|     225|     103|No       |         30|Yes           |No     |No              |Yes          |Yes        |\n|  46|Female |3         | 130.0|    84|        85| 23.10|     285|      85|No       |         23|Yes           |No     |No              |No           |No         |\n|  43|Female |2         | 180.0|   110|        77| 30.30|     228|      99|No       |          0|No            |No     |No              |Yes          |No         |\n\n</div>\n:::\n:::\n\n\nZrobione. Teraz możemy przejść do wyjaśnienia zmiennych, aby było jasne z czym pracujemy oraz na czym możemy polegać podczas wykonywania analizy.\n\n### Opis i wyjaśnienie zmiennych\n\nPoniżej znajduje się tabela zawierająca wszystkie cechy wraz z ich wytłumaczeniem.\n\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| Zmienna           | Opis                                                                 | Jednostka                                                    | Typ         |\n+:=================:+:====================================================================:+:============================================================:+:===========:+\n| `age`             | Wiek (w latach)                                                      | Lata                                                         | `int`       |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| `sex`             | Płeć (1 - Mężczyzna, 0 - Kobieta)                                    | Brak                                                         | `factor`    |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| `education`       | Wykształcenie                                                        | Brak                                                         | `factor`    |\n|                   |                                                                      |                                                              |             |\n|                   | (1 - Brak ukończonej szkoły średniej,                                |                                                              |             |\n|                   |                                                                      |                                                              |             |\n|                   | 2 - Ukończona szkoła średnia,                                        |                                                              |             |\n|                   |                                                                      |                                                              |             |\n|                   | 3 - Nieukończone studia lub ukończona szkoła zawodowa,               |                                                              |             |\n|                   |                                                                      |                                                              |             |\n|                   | 4 - Wykształcenie Wyższe)                                            |                                                              |             |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| `sysBP`           | Wartość ciśnienia skurczowego (Średnia ostatnich dwóch pomiarów)     | mmHg                                                         | `numerical` |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| `diaBP`           | Wartość ciśnienia rozkurczowego (Średnia ostatnich dwóch pomiarów)   | mmHg                                                         | `numerical` |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| `heartRate`       | Poziom tętna ()                                                      | Uderzeń na minutę                                            | `int`       |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| `BMI`             | Wartość współczynnika BMI                                            | $\\displaystyle \\frac{\\text{masa (kg)}}{\\text{wzrost (m)}^2}$ | `float`     |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| `totalChol`       | Wartość poziomu cholesterolu ()                                      | $\\displaystyle \\frac{\\text{mg}}{\\text{dL}}$                  | `int`       |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| `glucose`         | Poziom glukozy we krwi ()                                            | $\\displaystyle \\frac{\\text{mg}}{\\text{dL}}$                  | `int`       |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| `diabetes`        | Fakt czy pacjent jest cukrzykiem\\                                    | brak                                                         | `factor`    |\n|                   | (1 - Tak, 0 - Nie)                                                   |                                                              |             |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| `cigsPerDay`      | Średnia liczba palonych dziennie papierosów                          | sztuki                                                       | `int`       |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| `currentSmoker`   | Fakt czy pacjent jest palaczem\\                                      | brak                                                         | `factor`    |\n|                   | (1- Tak, 0 - Nie)                                                    |                                                              |             |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| `BMPmeds`         | Fakt czy pacjent leczy się na nadciśnienie krwi (1 - Tak, 0 - Nie)   | brak                                                         | `factor`    |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| `prevalentStroke` | Wskazuje czy pacjent przeżył udar mózgu. (1 - Tak, 0 - Nie)          | brak                                                         | `factor`    |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| `prevalentHyp`    | Wskazuje czy u pacjenta występowało nadciśnienie.\\                   | brak                                                         | `factor`    |\n|                   | (1 - Tak, 0 - Nie)                                                   |                                                              |             |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n| `TenYearCHD`      | Wskazuje 10-letnie ryzyko wystąpienia choroby wieńcowej u pacjenta.\\ | brak                                                         | `factor`    |\n|                   | (1- Tak, 0-Nie)                                                      |                                                              |             |\n+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+\n\n### Uzupełnienie brakujących wartości\n\n### Wizualizacja danych\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce elementum sapien sit amet diam tristique, sed placerat ante hendrerit. Vestibulum ut leo vitae turpis consequat lobortis. Praesent ultricies ligula lorem, vel feugiat elit finibus sit amet. Nam placerat rhoncus tellus, sit amet condimentum mi. Pellentesque vitae justo dolor. Pellentesque et mi enim. Cras maximus elit vitae dictum egestas. Proin laoreet velit nibh, quis interdum leo efficitur vitae. Duis placerat malesuada vehicula. Ut at eros sit amet sem dictum fringilla quis.\n\n#### Funkcja tworzenia wykresów\n\n\n::: {.cell}\n\n```{.r .cell-code}\nzmienna_wykres <- function(dane, typ_zmiennej, typ_wykresu) {\n  my_plots = list()\n  if (typ_zmiennej == \"kategoryczna\") {\n    dane <- dane |> \n      dplyr::select(where(is.factor))\n  } else if (typ_zmiennej == \"numeryczna\") {\n    dane <- dane |> \n      dplyr::select(where(is.numeric))\n  } else {\n    # nic nie robimy\n  }\n  \n  for (i in 1:ncol(dane)) {\n    kolumna <- colnames(dane)[i]\n    if (typ_wykresu == \"barplot\") {\n    p <- ggplot(dane, aes(x = !!sym(kolumna))) +\n      geom_bar(fill = \"steelblue\") +\n      theme_ipsum() +\n      ggtitle(kolumna)\n    \n    } else if (typ_wykresu == \"pie\") {\n      p <- dane %>%\n        dplyr::count(!!sym(kolumna)) %>%\n        ggplot(aes(x = \"\", y = n, fill = !!sym(kolumna))) +\n        geom_bar(stat = \"identity\", width = 1, color = \"white\") +\n        coord_polar(theta = \"y\") +\n        theme_void() +\n        ggtitle(kolumna)\n      \n    } else if (typ_wykresu == \"histogram\") {\n      p <- ggplot(dane, aes(x = !!sym(kolumna))) +\n        geom_histogram(fill = \"darkorange\", bins = 20) +\n        theme_ipsum() +\n        ggtitle(kolumna)\n      \n    } else if (typ_wykresu == \"violin\") {\n      p <- ggplot(dane, aes(x = \"\", y = !!sym(kolumna))) +\n        geom_violin(fill = \"lightgreen\") +\n        theme_ipsum() +\n        ggtitle(kolumna)\n    } else {\n      next  # pomiń jeśli nieznany typ wykresu\n    }\n    my_plots[[i]] <- p\n  } \n\n  \ngotowy_wykres_1 <- (my_plots[[1]] + my_plots[[2]]) / (my_plots[[3]] + my_plots[[4]]) \ngotowy_wykres_2 <- (my_plots[[5]] + my_plots[[6]]) / (my_plots[[7]] + my_plots[[8]])\nggsave(paste0(\"images/plots/\", typ_zmiennej, \"_\", typ_wykresu, \"1.png\"), gotowy_wykres_1)\nggsave(paste0(\"images/plots/\", typ_zmiennej, \"_\", typ_wykresu, \"2.png\"), gotowy_wykres_2)\n}\n```\n:::\n\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce elementum sapien sit amet diam tristique, sed placerat ante hendrerit. Vestibulum ut leo vitae turpis consequat lobortis. Praesent ultricies ligula lorem, vel feugiat elit finibus sit amet. Nam placerat rhoncus tellus, sit amet condimentum mi. Pellentesque vitae justo dolor.\n\n#### Zmienne Kategoryczne\n\n\n::: {.cell}\n\n```{.r .cell-code}\nzmienna_wykres(badania, \"kategoryczna\", \"barplot\")\nzmienna_wykres(badania, \"kategoryczna\", \"pie\")\n```\n:::\n\n\n::: panel-tabset\n## Barplot\n\n![](images/plots/kategoryczna_barplot1.png){fig-align=\"center\"}\n\n![](images/plots/kategoryczna_barplot2.png){fig-align=\"center\"}\n\n## Pie\n\n![](images/plots/kategoryczna_pie1.png){fig-align=\"center\"}\n\n![](images/plots/kategoryczna_pie2.png){fig-align=\"center\"}\n:::\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Ut varius non lacus eget pellentesque. Morbi sed nunc vel est interdum tempus eget vel felis. Morbi posuere mattis magna, et ornare lacus gravida sed. Nullam nulla mauris, aliquam et faucibus quis, ultrices id nisl. Quisque eu dolor at odio vulputate hendrerit. Morbi ut fringilla eros, ac dapibus velit. Aenean facilisis lacinia facilisis. Morbi ultricies urna a nibh molestie gravida. Aenean et tincidunt tortor. Sed ut nisi lacinia, volutpat ipsum quis, tristique ligula.\n\nDonec bibendum, erat quis scelerisque placerat, urna erat suscipit elit, a semper lorem ex sit amet sem. Pellentesque accumsan, turpis non dapibus aliquet, nisi erat maximus ex, at scelerisque lorem dolor a turpis. Aliquam volutpat eros sit amet iaculis ultrices. Ut diam ipsum, ultrices vel dolor egestas, rhoncus fringilla.\n\n#### Zmienne Numeryczne\n\n\n::: {.cell}\n\n```{.r .cell-code}\nzmienna_wykres(badania, \"numeryczna\", \"violin\")\nzmienna_wykres(badania, \"numeryczna\", \"histogram\")\n```\n:::\n\n\n::: panel-tabset\n## Violin\n\n![](images/plots/numeryczna_violin1.png){fig-align=\"center\"}\n\n![](images/plots/numeryczna_violin2.png){fig-align=\"center\"}\n\n## Histogram\n\n![](images/plots/numeryczna_histogram1.png){fig-align=\"center\"}\n\n![](images/plots/numeryczna_histogram2.png){fig-align=\"center\"}\n:::\n\nMorbi posuere mattis magna, et ornare lacus gravida sed. Nullam nulla mauris, aliquam et faucibus quis, ultrices id nisl. Quisque eu dolor at odio vulputate hendrerit. Morbi ut fringilla eros, ac dapibus velit. Aenean facilisis lacinia facilisis. Morbi ultricies urna a nibh molestie gravida. Aenean et tincidunt tortor. Sed ut nisi lacinia, volutpat ipsum quis, tristique ligula.\n\n### Podsumowanie gotowych danych\n\nMaecenas et neque viverra, varius orci non, pharetra ipsum. Donec sit amet ornare tortor. Nulla facilisi. Proin laoreet mollis est sit amet mattis. Integer scelerisque ultrices dapibus. Vestibulum mattis lacus tristique, accumsan velit in, volutpat metus. Interdum et malesuada fames ac ante ipsum primis in faucibus. Vivamus ut turpis in est pulvinar volutpat in eu ipsum. In erat arcu, congue sit amet leo vitae, congue blandit lacus. Integer tincidunt velit dictum consectetur molestie. Sed at metus tortor.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nskim(badania)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |        |\n|:------------------------|:-------|\n|Name                     |badania |\n|Number of rows           |4240    |\n|Number of columns        |16      |\n|_______________________  |        |\n|Column type frequency:   |        |\n|factor                   |8       |\n|numeric                  |8       |\n|________________________ |        |\n|Group variables          |None    |\n\n\n**Variable type: factor**\n\n|skim_variable   | n_missing| complete_rate|ordered | n_unique|top_counts                       |\n|:---------------|---------:|-------------:|:-------|--------:|:--------------------------------|\n|sex             |         0|          1.00|FALSE   |        2|Fem: 2420, Mal: 1820             |\n|education       |       105|          0.98|FALSE   |        4|1: 1720, 2: 1253, 3: 689, 4: 473 |\n|diabetes        |         0|          1.00|FALSE   |        2|No: 4131, Yes: 109               |\n|currentSmoker   |         0|          1.00|FALSE   |        2|No: 2145, Yes: 2095              |\n|BPMeds          |        53|          0.99|FALSE   |        2|No: 4063, Yes: 124               |\n|prevalentStroke |         0|          1.00|FALSE   |        2|No: 4215, Yes: 25                |\n|prevalentHyp    |         0|          1.00|FALSE   |        2|No: 2923, Yes: 1317              |\n|TenYearCHD      |         0|          1.00|FALSE   |        2|No: 3596, Yes: 644               |\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|   mean|    sd|     p0|    p25|   p50|    p75|  p100|hist  |\n|:-------------|---------:|-------------:|------:|-----:|------:|------:|-----:|------:|-----:|:-----|\n|age           |         0|          1.00|  49.58|  8.57|  32.00|  42.00|  49.0|  56.00|  70.0|▃▇▆▆▂ |\n|sysBP         |         0|          1.00| 132.35| 22.03|  83.50| 117.00| 128.0| 144.00| 295.0|▇▇▁▁▁ |\n|diaBP         |         0|          1.00|  82.90| 11.91|  48.00|  75.00|  82.0|  90.00| 142.5|▁▇▅▁▁ |\n|heartRate     |         1|          1.00|  75.88| 12.03|  44.00|  68.00|  75.0|  83.00| 143.0|▂▇▃▁▁ |\n|BMI           |        19|          1.00|  25.80|  4.08|  15.54|  23.07|  25.4|  28.04|  56.8|▅▇▁▁▁ |\n|totChol       |        50|          0.99| 236.70| 44.59| 107.00| 206.00| 234.0| 263.00| 696.0|▆▇▁▁▁ |\n|glucose       |       388|          0.91|  81.96| 23.95|  40.00|  71.00|  78.0|  87.00| 394.0|▇▁▁▁▁ |\n|cigsPerDay    |        29|          0.99|   9.01| 11.92|   0.00|   0.00|   0.0|  20.00|  70.0|▇▃▁▁▁ |\n\n\n:::\n:::\n\n\n## Wizualizacje\n\nLorem ipsum dolor sit amet consectetur adipiscing elit quisque faucibus ex sapien vitae pellentesque sem placerat in id cursus mi pretium tellus duis convallis tempus leo eu aenean sed diam urna tempor pulvinar vivamus fringilla lacus nec metus bibendum egestas iaculis massa nisl malesuada lacinia integer nunc posuere ut hendrerit semper vel class aptent taciti sociosqu ad litora torquent per conubia nostra inceptos himenaeos orci varius natoque penatibus et magnis dis parturient montes nascetur ridiculus mus donec rhoncus eros lobortis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata2 <- read.csv2(\"data/badania2.csv\", sep=\",\")\nkable(head(data2))\n```\n\n::: {.cell-output-display}\n\n\n| RANDID| SEX| TOTCHOL| AGE|SYSBP |DIABP | CURSMOKE| CIGPDAY|BMI   | DIABETES| BPMEDS| HEARTRTE| GLUCOSE| educ| PREVCHD| PREVAP| PREVMI| PREVSTRK| PREVHYP| TIME| PERIOD| HDLC| LDLC| DEATH| ANGINA| HOSPMI| MI_FCHD| ANYCHD| STROKE| CVD| HYPERTEN| TIMEAP| TIMEMI| TIMEMIFC| TIMECHD| TIMESTRK| TIMECVD| TIMEDTH| TIMEHYP|\n|------:|---:|-------:|---:|:-----|:-----|--------:|-------:|:-----|--------:|------:|--------:|-------:|----:|-------:|------:|------:|--------:|-------:|----:|------:|----:|----:|-----:|------:|------:|-------:|------:|------:|---:|--------:|------:|------:|--------:|-------:|--------:|-------:|-------:|-------:|\n|   2448|   1|     195|  39|106   |70    |        0|       0|26.97 |        0|      0|       80|      77|    4|       0|      0|      0|        0|       0|    0|      1|   NA|   NA|     0|      0|      1|       1|      1|      0|   1|        0|   8766|   6438|     6438|    6438|     8766|    6438|    8766|    8766|\n|   2448|   1|     209|  52|121   |66    |        0|       0|      |        0|      0|       69|      92|    4|       0|      0|      0|        0|       0| 4628|      3|   31|  178|     0|      0|      1|       1|      1|      0|   1|        0|   8766|   6438|     6438|    6438|     8766|    6438|    8766|    8766|\n|   6238|   2|     250|  46|121   |81    |        0|       0|28.73 |        0|      0|       95|      76|    2|       0|      0|      0|        0|       0|    0|      1|   NA|   NA|     0|      0|      0|       0|      0|      0|   0|        0|   8766|   8766|     8766|    8766|     8766|    8766|    8766|    8766|\n|   6238|   2|     260|  52|105   |69.5  |        0|       0|29.43 |        0|      0|       80|      86|    2|       0|      0|      0|        0|       0| 2156|      2|   NA|   NA|     0|      0|      0|       0|      0|      0|   0|        0|   8766|   8766|     8766|    8766|     8766|    8766|    8766|    8766|\n|   6238|   2|     237|  58|108   |66    |        0|       0|28.5  |        0|      0|       80|      71|    2|       0|      0|      0|        0|       0| 4344|      3|   54|  141|     0|      0|      0|       0|      0|      0|   0|        0|   8766|   8766|     8766|    8766|     8766|    8766|    8766|    8766|\n|   9428|   1|     245|  48|127.5 |80    |        1|      20|25.34 |        0|      0|       75|      70|    1|       0|      0|      0|        0|       0|    0|      1|   NA|   NA|     0|      0|      0|       0|      0|      0|   0|        0|   8766|   8766|     8766|    8766|     8766|    8766|    8766|    8766|\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Liczba kolumn w naszym dataset:\", ncol(badania), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLiczba kolumn w naszym dataset: 16 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Liczba kolumn w dodatkowym dataset:\", ncol(data2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLiczba kolumn w dodatkowym dataset: 39\n```\n\n\n:::\n\n```{.r .cell-code}\nnazwy1 <- sort(tolower(append(colnames(badania), rep(\"-\", times=(ncol(data2) - ncol(badania))))))\nnazwy2 <- sort(tolower(colnames(data2)))\nkolumny <- tibble(nazwy1, nazwy2)\noutput <- data.frame(Lp.=c(1:17),\n                     ObecnyDataset = sort(tolower(colnames(badania)))[1:17],\n                     NowyDataset = as.character(c(\"\\u2713\",\"\\u2713\", \"\\u2713\", \"\\u2713\", \"\\u2713\", \"\\u2713\", \"\\u2713\", \"\\u2713\", \"\\u2713\", \"\\u2713\", \"\\u2713\", \"\\u2713\", \"\\u2713\",\"\\u2713\", \"\\u2713\", \"\\u2717\", \"\\u2713\")))\nkable(output)\n```\n\n::: {.cell-output-display}\n\n\n| Lp.|ObecnyDataset   |NowyDataset |\n|---:|:---------------|:-----------|\n|   1|age             |✓           |\n|   2|bmi             |✓           |\n|   3|bpmeds          |✓           |\n|   4|cigsperday      |✓           |\n|   5|currentsmoker   |✓           |\n|   6|diabetes        |✓           |\n|   7|diabp           |✓           |\n|   8|education       |✓           |\n|   9|glucose         |✓           |\n|  10|heartrate       |✓           |\n|  11|prevalenthyp    |✓           |\n|  12|prevalentstroke |✓           |\n|  13|sex             |✓           |\n|  14|sysbp           |✓           |\n|  15|tenyearchd      |✓           |\n|  16|totchol         |✗           |\n|  17|NA              |✓           |\n\n\n:::\n:::\n\n\n## Rozwiązanie Problemu\n\nPellentesque enim ante, pellentesque ornare lacus sed, mattis bibendum nibh. Vestibulum accumsan nec libero a efficitur. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Aenean blandit leo enim, nec vehicula diam mollis vel. Vivamus mattis ante quam, a rhoncus lacus auctor id.\n\n\n::: {.cell}\n\n:::\n\n\n## Wnioski\n\nDonec sit amet ornare tortor. Nulla facilisi. Proin laoreet mollis est sit amet mattis. Integer scelerisque ultrices dapibus. Vestibulum mattis lacus tristique, accumsan velit in, volutpat metus. Interdum et malesuada fames ac ante ipsum primis in faucibus. Vivamus ut turpis in est pulvinar volutpat in eu ipsum. In erat arcu, congue sit amet leo vitae, congue blandit lacus. Integer tincidunt velit dictum consectetur molestie. Sed at metus tortor.\n\n\n::: {.cell}\n\n:::\n\n\n## Zakończenie\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum justo odio, pharetra et porttitor vel, aliquam non lectus. Etiam a diam sed ex volutpat iaculis nec ut diam. Donec tempus lectus in erat finibus auctor. Integer rutrum pellentesque finibus. Maecenas suscipit arcu sed nisl consequat, id finibus diam maximus. Vivamus sit amet felis id sapien imperdiet pharetra. Nulla efficitur, erat id lobortis hendrerit, ante purus venenatis turpis, eu ultrices erat tellus eu tellus. Nullam auctor nisi quis turpis iaculis, vel tincidunt dui laoreet. Nullam a gravida dolor, ornare suscipit lectus. Integer fermentum bibendum dui. Duis sodales sollicitudin auctor. Sed sollicitudin sed lorem quis mattis. Suspendisse potenti. Aliquam efficitur metus dolor, nec volutpat felis commodo vel. Integer accumsan sem at pellentesque dignissim.\n\nProin lacinia ipsum turpis, tincidunt porta metus imperdiet in. Curabitur aliquam sapien urna, sit amet congue nulla varius nec. Vivamus vehicula est et sapien hendrerit consequat. Phasellus et urna odio. Proin fermentum mi ut mi varius tincidunt. Nam dui ipsum, blandit dignissim lectus ut, molestie vestibulum dui. Vestibulum dolor erat, aliquam id est a, pellentesque ornare elit. Nunc bibendum elementum ex eu ultrices. Proin elementum nunc non lobortis fringilla. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Nulla facilisi. Mauris sit amet purus non orci bibendum molestie. Suspendisse sollicitudin ultrices odio ac lacinia.\n\nEtiam et nisl lorem. Donec vitae orci sed orci scelerisque rutrum. Sed mollis est a pulvinar rhoncus. Pellentesque lacinia justo nec arcu finibus, vel sodales odio commodo. Nunc tincidunt consequat enim id tristique. Sed eget eros fermentum, lacinia odio in, porttitor tortor. Nulla gravida augue neque. Sed fermentum neque vel orci placerat venenatis. In posuere at nisi quis porttitor. In placerat nisl ut ex finibus, in rhoncus felis molestie. Nunc pellentesque eros tortor, sed pharetra nunc mattis quis. Phasellus a lacus id arcu faucibus vehicula. Praesent et ex et dolor eleifend vehicula. Integer at consectetur erat.\n\nNulla tincidunt felis maximus convallis sagittis. Phasellus dui dui, sodales sit amet lacus malesuada, molestie rhoncus dui. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Vivamus maximus at risus quis.\n\n\n::: {.cell}\n\n:::\n\n\n## Literatura\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum justo odio, pharetra et porttitor vel, aliquam non lectus. Etiam a diam sed ex volutpat iaculis nec ut diam. Donec tempus lectus in erat finibus auctor. Integer rutrum pellentesque finibus. Maecenas suscipit arcu sed nisl consequat, id finibus diam maximus. Vivamus sit amet felis id sapien imperdiet pharetra. Nulla efficitur, erat id lobortis hendrerit, ante purus venenatis turpis, eu ultrices erat tellus eu tellus. Nullam auctor nisi quis turpis iaculis, vel tincidunt dui laoreet. Nullam a gravida dolor, ornare suscipit lectus. Integer fermentum bibendum dui. Duis sodales sollicitudin auctor. Sed sollicitudin sed lorem quis mattis. Suspendisse potenti. Aliquam efficitur metus dolor, nec volutpat felis commodo vel. Integer accumsan sem at pellentesque dignissim.\n\nProin lacinia ipsum turpis, tincidunt porta metus imperdiet in. Curabitur aliquam sapien urna, sit amet congue nulla varius nec. Vivamus vehicula est et sapien hendrerit consequat. Phasellus et urna odio. Proin fermentum mi ut mi varius tincidunt. Nam dui ipsum, blandit dignissim lectus ut, molestie vestibulum dui. Vestibulum dolor erat, aliquam id est a, pellentesque ornare elit. Nunc bibendum elementum ex eu ultrices.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}