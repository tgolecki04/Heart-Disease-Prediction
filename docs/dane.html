<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pl" xml:lang="pl"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Wczesne Wykrywanie Ryzyka Zawału Serca</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./modele.html" rel="next">
<link href="./plan.html" rel="prev">
<link href="./images/favicon/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-0a95de2c3be981c2e03029825b16c585.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-0a95de2c3be981c2e03029825b16c585.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-0a95de2c3be981c2e03029825b16c585.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-247018db65c17c6531d189638f274423.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-cb830679cd83599445d1244e55181dfe.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-247018db65c17c6531d189638f274423.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "Brak wyników",
    "search-matching-documents-text": "dopasowane dokumenty",
    "search-copy-link-title": "Kopiuj link do wyszukiwania",
    "search-hide-matches-text": "Ukryj dodatkowe dopasowania",
    "search-more-match-text": "więcej dopasowań w tym dokumencie",
    "search-more-matches-text": "więcej dopasowań w tym dokumencie",
    "search-clear-button-title": "Wyczyść",
    "search-text-placeholder": "Szukaj",
    "search-detached-cancel-button-title": "Anuluj",
    "search-submit-button-title": "Zatwierdź",
    "search-label": "Szukaj"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: #fcfffd;
      }

      .quarto-title-block .quarto-title-banner {
        color: #fcfffd;
background: #947E76;
      }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles/styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Przełącz nawigację" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> <i class="bi bi-box-seam" role="img">
</i> 
<span class="menu-text">Strona Główna</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./aplikacja.html"> <i class="bi bi-code-slash" role="img">
</i> 
<span class="menu-text">Aplikacja</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./sprawozdanie.html"> <i class="bi bi-book" role="img">
</i> 
<span class="menu-text">Sprawozdanie</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.kaggle.com/datasets/noeyislearning/framingham-heart-study"> <i class="bi bi-database" role="img">
</i> 
<span class="menu-text">Dataset</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://pollub.pl/"> <i class="bi bi-rocket-takeoff" role="img">
</i> 
<span class="menu-text">Politechnika Lubelska</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./kontakt.html"> <i class="bi bi-people" role="img">
</i> 
<span class="menu-text">Kontakt</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/tgolecki04/Heart-Disease-Prediction"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Przełącz tryb ciemny"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Przełącz pasek boczny" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./dane.html"><i class="bi bi-dot"></i>Dane &amp; Analiza <i class="bi bi-clipboard-data"></i></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Przełącz pasek boczny" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Szukaj" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Wczesne Wykrywanie Ryzyka Zawału Serca</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Kod</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Pokaż cały kod</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Ukryj cały kod</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Pokaż źródło</a></li></ul></div></div>
            <p class="subtitle lead">Zapoznanie I Praca Z Danymi</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta column-body">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/article/logo_pollub.jpg" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="./images/article/logo_pollub.jpg" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Szukaj"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><i class="bi bi-dot"></i>Wstęp <i class="bi bi-chat-left-text"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./plan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><i class="bi bi-dot"></i>Plan Projektu <i class="bi bi-box-seam"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dane.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><i class="bi bi-dot"></i>Dane &amp; Analiza <i class="bi bi-clipboard-data"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modele.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><i class="bi bi-dot"></i>Modele <i class="bi bi-cpu"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wnioski.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><i class="bi bi-dot"></i>Wnioski <i class="bi bi-clipboard-check"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./zakonczenie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><i class="bi bi-dot"></i>Zakończenie <i class="bi bi-book"></i></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literatura.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><i class="bi bi-dot"></i>Literatura <i class="bi bi-journal-code"></i></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Spis treści</h2>
   
  <ul>
  <li><a href="#rozpoczęcie" id="toc-rozpoczęcie" class="nav-link active" data-scroll-target="#rozpoczęcie"><span class="header-section-number">1</span> Rozpoczęcie</a></li>
  <li><a href="#biblioteki" id="toc-biblioteki" class="nav-link" data-scroll-target="#biblioteki"><span class="header-section-number">2</span> Biblioteki</a></li>
  <li><a href="#zapoznanie-z-danymi" id="toc-zapoznanie-z-danymi" class="nav-link" data-scroll-target="#zapoznanie-z-danymi"><span class="header-section-number">3</span> Zapoznanie z Danymi</a></li>
  <li><a href="#opis-i-wyjaśnienie-zmiennych" id="toc-opis-i-wyjaśnienie-zmiennych" class="nav-link" data-scroll-target="#opis-i-wyjaśnienie-zmiennych"><span class="header-section-number">4</span> Opis i wyjaśnienie zmiennych</a></li>
  <li><a href="#uzupełnienie-brakujących-wartości" id="toc-uzupełnienie-brakujących-wartości" class="nav-link" data-scroll-target="#uzupełnienie-brakujących-wartości"><span class="header-section-number">5</span> Uzupełnienie brakujących wartości</a></li>
  <li><a href="#analiza-danych" id="toc-analiza-danych" class="nav-link" data-scroll-target="#analiza-danych"><span class="header-section-number">6</span> Analiza Danych</a>
  <ul class="collapse">
  <li><a href="#funkcja-tworzenia-wykresów" id="toc-funkcja-tworzenia-wykresów" class="nav-link" data-scroll-target="#funkcja-tworzenia-wykresów"><span class="header-section-number">6.1</span> Funkcja Tworzenia Wykresów</a></li>
  <li><a href="#zmienne-kategoryczne" id="toc-zmienne-kategoryczne" class="nav-link" data-scroll-target="#zmienne-kategoryczne"><span class="header-section-number">6.2</span> Zmienne Kategoryczne</a></li>
  <li><a href="#zmienne-numeryczne" id="toc-zmienne-numeryczne" class="nav-link" data-scroll-target="#zmienne-numeryczne"><span class="header-section-number">6.3</span> Zmienne numeryczne</a></li>
  <li><a href="#zależności-pomiędzy-zmiennymi" id="toc-zależności-pomiędzy-zmiennymi" class="nav-link" data-scroll-target="#zależności-pomiędzy-zmiennymi"><span class="header-section-number">6.4</span> Zależności pomiędzy zmiennymi</a></li>
  <li><a href="#relacja-pomiędzy-diabp-oraz-sysbp" id="toc-relacja-pomiędzy-diabp-oraz-sysbp" class="nav-link" data-scroll-target="#relacja-pomiędzy-diabp-oraz-sysbp"><span class="header-section-number">6.5</span> Relacja pomiędzy diaBP oraz sysBP</a></li>
  <li><a href="#ciśnienie-rozkurczowe" id="toc-ciśnienie-rozkurczowe" class="nav-link" data-scroll-target="#ciśnienie-rozkurczowe"><span class="header-section-number">6.6</span> Ciśnienie rozkurczowe</a></li>
  <li><a href="#ciśnienie-skurczowe" id="toc-ciśnienie-skurczowe" class="nav-link" data-scroll-target="#ciśnienie-skurczowe"><span class="header-section-number">6.7</span> Ciśnienie skurczowe</a></li>
  <li><a href="#zakres-pracy-serca-a-ryzyko-zawału" id="toc-zakres-pracy-serca-a-ryzyko-zawału" class="nav-link" data-scroll-target="#zakres-pracy-serca-a-ryzyko-zawału"><span class="header-section-number">6.8</span> Zakres pracy serca, a ryzyko zawału</a></li>
  <li><a href="#ciśnienie-serca-jako-przyczyna-zawału-serca" id="toc-ciśnienie-serca-jako-przyczyna-zawału-serca" class="nav-link" data-scroll-target="#ciśnienie-serca-jako-przyczyna-zawału-serca"><span class="header-section-number">6.9</span> Ciśnienie serca jako przyczyna zawału serca</a></li>
  <li><a href="#analiza-wartości-tętna" id="toc-analiza-wartości-tętna" class="nav-link" data-scroll-target="#analiza-wartości-tętna"><span class="header-section-number">6.10</span> Analiza wartości tętna</a></li>
  <li><a href="#leki-na-nadciśnienie-i-ich-skutek" id="toc-leki-na-nadciśnienie-i-ich-skutek" class="nav-link" data-scroll-target="#leki-na-nadciśnienie-i-ich-skutek"><span class="header-section-number">6.11</span> Leki na nadciśnienie i ich skutek</a></li>
  <li><a href="#skutki-palenia-na-układ-krążenia" id="toc-skutki-palenia-na-układ-krążenia" class="nav-link" data-scroll-target="#skutki-palenia-na-układ-krążenia"><span class="header-section-number">6.12</span> Skutki palenia na układ krążenia</a></li>
  <li><a href="#relacja-pomiędzy-zmienną-age-a-zmienną-cigsperday" id="toc-relacja-pomiędzy-zmienną-age-a-zmienną-cigsperday" class="nav-link" data-scroll-target="#relacja-pomiędzy-zmienną-age-a-zmienną-cigsperday"><span class="header-section-number">6.13</span> Relacja pomiędzy zmienną <code>age</code>, a zmienną <code>cigsPerDay</code></a></li>
  <li><a href="#model-regresji-logistycznej" id="toc-model-regresji-logistycznej" class="nav-link" data-scroll-target="#model-regresji-logistycznej"><span class="header-section-number">6.14</span> Model regresji logistycznej</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-body" id="quarto-document-content">






<section id="rozpoczęcie" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="rozpoczęcie"><span class="header-section-number">1</span> Rozpoczęcie</h2>
<p>W tej części projektu skupimy się na pracy z naszymi danymi. Zapoznamy się z ich strukturą oraz właściwościami. Poznamy podstawowe statystyki wyjaśniające dokładnie każdą ze zmiennych. Pozwoli nam to na wysnucie pewnych przypuszczeń, które postaramy się zbadać i wyjaśnić za pomocą analizy i wizualizacji. Dodatkowo przeprowadzimy odpowiednie testy statystyczne, aby dokładniej określić właściwości naszych zmiennych, m. in. różnicę wartości średniej w grupach oraz istotność zmiennych. Postaramy się odpowiedzień na wcześniej postawione hipotezy i poszerzyć odpowiedź o informacje zdobyte podczas analizy. Po przeprowadzeniu wszystkich etapów związanych z pracą nad danymi przejdziemy do tworzenia modeli predykcyjnych i obliczaniu ich statystyk. Podczas projektu użyliśmy następujących bibliotek.</p>
</section>
<section id="biblioteki" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="biblioteki"><span class="header-section-number">2</span> Biblioteki</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tinythemes)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VennDiagram)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggVennDiagram)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="zapoznanie-z-danymi" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="zapoznanie-z-danymi"><span class="header-section-number">3</span> Zapoznanie z Danymi</h2>
<p>Wczytanie pliku z rozszerzeniem <code>csv</code> do zmiennej o nazwie <code>data</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">"data/badania.csv"</span>, <span class="at">sep=</span><span class="st">","</span>)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Sprawdźmy jak wyglądają nasze dane. Użyjemy do tego funkcji <code>head()</code> oraz <code>tail()</code> do podglądu kilku pierwszych i ostatnich obserwacji w naszym zbiorze danych. Pierwsze 10 obserwacji ma postać:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">male</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">education</th>
<th style="text-align: right;">currentSmoker</th>
<th style="text-align: right;">cigsPerDay</th>
<th style="text-align: right;">BPMeds</th>
<th style="text-align: right;">prevalentStroke</th>
<th style="text-align: right;">prevalentHyp</th>
<th style="text-align: right;">diabetes</th>
<th style="text-align: right;">totChol</th>
<th style="text-align: left;">sysBP</th>
<th style="text-align: left;">diaBP</th>
<th style="text-align: left;">BMI</th>
<th style="text-align: right;">heartRate</th>
<th style="text-align: right;">glucose</th>
<th style="text-align: right;">TenYearCHD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">195</td>
<td style="text-align: left;">106</td>
<td style="text-align: left;">70</td>
<td style="text-align: left;">26.97</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">250</td>
<td style="text-align: left;">121</td>
<td style="text-align: left;">81</td>
<td style="text-align: left;">28.73</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">245</td>
<td style="text-align: left;">127.5</td>
<td style="text-align: left;">80</td>
<td style="text-align: left;">25.34</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">225</td>
<td style="text-align: left;">150</td>
<td style="text-align: left;">95</td>
<td style="text-align: left;">28.58</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">46</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">285</td>
<td style="text-align: left;">130</td>
<td style="text-align: left;">84</td>
<td style="text-align: left;">23.1</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">228</td>
<td style="text-align: left;">180</td>
<td style="text-align: left;">110</td>
<td style="text-align: left;">30.3</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">99</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Natomiast kilka ostatnich obserwcji nad którymi bedziemy pracować mają postać:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(data)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">male</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">education</th>
<th style="text-align: right;">currentSmoker</th>
<th style="text-align: right;">cigsPerDay</th>
<th style="text-align: right;">BPMeds</th>
<th style="text-align: right;">prevalentStroke</th>
<th style="text-align: right;">prevalentHyp</th>
<th style="text-align: right;">diabetes</th>
<th style="text-align: right;">totChol</th>
<th style="text-align: left;">sysBP</th>
<th style="text-align: left;">diaBP</th>
<th style="text-align: left;">BMI</th>
<th style="text-align: right;">heartRate</th>
<th style="text-align: right;">glucose</th>
<th style="text-align: right;">TenYearCHD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">4235</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">207</td>
<td style="text-align: left;">126.5</td>
<td style="text-align: left;">80</td>
<td style="text-align: left;">19.71</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">4236</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">248</td>
<td style="text-align: left;">131</td>
<td style="text-align: left;">72</td>
<td style="text-align: left;">22</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4237</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">210</td>
<td style="text-align: left;">126.5</td>
<td style="text-align: left;">87</td>
<td style="text-align: left;">19.16</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">4238</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">269</td>
<td style="text-align: left;">133.5</td>
<td style="text-align: left;">83</td>
<td style="text-align: left;">21.47</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4239</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">185</td>
<td style="text-align: left;">141</td>
<td style="text-align: left;">98</td>
<td style="text-align: left;">25.6</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">4240</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">196</td>
<td style="text-align: left;">133</td>
<td style="text-align: left;">86</td>
<td style="text-align: left;">20.91</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Spradźmy rozmiary naszej ramki danych. W tym celu posłużymy się funkcjami <code>nrow()</code> oraz <code>ncol()</code>, które zawracają odpowiednio <strong>liczbę wierszy</strong> oraz <strong>liczbę kolumn</strong>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(data)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4240</code></pre>
</div>
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(data)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16</code></pre>
</div>
</div>
<p>Widzimy że mamy ponad 4200 obserwacji i 16 zmiennych, które posłużą nam do stworzenia kilku modeli predykcyjnych i wyboru tego, który najlepiej będzie oceniał ryzyko zawału serca. Jest to naprawdę duży zasób danych, które mogą odpowiedzieć na wiele interesujących pytań. Nadszedł czas sprawdzić zmienne, które posiadamy. Użyjemy do tego funkcji <code>colnames().</code></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "male"            "age"             "education"       "currentSmoker"  
 [5] "cigsPerDay"      "BPMeds"          "prevalentStroke" "prevalentHyp"   
 [9] "diabetes"        "totChol"         "sysBP"           "diaBP"          
[13] "BMI"             "heartRate"       "glucose"         "TenYearCHD"     </code></pre>
</div>
</div>
<p>Okazuje się, że nasz zbiór zawiera cenne informacje medyczne takie jak:</p>
<ol type="1">
<li><p>Tętno</p></li>
<li><p>BMI</p></li>
<li><p>Ciśnienie skurczowe i rozkurczowe</p></li>
<li><p>Poziom cholesterolu i glukozy</p></li>
<li><p>Informacje o tym, czy pacjent był palaczem, czy też nie</p></li>
</ol>
<p>Dokładniej przyjrzymy się naszym zmiennym w dalszej części analizy zbioru danych. Wyjaśnimy dokładniej cechy poszczególnych kolumn zbioru danych oraz ich podstawowe statystyki. Czas sprawdzić podstawowe statystki dotyczące danych oraz to z jakimi typami danych będziemy pracować.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(data)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">data</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">4240</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">13</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sysBP</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">234</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">diaBP</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">146</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1364</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">male</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▆</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">49.58</td>
<td style="text-align: right;">8.57</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">70</td>
<td style="text-align: left;">▃▇▆▆▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">education</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">1.98</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">▇▆▁▃▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">currentSmoker</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cigsPerDay</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">9.01</td>
<td style="text-align: right;">11.92</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">70</td>
<td style="text-align: left;">▇▃▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">BPMeds</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prevalentStroke</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">prevalentHyp</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">diabetes</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">totChol</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">236.70</td>
<td style="text-align: right;">44.59</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">206</td>
<td style="text-align: right;">234</td>
<td style="text-align: right;">263</td>
<td style="text-align: right;">696</td>
<td style="text-align: left;">▆▇▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">heartRate</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">75.88</td>
<td style="text-align: right;">12.03</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">143</td>
<td style="text-align: left;">▂▇▃▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">glucose</td>
<td style="text-align: right;">388</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">81.96</td>
<td style="text-align: right;">23.95</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">78</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">394</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TenYearCHD</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">▇▁▁▁▂</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Tak jak widać na powyższym raporcie, zaczytując dane otrzymujemy 3 zmienne typu <code>character</code> oraz 13 zmiennych typu <code>numeric</code>. Taki podział ze względu na typ zmiennych nie jest odpowiedni. Wszystkie cechy typu <code>character</code> mają w naszym przypadku błędne formatowanie. Dodatkowo będziemy musieli dodać nowe typy zmiennych takie jak <code>boolean</code> oraz <code>factor</code>, aby móc szybko i praktycznie pracować z danymi. Odpowiedni wybór typów zmiennych jest podstawowym krokiem rozpczynając analizę zbioru danych. Zrobimy to w następujący sposób.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sysBP =</span> <span class="fu">as.numeric</span>(sysBP),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">diaBP =</span> <span class="fu">as.numeric</span>(diaBP),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">BMI =</span> <span class="fu">as.numeric</span>(BMI),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">factor</span>(male, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>)),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">education =</span> <span class="fu">factor</span>(education, <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">currentSmoker =</span> <span class="fu">factor</span>(currentSmoker, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">BPMeds =</span> <span class="fu">factor</span>(BPMeds, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">prevalentStroke =</span> <span class="fu">factor</span>(prevalentStroke, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">prevalentHyp =</span> <span class="fu">factor</span>(prevalentHyp, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">diabetes =</span> <span class="fu">factor</span>(diabetes, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">TenYearCHD =</span> <span class="fu">factor</span>(TenYearCHD, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>))</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>male)   </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> badania[<span class="fu">order</span>(<span class="fu">is.na</span>(badania<span class="sc">$</span>glucose), <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>W tym momencie wszystkie zmienne mają przypisane odpowiednie typy danych, co pozwoli zaoszczędzić czas podczas przeprowadzania obliczeń i analizy nad nimi. Dla wygody uporządkujemy teraz kolumny w odpowiedniej dla nas kolejności, tak aby informacje powiązane ze sobą były obok siebie (Np. zmienna <code>glucose</code> obok zmiennej <code>diabetes</code>)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(badania, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>, <span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">12</span>, <span class="dv">9</span>, <span class="dv">14</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">15</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(badania)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">age</th>
<th style="text-align: left;">sex</th>
<th style="text-align: left;">education</th>
<th style="text-align: right;">sysBP</th>
<th style="text-align: right;">diaBP</th>
<th style="text-align: right;">heartRate</th>
<th style="text-align: right;">BMI</th>
<th style="text-align: right;">totChol</th>
<th style="text-align: right;">glucose</th>
<th style="text-align: left;">diabetes</th>
<th style="text-align: right;">cigsPerDay</th>
<th style="text-align: left;">currentSmoker</th>
<th style="text-align: left;">BPMeds</th>
<th style="text-align: left;">prevalentStroke</th>
<th style="text-align: left;">prevalentHyp</th>
<th style="text-align: left;">TenYearCHD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">15</td>
<td style="text-align: right;">39</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">114.0</td>
<td style="text-align: right;">64.0</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">22.35</td>
<td style="text-align: right;">226</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">22</td>
<td style="text-align: right;">43</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">123.5</td>
<td style="text-align: right;">77.5</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">29.89</td>
<td style="text-align: right;">185</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">27</td>
<td style="text-align: right;">60</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">110.0</td>
<td style="text-align: right;">72.5</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">26.59</td>
<td style="text-align: right;">260</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">43</td>
<td style="text-align: right;">52</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">148.0</td>
<td style="text-align: right;">92.0</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">25.09</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">55</td>
<td style="text-align: right;">39</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">115.0</td>
<td style="text-align: right;">75.0</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">22.54</td>
<td style="text-align: right;">209</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">20</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">71</td>
<td style="text-align: right;">63</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">164.5</td>
<td style="text-align: right;">76.0</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">29.35</td>
<td style="text-align: right;">248</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">No</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Zrobione. Teraz możemy przejść do wyjaśnienia zmiennych, aby było jasne z czym pracujemy oraz na czym możemy polegać podczas wykonywania analizy.</p>
</section>
<section id="opis-i-wyjaśnienie-zmiennych" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="opis-i-wyjaśnienie-zmiennych"><span class="header-section-number">4</span> Opis i wyjaśnienie zmiennych</h2>
<p>Poniżej znajduje się tabela zawierająca wszystkie cechy wraz z ich wytłumaczeniem.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 41%">
<col style="width: 37%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Zmienna</th>
<th style="text-align: center;">Opis</th>
<th style="text-align: center;">Jednostka</th>
<th style="text-align: center;">Typ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>age</code></td>
<td style="text-align: center;">Wiek (w latach)</td>
<td style="text-align: center;">Lata</td>
<td style="text-align: center;"><code>int</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>sex</code></td>
<td style="text-align: center;">Płeć (1 - Mężczyzna, 0 - Kobieta)</td>
<td style="text-align: center;">Brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>education</code></td>
<td style="text-align: center;"><p>Wykształcenie</p>
<p>(1 - Brak ukończonej szkoły średniej,</p>
<p>2 - Ukończona szkoła średnia,</p>
<p>3 - Nieukończone studia lub ukończona szkoła zawodowa,</p>
<p>4 - Wykształcenie Wyższe)</p></td>
<td style="text-align: center;">Brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>sysBP</code></td>
<td style="text-align: center;">Wartość ciśnienia skurczowego (Średnia ostatnich dwóch pomiarów)</td>
<td style="text-align: center;">mmHg</td>
<td style="text-align: center;"><code>numerical</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>diaBP</code></td>
<td style="text-align: center;">Wartość ciśnienia rozkurczowego (Średnia ostatnich dwóch pomiarów)</td>
<td style="text-align: center;">mmHg</td>
<td style="text-align: center;"><code>numerical</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>heartRate</code></td>
<td style="text-align: center;">Poziom tętna ()</td>
<td style="text-align: center;">Uderzeń na minutę</td>
<td style="text-align: center;"><code>int</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>BMI</code></td>
<td style="text-align: center;">Wartość współczynnika BMI</td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{\text{masa (kg)}}{\text{wzrost (m)}^2}\)</span></td>
<td style="text-align: center;"><code>float</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>totalChol</code></td>
<td style="text-align: center;">Wartość poziomu cholesterolu ()</td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{\text{mg}}{\text{dL}}\)</span></td>
<td style="text-align: center;"><code>int</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>glucose</code></td>
<td style="text-align: center;">Poziom glukozy we krwi ()</td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{\text{mg}}{\text{dL}}\)</span></td>
<td style="text-align: center;"><code>int</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>diabetes</code></td>
<td style="text-align: center;">Fakt czy pacjent jest cukrzykiem<br>
(1 - Tak, 0 - Nie)</td>
<td style="text-align: center;">brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>cigsPerDay</code></td>
<td style="text-align: center;">Średnia liczba palonych dziennie papierosów</td>
<td style="text-align: center;">sztuki</td>
<td style="text-align: center;"><code>int</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>currentSmoker</code></td>
<td style="text-align: center;">Fakt czy pacjent jest palaczem<br>
(1- Tak, 0 - Nie)</td>
<td style="text-align: center;">brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>BMPmeds</code></td>
<td style="text-align: center;">Fakt czy pacjent leczy się na nadciśnienie krwi (1 - Tak, 0 - Nie)</td>
<td style="text-align: center;">brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>prevalentStroke</code></td>
<td style="text-align: center;">Wskazuje czy pacjent przeżył udar mózgu. (1 - Tak, 0 - Nie)</td>
<td style="text-align: center;">brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>prevalentHyp</code></td>
<td style="text-align: center;">Wskazuje czy u pacjenta występowało nadciśnienie.<br>
(1 - Tak, 0 - Nie)</td>
<td style="text-align: center;">brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>TenYearCHD</code></td>
<td style="text-align: center;">Wskazuje 10-letnie ryzyko wystąpienia choroby wieńcowej u pacjenta.<br>
(1- Tak, 0-Nie)</td>
<td style="text-align: center;">brak</td>
<td style="text-align: center;"><code>factor</code></td>
</tr>
</tbody>
</table>
</section>
<section id="uzupełnienie-brakujących-wartości" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="uzupełnienie-brakujących-wartości"><span class="header-section-number">5</span> Uzupełnienie brakujących wartości</h2>
<p>Zastanówmy się co zrobić z brakami danych w naszym zbiorze badań. Przedstawmy ilość wartości <code>NA</code> dla każdej zmiennej, w której takie wartości wystepują.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>NA_count <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(badania))[<span class="fu">colSums</span>(<span class="fu">is.na</span>(badania)) <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(NA_count) <span class="ot">&lt;-</span> <span class="st">"count"</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>NA_count<span class="sc">$</span>var <span class="ot">=</span> <span class="fu">rownames</span>(NA_count)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(NA_count) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>NA_count <span class="ot">&lt;-</span> <span class="fu">select</span>(NA_count, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(NA_count, <span class="fu">aes</span>(<span class="at">x =</span> var, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">"#6AAED9"</span>) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> count), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">max</span>(NA_count<span class="sc">$</span>count) <span class="sc">*</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Liczba wartości NA w zmiennych"</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/na_count_before.png"</span>, p)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/na_count_before.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Widzimy, że mamy kilka zmiennych, które zawierają braki danych. Liczby wartośći <code>NA</code> w poszczególnych kolumnach są zazwyczaj mniejsze lub równe około 100, jedynym wyjątkiem z aż 388 wartościami <code>NA</code> jest zmienna <code>glucose</code> oznaczająca poziom glukozy we krwi pacjenta. Zanim uzupełnimy braki danych odpowiednią techniką spróbujemy dowiedzieć się w jaki sposób rozkładają się wartości <code>NA</code> tzn. czy braki te wystepują u różnych pacjentów, czy też jeden pacjent posiada brak informacji w więcej niż tylko jednej zmiennej.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>NA_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">NA_w_wierszu =</span> <span class="fu">rowSums</span>(<span class="fu">is.na</span>(badania))) <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(NA_w_wierszu) <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">liczebnosc =</span> <span class="fu">n</span>())</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> NA_df <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(NA_w_wierszu, liczebnosc)) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">"#6AAED9"</span>) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> liczebnosc), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">max</span>(NA_df<span class="sc">$</span>liczebnosc) <span class="sc">*</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Liczba wartości NA w rekordach"</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/NA_count_perRow.png"</span>, p)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/NA_count_perRow.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Do uzupełniania wartości brakujących przyjeliśmy następującą metodykę:</p>
<ul>
<li><p>Rekordy posiadające dokładnie jedną wartość <code>NA</code> uzupełnimy na podstawie metody wielokrotnej imputacji</p></li>
<li><p>Rekordy posiadające więcej niż jedną wartość <code>NA</code> odrzucamy, aby nie bazować na znacznie brakujących danych</p></li>
</ul>
<p>W zmiennej <code>badania</code> wybieramy te wiersze, w których znajduje się co najwyżej jedna wartość <code>NA</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> badania[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(badania)) <span class="sc">&lt;=</span> <span class="dv">1</span>, ]</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Wizualizacja liczby brakujących danych ma postać:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Po wczytaniu danych</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Po wstępnym usunięciu danych</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/na_count_before.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/na_count_after.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p>W tym momencie przeprowadzimy proces uzupełniania zmiennych przy pomocy funkcji <code>mice</code> - metodą wielokrotnej imputacji. Braki danych znajdują się w kolumnach o różnych typach zmiennych.</p>
<p><strong>Zmienne kategoryczne:</strong></p>
<ul>
<li><p><code>BPMeds</code></p></li>
<li><p><code>education</code></p></li>
</ul>
<p><strong>Zmienne numeryczne:</strong></p>
<ul>
<li><p><code>BMI</code></p></li>
<li><p><code>cigsPerDay</code></p></li>
<li><p><code>glucose</code></p></li>
<li><p><code>heartRate</code></p></li>
<li><p><code>totChol</code></p></li>
</ul>
<p>Ze względu na typy zmiennych oraz rozkłady, jakimi te zmienne się charakteryzują decydujemy się użyć metodę <code>pmm</code> (Predictive Mean Matching) dla zmiennych numerycznych oraz metodę <code>logreg</code> dla <code>BPMeds</code> oraz <code>polr</code> dla <code>education</code>.</p>
<p><strong>Uzasadnienie:</strong> <code>pmm</code> zachowuje rozkłady i wybiera realne obserwacje jako wartości wejściowe, co jest szczególnie ważne przy zmiennych o rozkładzie ciągłym. Dla zmiennych kategorycznych używamy odpowiednich regresji klasyfikacyjnych w zależności od cech zmiennej.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>statystyki_przed <span class="ot">&lt;-</span> <span class="fu">describe</span>(badania[NA_count<span class="sc">$</span>var])</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>metody <span class="ot">&lt;-</span> <span class="fu">make.method</span>(badania)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"BPMeds"</span>] <span class="ot">&lt;-</span> <span class="st">"logreg"</span>        <span class="co">#</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"education"</span>] <span class="ot">&lt;-</span> <span class="st">"polr"</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"BMI"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"cigsPerDay"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"glucose"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"heartRate"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"totChol"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>uzupelnienia <span class="ot">&lt;-</span> <span class="fu">mice</span>(badania,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">m =</span> <span class="dv">5</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> metody,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">seed =</span> <span class="dv">2025</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> <span class="fu">complete</span>(uzupelnienia)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>statystyki_po <span class="ot">&lt;-</span> <span class="fu">describe</span>(badania[NA_count<span class="sc">$</span>var])</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Po uzupełnieniu brakujących wartości porównajmy statystyki dla naszych zmiennych.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Przed uzupełnieniem danych</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Po uzupełnieniu danych</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(statystyki_przed))[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>), ], <span class="dv">3</span>)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">education.</th>
<th style="text-align: right;">heartRate</th>
<th style="text-align: right;">BMI</th>
<th style="text-align: right;">totChol</th>
<th style="text-align: right;">glucose</th>
<th style="text-align: right;">cigsPerDay</th>
<th style="text-align: right;">BPMeds.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">n</td>
<td style="text-align: right;">4086.000</td>
<td style="text-align: right;">4178.000</td>
<td style="text-align: right;">4166.000</td>
<td style="text-align: right;">4170.000</td>
<td style="text-align: right;">3848.000</td>
<td style="text-align: right;">4156.000</td>
<td style="text-align: right;">4128.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">mean</td>
<td style="text-align: right;">1.980</td>
<td style="text-align: right;">75.876</td>
<td style="text-align: right;">25.798</td>
<td style="text-align: right;">236.726</td>
<td style="text-align: right;">81.962</td>
<td style="text-align: right;">8.982</td>
<td style="text-align: right;">1.029</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sd</td>
<td style="text-align: right;">1.020</td>
<td style="text-align: right;">12.035</td>
<td style="text-align: right;">4.080</td>
<td style="text-align: right;">44.660</td>
<td style="text-align: right;">23.962</td>
<td style="text-align: right;">11.912</td>
<td style="text-align: right;">0.168</td>
</tr>
<tr class="even">
<td style="text-align: left;">median</td>
<td style="text-align: right;">2.000</td>
<td style="text-align: right;">75.000</td>
<td style="text-align: right;">25.385</td>
<td style="text-align: right;">234.000</td>
<td style="text-align: right;">78.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trimmed</td>
<td style="text-align: right;">1.850</td>
<td style="text-align: right;">75.194</td>
<td style="text-align: right;">25.524</td>
<td style="text-align: right;">234.666</td>
<td style="text-align: right;">78.975</td>
<td style="text-align: right;">6.871</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">mad</td>
<td style="text-align: right;">1.483</td>
<td style="text-align: right;">10.378</td>
<td style="text-align: right;">3.684</td>
<td style="text-align: right;">42.995</td>
<td style="text-align: right;">11.861</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">min</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">44.000</td>
<td style="text-align: right;">15.540</td>
<td style="text-align: right;">107.000</td>
<td style="text-align: right;">40.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">max</td>
<td style="text-align: right;">4.000</td>
<td style="text-align: right;">143.000</td>
<td style="text-align: right;">56.800</td>
<td style="text-align: right;">696.000</td>
<td style="text-align: right;">394.000</td>
<td style="text-align: right;">70.000</td>
<td style="text-align: right;">2.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">range</td>
<td style="text-align: right;">3.000</td>
<td style="text-align: right;">99.000</td>
<td style="text-align: right;">41.260</td>
<td style="text-align: right;">589.000</td>
<td style="text-align: right;">354.000</td>
<td style="text-align: right;">70.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">skew</td>
<td style="text-align: right;">0.688</td>
<td style="text-align: right;">0.647</td>
<td style="text-align: right;">0.991</td>
<td style="text-align: right;">0.870</td>
<td style="text-align: right;">6.211</td>
<td style="text-align: right;">1.251</td>
<td style="text-align: right;">5.604</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kurtosis</td>
<td style="text-align: right;">-0.718</td>
<td style="text-align: right;">0.914</td>
<td style="text-align: right;">2.687</td>
<td style="text-align: right;">4.107</td>
<td style="text-align: right;">58.585</td>
<td style="text-align: right;">1.038</td>
<td style="text-align: right;">29.414</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(statystyki_po))[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>), ], <span class="dv">3</span>)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">education.</th>
<th style="text-align: right;">heartRate</th>
<th style="text-align: right;">BMI</th>
<th style="text-align: right;">totChol</th>
<th style="text-align: right;">glucose</th>
<th style="text-align: right;">cigsPerDay</th>
<th style="text-align: right;">BPMeds.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">n</td>
<td style="text-align: right;">4179.000</td>
<td style="text-align: right;">4179.000</td>
<td style="text-align: right;">4179.000</td>
<td style="text-align: right;">4179.000</td>
<td style="text-align: right;">4179.000</td>
<td style="text-align: right;">4179.000</td>
<td style="text-align: right;">4179.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">mean</td>
<td style="text-align: right;">1.978</td>
<td style="text-align: right;">75.872</td>
<td style="text-align: right;">25.802</td>
<td style="text-align: right;">236.748</td>
<td style="text-align: right;">81.817</td>
<td style="text-align: right;">9.029</td>
<td style="text-align: right;">1.029</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sd</td>
<td style="text-align: right;">1.020</td>
<td style="text-align: right;">12.036</td>
<td style="text-align: right;">4.080</td>
<td style="text-align: right;">44.681</td>
<td style="text-align: right;">23.749</td>
<td style="text-align: right;">11.913</td>
<td style="text-align: right;">0.167</td>
</tr>
<tr class="even">
<td style="text-align: left;">median</td>
<td style="text-align: right;">2.000</td>
<td style="text-align: right;">75.000</td>
<td style="text-align: right;">25.400</td>
<td style="text-align: right;">234.000</td>
<td style="text-align: right;">78.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">trimmed</td>
<td style="text-align: right;">1.848</td>
<td style="text-align: right;">75.190</td>
<td style="text-align: right;">25.529</td>
<td style="text-align: right;">234.678</td>
<td style="text-align: right;">78.917</td>
<td style="text-align: right;">6.928</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">mad</td>
<td style="text-align: right;">1.483</td>
<td style="text-align: right;">10.378</td>
<td style="text-align: right;">3.692</td>
<td style="text-align: right;">42.995</td>
<td style="text-align: right;">11.861</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">min</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">44.000</td>
<td style="text-align: right;">15.540</td>
<td style="text-align: right;">107.000</td>
<td style="text-align: right;">40.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">max</td>
<td style="text-align: right;">4.000</td>
<td style="text-align: right;">143.000</td>
<td style="text-align: right;">56.800</td>
<td style="text-align: right;">696.000</td>
<td style="text-align: right;">394.000</td>
<td style="text-align: right;">70.000</td>
<td style="text-align: right;">2.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">range</td>
<td style="text-align: right;">3.000</td>
<td style="text-align: right;">99.000</td>
<td style="text-align: right;">41.260</td>
<td style="text-align: right;">589.000</td>
<td style="text-align: right;">354.000</td>
<td style="text-align: right;">70.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">skew</td>
<td style="text-align: right;">0.691</td>
<td style="text-align: right;">0.647</td>
<td style="text-align: right;">0.986</td>
<td style="text-align: right;">0.870</td>
<td style="text-align: right;">6.397</td>
<td style="text-align: right;">1.241</td>
<td style="text-align: right;">5.642</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kurtosis</td>
<td style="text-align: right;">-0.715</td>
<td style="text-align: right;">0.913</td>
<td style="text-align: right;">2.672</td>
<td style="text-align: right;">4.092</td>
<td style="text-align: right;">62.373</td>
<td style="text-align: right;">1.011</td>
<td style="text-align: right;">29.839</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Sprawdzając podstawowe statystki widzimy, że uzupełniając dane zachowaliśmy ich strukturę. Różnica pomiędzy wartościami statystyk polega najczęściej na zmianie części tysięcznych lub setnych, więc wartości <code>NA</code> zostały bardzo dobrze odwzorowane. Teraz możemy wykonać analizę wstępną naszego zbioru danych, aby następnie przejść do stworzenia modeli predykcyjnych oraz głębszej analizy. Ostatnim punktem pracy nad modyfikowaniem naszych danych jest zapisanie oszyszczonych i uzupełnionych danych do pliku <code>.csv</code>, który wykorzystamy m. in. podczas tworzenia modeli w języku programowania <code>R</code> lub <code>python.</code></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(badania, <span class="at">file =</span> <span class="st">"data/badania_clean.csv"</span>)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="analiza-danych" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="analiza-danych"><span class="header-section-number">6</span> Analiza Danych</h2>
<p>W trakcie wykonywynia wizualizacji bedziemy posługiwać się pacjentami, których traktujemy jako tych, którzy nie są w grupie zagrożenia oraz tych, którzy w tej grupie są. Dla ułatwienia przeprowadzania operacji stworzymy dwie ramki danych <code>zdrowi</code> oraz <code>chorzy</code> aby odwoływać się do tych grup bezpośrednio.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> <span class="fu">mutate</span>(badania, <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(badania))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>zdrowi <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(TenYearCHD <span class="sc">==</span> <span class="st">"No"</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>chorzy <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(TenYearCHD <span class="sc">==</span> <span class="st">"Yes"</span>)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="funkcja-tworzenia-wykresów" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="funkcja-tworzenia-wykresów"><span class="header-section-number">6.1</span> Funkcja Tworzenia Wykresów</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>zmienna_wykres <span class="ot">&lt;-</span> <span class="cf">function</span>(dane, typ_zmiennej, typ_wykresu) {</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  my_plots <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (typ_zmiennej <span class="sc">==</span> <span class="st">"kategoryczna"</span>) {</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    dane <span class="ot">&lt;-</span> dane <span class="sc">|&gt;</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.factor))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (typ_zmiennej <span class="sc">==</span> <span class="st">"numeryczna"</span>) {</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    dane <span class="ot">&lt;-</span> dane <span class="sc">|&gt;</span> </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># nic nie robimy</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(dane)) {</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    kolumna <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dane)[i]</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"barplot"</span>) {</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna), <span class="at">fill =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna))) <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_bar</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">width =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(kolumna) <span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>))</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"pie"</span>) {</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> dane <span class="sc">%&gt;%</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(<span class="sc">!!</span><span class="fu">sym</span>(kolumna)) <span class="sc">%&gt;%</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> n, <span class="at">fill =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna))) <span class="sc">+</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(kolumna) <span class="sc">+</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>))</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"histogram"</span>) {</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna))) <span class="sc">+</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">"#6AAED9"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(kolumna)</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"violin"</span>) {</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna), <span class="at">fill =</span> <span class="st">"#6AAED9"</span>)) <span class="sc">+</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_violin</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(kolumna) <span class="sc">+</span></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>))</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span>  <span class="co"># pomiń jeśli nieznany typ wykresu</span></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>    my_plots[[i]] <span class="ot">&lt;-</span> p</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>gotowy_wykres_1 <span class="ot">&lt;-</span> (my_plots[[<span class="dv">1</span>]] <span class="sc">+</span> my_plots[[<span class="dv">2</span>]]) <span class="sc">/</span> (my_plots[[<span class="dv">3</span>]] <span class="sc">+</span> my_plots[[<span class="dv">4</span>]]) </span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>gotowy_wykres_2 <span class="ot">&lt;-</span> (my_plots[[<span class="dv">5</span>]] <span class="sc">+</span> my_plots[[<span class="dv">6</span>]]) <span class="sc">/</span> (my_plots[[<span class="dv">7</span>]] <span class="sc">+</span> my_plots[[<span class="dv">8</span>]])</span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"images/plots/"</span>, typ_zmiennej, <span class="st">"_"</span>, typ_wykresu, <span class="st">"1.png"</span>), gotowy_wykres_1)</span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"images/plots/"</span>, typ_zmiennej, <span class="st">"_"</span>, typ_wykresu, <span class="st">"2.png"</span>), gotowy_wykres_2)</span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Tak zbudowana funkcja pozwala nam na generowanie wykresów w zależności od:</p>
<ul>
<li><p>Typu zmiennej</p></li>
<li><p>Typu wykresu</p></li>
</ul>
<p>Dzięki temu możemy szybko i prosto uzyskać wiele wizualizacji na temat interesujących nas zmiennych. Zdecydowaliśmy się przedstawić nasze zmienne z podziałem na:</p>
<ol type="1">
<li><p>Zmienne typu kategorycznego, przedstawiając liczebność ogólną oraz względem siebie, za pomocą wykresów <code>barplot</code> oraz <code>pie</code>.</p></li>
<li><p>Zmienne typu numerycznego, przedstawiając gęstośc oraz rozkład zmiennej, za pomocą wykresów <code>violin</code> oraz <code>histogram</code></p></li>
</ol>
<p>Poniżej przedstawiamy efekty naszej pracy, gdzie przeanalizujemy poszczególne zmienne.</p>
</section>
<section id="zmienne-kategoryczne" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="zmienne-kategoryczne"><span class="header-section-number">6.2</span> Zmienne Kategoryczne</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"kategoryczna"</span>, <span class="st">"barplot"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"kategoryczna"</span>, <span class="st">"pie"</span>)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Barplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Pie</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/kategoryczna_barplot1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/kategoryczna_barplot2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/kategoryczna_pie1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/kategoryczna_pie2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p><strong>Po przeanalizowaniu wykresów nasuwają się nastepujące wnioski:</strong></p>
<ul>
<li><p>Analizujemy zbiór ponad 4.000 osób, w którym kobiety lekko przewyższają swoją liczebnością mężczyzn.</p></li>
<li><p>Wraz z poziomem wykształcenia zmniejsza się liczba osób w danej kategorii wykształcenia. Osób bez ukończonej szkoły średniej jest około 1750, stopniowo zmniejszając się do 500 osób z wykształceniem wyższym. Wśród naszych danych przeważają osoby bez wykształcenia lub jedynie z wykształceniem średnim.</p></li>
<li><p>Podział na osoby palące i niepalące jest jednakowy. Obie grupy zawierają około 2.000 osób.</p></li>
<li><p>Grupy osób w których skład wchodzą osoby z cukrzycą, osoby leczące nadciśnienie krwi oraz osoby, które przeżyły udar mózgu są bardzo nieliczne. Ograniczają się maksymalnie do kilkudziesięciu osób. Mimo wszystko osoby te mogą dostarczyć wiele cennych informacji w dalszej analizie ryzyka choroby serca.</p></li>
<li><p>Bazujemy na danych w których stosunek liczby osób, u których nie występowało nadciśnienie do liczby osób u których nadciśnienie występowało jest równe w przybliżeniu 2:1.</p></li>
<li><p>Zmienna predykcyjna <code>TenYearCHD</code> przewiduje potencjalne ryzyko choroby serca dla ponad 500 osób, co stanowi około 12.5% liczby wszystkich badanych. Oznacza to, że średnio co 8 badana osoba jest kwalifikowana w grupie ryzyka.</p></li>
</ul>
</section>
<section id="zmienne-numeryczne" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="zmienne-numeryczne"><span class="header-section-number">6.3</span> Zmienne numeryczne</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"numeryczna"</span>, <span class="st">"violin"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"numeryczna"</span>, <span class="st">"histogram"</span>)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">Violin</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Histogram</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/numeryczna_violin1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/numeryczna_violin2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/numeryczna_histogram1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/numeryczna_histogram2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p><strong>Po przeanalizowaniu wykresów nasuwają się nastepujące wnioski:</strong></p>
<ul>
<li><p>Badamy grupę osób, w której większość osób ma od 35 do 65 lat.</p></li>
<li><p>Ciśnienie rozkurczowe zawiera się głównie w przedziale &lt;70; 90&gt; natomiast ciśnienie skurczowe w przedziale &lt;115; 140&gt;</p></li>
<li><p>Najczęściej badane osoby posiadają tętno serca na poziomie 70-80 uderzeń na minutę.</p></li>
<li><p>Interesujący jest rozkład zmiennej <code>cigsPerDay</code>. Widać znaczący wzrost wystąpień osób palących 20 papierosów dziennie. Dokładnie taka liczba papierosów znajduje się w pojedyńczej paczce. Możemy zatem przyjąć, że dla wielu osób codziennym nawykiem jest wypalenie dokładnie całej paczki w trakcie dnia.</p></li>
<li><p>Zmienne cechują się niesymetrycznym rozkładem, dodatkowo zaburzone są rozkłady dla zmiennej <code>age</code> oraz <code>cigsPerDay</code>.</p></li>
<li><p>Większość zmiennych jest prawostronnie asymetryczna, ciężko mówić o normalności rozkładów ze względu na obecność wartości odstających, które są powszechne wśród danych medycznych.</p></li>
</ul>
</section>
<section id="zależności-pomiędzy-zmiennymi" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="zależności-pomiędzy-zmiennymi"><span class="header-section-number">6.4</span> Zależności pomiędzy zmiennymi</h3>
<p>Wśród naszych zmiennych mogą istnieć zależności liniowe. W celu sprawdzenia tego faktu stworzymy macierz korelacji, aby przedstawić jak wygląda korelacja pomiędzy poszczególnymi zmiennymi. Posłużymy się w tym celu zmiennymi numerycznymi.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>cor_mat <span class="ot">&lt;-</span> badania <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    cor_mat,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab =</span> <span class="cn">TRUE</span>,               </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"lower"</span>,           </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">hc.order =</span> <span class="cn">TRUE</span>,          <span class="co">#</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">outline.col =</span> <span class="st">"white"</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ggtheme =</span> ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>(),</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"white"</span>, <span class="st">"#F25041"</span>) </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Macierz Korelacji"</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/korelacja.jpg"</span>, p)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/korelacja.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Widzimy, że istnieje duża korelacja równa 0.78 pomiędzy zmiennymi <code>sysBP</code> oraz <code>diaBP</code>. Nie powinno nas to specjalnie dziwić, ponieważ wartość ciśnienia rozkurczowego ma bezpośredni wypływ na wartość ciśnienia skurczowego. Dodatkowo poziom BMI a co za tym idzie - nasza waga ma wpływ na wartośc ciśnienia rozkurczowego oraz skurczowego. W oczy może rzucić nam się również wartość korelacji na poziomie -0.19 między zmienną <code>age</code> oraz <code>cigsPerDay</code>, która oznacza, że wraz z wiekiem palimy coraz mniej papierosów dziennie. Nie są to jednak wysokie wartości współczynnika korelacji, więc nie możemy powiedzieć, że pomiędzy tymi zmiennymi istnieje statystycznie istotna korelacja. Możemy jedna informacje traktować jako wskazówki podczas dalszej analizy i zgłębić analizę w kierunku tych zmiennych.</p>
<div class="alert alert-dismissible alert-danger">
<button type="button" class="btn-close" data-bs-dismiss="alert">
</button>
<p><strong>Weryfikacja Hipotezy</strong></p>
<p><span class="math inline">\(H_0\)</span> : Nie istnieje zależność liniowa pomiędzy jakąkolwiek parą zmiennych.</p>
<p><strong>Nie.</strong> Istnieje jedna para zmiennych silnie skorelowanych. Są to zmienne <code>sysBP</code> oraz <code>diaBP</code>. Wartość korelacji dla tych zmiennych wynosi 0.78.</p>
</div>
</section>
<section id="relacja-pomiędzy-diabp-oraz-sysbp" class="level3" data-number="6.5">
<h3 data-number="6.5" class="anchored" data-anchor-id="relacja-pomiędzy-diabp-oraz-sysbp"><span class="header-section-number">6.5</span> Relacja pomiędzy diaBP oraz sysBP</h3>
<p>Sprawdźmy jak będzie wyglądać zestawienie wartości ciśnienia skurczowego od wartości ciśnienia rozkurczowego, dodatkowo dodamy kilka czynników, które dotakowo pokażą zależności pomiędzy większą liczbą zmiennych.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">y =</span> sysBP, <span class="at">color =</span> sex, <span class="at">shape =</span> sex)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"sysBP ~ diaBP"</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysBP_wzgledem_diaBP.jpg"</span>, p1)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/sysBP_wzgledem_diaBP.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Ze względu na dużą liczbę rekordów, punkty zaznaczone na wykresie typu <code>scatter plot</code> tworzą masywną chmurę punktów, utrudniając interpretację. Aby ułatwić analizę na podstawie wykresu posłużymy się wykresami gęstości porównując dodatkowo wpływ innych zmiennych na wartość ciśnienia rozkurczowego oraz skurczowego.</p>
</section>
<section id="ciśnienie-rozkurczowe" class="level3" data-number="6.6">
<h3 data-number="6.6" class="anchored" data-anchor-id="ciśnienie-rozkurczowe"><span class="header-section-number">6.6</span> Ciśnienie rozkurczowe</h3>
<p>Ciśnienie rozkurczowe to <strong>niższa wartość ciśnienia krwi</strong>, mierzona gdy serce <strong>rozluźnia się między uderzeniami</strong> i napełnia krwią. Jego prawidłowa wartość u osób dorosłych wynosi zwykle około <strong>60-80 mmHg.</strong> Ciśnienie rozkurczowe jest istotnym parametrem mówiącym nam w jaki sposób działa serce. Zdarzają się jednak odstępstwa od prawidłowej pracy serca.</p>
<p>Zbyt wysokie ciśnienie może świadczyć o <strong>nadciśnieniu</strong>, natomiast zbyt niskie o <strong>niedociśnieniu.</strong> Sytuacje te są niebezpieczne dla naszego życia i zdrowia, dlatego w takim przypadku pacjent powinien systematycznie się badać oraz przyjmować odpowiednie leki. Zaburzenia pracy serca objawiające się zawyżoną lub zaniżoną wartością ciśnienia mogą być istotną przyczyną zawału serca.</p>
<p>Sprawdźmy jak wygląda rozkład wartości ciśnienia rozkurczowego względem płci.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of diaBP by Sex"</span>) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">color =</span> education)) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of diaBP by Education Level"</span>) <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">color =</span> currentSmoker)) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of diaBP by Smoking"</span>) <span class="sc">+</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/diaBP_bySex.jpg"</span>, p1)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/diaBP_byEducation.jpg"</span>, p2)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/diaBP_byCurrentSmoker.jpg"</span>, p3)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> diaBP, <span class="at">color =</span> education)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/diabp_boxplot.jpg"</span>, p1)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">Względem zmiennej sex</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Względem zmiennej education</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false" href="">Względem zmiennej currentSmoker</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p><img src="images/plots/diaBP_bySex.jpg" class="img-fluid"></p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/diaBP_byEducation.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/diaBP_byCurrentSmoker.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Analogicznie wpływ edukacji możemy przedstawić następująco:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/diabp_boxplot.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Analizując powyższe wykresy dotyczące rozkładu zmiennej <code>diaBP</code> możemy określić następujące wnioski:</p>
<ul>
<li><p>Rozkłady zmiennej ze względu na płeć są do siebie zbliżone. Są one delikatnie prawostronnie asymetryczne, jednocześnie kobiety mają tendencję do przyjmowania lekko niższych wartości podczas badania.</p></li>
<li><p>Podział na poziom wykształcenia mówi nam, że rozkłady są między sobą analogiczne z drobnymi odstępstwami. Dla wartości ciśnienia równych około 70mmHg do 80mmHg czyli wartości najczęstszych, większą gęstość mają grupy wykształcenia 3 oraz 4. Widzimy, że osoby z wyższym wykształceniem minimalnie częściej posiadają niższą wartość ciśnienia.</p></li>
<li><p>Wartość ciśnienia rozkurczowego u osób palących jest niższa niż u osób niepalących, wydaje się to nieintuicyjne. Możemy to tłumaczyć faktem, że osoby palące są często młodsze, co łączy się z średnio niższym ciśnieniem. Aby uzasadnić tą tezę sprawdzimy średni wiek oraz medianę w obu grupach.</p></li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>cisnienie_porownanie <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(currentSmoker) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Liczebnosc =</span> <span class="fu">n</span>(),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Srednia_wieku =</span> <span class="fu">round</span>(<span class="fu">mean</span>(age), <span class="dv">2</span>),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mediana_wieku =</span> <span class="fu">median</span>(age)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>cisnienie_porownanie</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">currentSmoker</th>
<th style="text-align: right;">Liczebnosc</th>
<th style="text-align: right;">Srednia_wieku</th>
<th style="text-align: right;">Mediana_wieku</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">2122</td>
<td style="text-align: right;">51.36</td>
<td style="text-align: right;">52</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">2057</td>
<td style="text-align: right;">47.68</td>
<td style="text-align: right;">46</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="ciśnienie-skurczowe" class="level3" data-number="6.7">
<h3 data-number="6.7" class="anchored" data-anchor-id="ciśnienie-skurczowe"><span class="header-section-number">6.7</span> Ciśnienie skurczowe</h3>
<p>Ciśnienie skurczowe to wyższa wartość ciśnienia krwi, mierzona w momencie skurczu serca, gdy mięsień sercowy kurczy się i wypycha krew do tętnic. Jego prawidłowa wartość u osób dorosłych wynosi zazwyczaj około 100–120 mmHg. Ciśnienie skurczowe jest ważnym wskaźnikiem siły, z jaką serce pompuje krew oraz stanu naczyń krwionośnych. Odchylenia od normy mogą świadczyć o zaburzeniach w pracy układu krążenia.</p>
<p>Zbyt wysokie ciśnienie skurczowe może wskazywać na nadciśnienie tętnicze i prowadzić do uszkodzenia naczyń krwionośnych oraz narządów wewnętrznych, natomiast zbyt niskie może być objawem osłabionej pracy serca lub odwodnienia organizmu. Oba stany są groźne dla zdrowia i życia, dlatego wymagają regularnej kontroli oraz, w razie potrzeby, odpowiedniego leczenia. Nieprawidłowe wartości ciśnienia skurczowego mogą zwiększać ryzyko poważnych powikłań, takich jak zawał serca czy udar mózgu.</p>
<p>Analogicznie postepujemy dla zmiennej <code>sysBP</code>. Pamiętamy że omawiane zmienne są silnie ze sobą skorelowane, więc spodziewamy się podobnych rezultatów.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> sysBP, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of sysBP by Sex"</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> sysBP, <span class="at">color =</span> education)) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of sysBP by Education Level"</span>) <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> sysBP, <span class="at">color =</span> currentSmoker)) <span class="sc">+</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of sysBP by Smoking"</span>) <span class="sc">+</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysBP_bySex.jpg"</span>, p1)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysBP_byEducation.jpg"</span>, p2)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysBP_byCurrentSmoker.jpg"</span>, p3)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> sysBP, <span class="at">color =</span> education)) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysbp_boxplot.jpg"</span>, p1)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">Względem zmiennej sex</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Względem zmiennej education</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false" href="">Względem zmiennej currentSmoker</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/sysBP_bySex.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/sysBP_byEducation.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/sysBP_byCurrentSmoker.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Dla ułatwienia wnioskowania względem poziomu edukacji wykorzystamy <code>boxplot</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/sysbp_boxplot.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Analizując powyższe wykresy dotyczące rozkładu zmiennej <code>sysBP</code> możemy określić następujące wnioski:</p>
<ul>
<li><p>Rozkłady zmiennej ze względu na płeć są do siebie podobne. Są one prawostronnie asymetryczne ze względu na występowanie wartości odstających, które są powszechne w medycynie. Widać, że w większości przypadków to mężczyźni mają lekko wyższy poziom ciśnienia skurczowego.</p></li>
<li><p>Podział na poziom wykształcenia zachowuje się analogicznie do ciśnienia rozkurczowego, osoby z niższym wykształceniem cechują się delikatnie wyższymi wartościami podczas badania ciśnienia</p></li>
<li><p>Ze względu na różnicę wieku w grupie osób palących i niepalących możemy wysnuć podobne wnioski jak wcześniej, dokładniejszą analizę dotyczącą wpływu palenia na ryzyko zawału przeprowadzimy później.</p></li>
</ul>
<p>Sprawdźmy jakie wartości ciśnień cechują osoby ze względu na ryzyko zawału.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>cisnienie_w_grupach <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TenYearCHD) <span class="sc">|&gt;</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Srednia_sysBP =</span> <span class="fu">mean</span>(sysBP),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Srednia_diaBP =</span> <span class="fu">mean</span>(diaBP),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mediana_sysBP =</span> <span class="fu">median</span>(sysBP),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mediana_diaBP =</span> <span class="fu">median</span>(diaBP)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>cisnienie_w_grupach</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">TenYearCHD</th>
<th style="text-align: right;">Srednia_sysBP</th>
<th style="text-align: right;">Srednia_diaBP</th>
<th style="text-align: right;">Mediana_sysBP</th>
<th style="text-align: right;">Mediana_diaBP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">130.3058</td>
<td style="text-align: right;">82.16211</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">81</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">143.6234</td>
<td style="text-align: right;">86.96203</td>
<td style="text-align: right;">139</td>
<td style="text-align: right;">85</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="alert alert-dismissible alert-danger">
<button type="button" class="btn-close" data-bs-dismiss="alert">
</button>
<p><strong>Weryfikacja Hipotezy</strong></p>
<p><span class="math inline">\(H_0\)</span> : Ciśnienie serca jest istotnym czynnikiem powodującym zawał serca.</p>
<p><strong>Tak.</strong> Podwyższone ciśnienie skurczowe i rozkurczowe przez dłuższy okres negatywnie wpływają na pracę układu sercowo-naczyniowego oraz zwiększają ryzyko wystapienia choroby wieńcowej.</p>
</div>
</section>
<section id="zakres-pracy-serca-a-ryzyko-zawału" class="level3" data-number="6.8">
<h3 data-number="6.8" class="anchored" data-anchor-id="zakres-pracy-serca-a-ryzyko-zawału"><span class="header-section-number">6.8</span> Zakres pracy serca, a ryzyko zawału</h3>
<p>Zakres pracy serca, określany jako różnica pomiędzy ciśnieniem skurczowym (sysBP) a rozkurczowym (diaBP), nazywany jest również <strong>ciśnieniem tętna</strong>. Wartość ta odzwierciedla elastyczność naczyń krwionośnych oraz siłę, z jaką serce wypompowuje krew do układu krążenia. U osób dorosłych prawidłowy zakres pracy serca wynosi zazwyczaj około <strong>30–50 mmHg</strong>.</p>
<p>Zbyt wysoki zakres pracy serca może świadczyć o sztywności naczyń krwionośnych, nadciśnieniu tętniczym lub zwiększonym obciążeniu serca, natomiast zbyt niski może wskazywać na osłabioną kurczliwość mięśnia sercowego, niewydolność serca lub znaczne obniżenie ciśnienia krwi. Oba te stany są niekorzystne dla zdrowia i mogą prowadzić do poważnych powikłań. Nieprawidłowa różnica pomiędzy ciśnieniem skurczowym a rozkurczowym zwiększa ryzyko chorób sercowo-naczyniowych, w tym zawału serca, dlatego regularna kontrola parametrów ciśnienia krwi jest niezwykle istotna.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">range_diff =</span> sysBP <span class="sc">-</span> diaBP) <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(range_diff) <span class="sc">|&gt;</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> range_diff, <span class="at">color =</span> TenYearCHD)) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pulse pressure distribution"</span>, <span class="at">x =</span> <span class="st">"sysBP - diaBP"</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">range_diff =</span> sysBP <span class="sc">-</span> diaBP) <span class="sc">|&gt;</span> </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(range_diff) <span class="sc">|&gt;</span> </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> range_diff, <span class="at">color =</span> prevalentHyp)) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pulse pressure distribution"</span>, <span class="at">x =</span> <span class="st">"sysBP - diaBP"</span>)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">range_diff =</span> sysBP <span class="sc">-</span> diaBP) <span class="sc">|&gt;</span> </span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(range_diff) <span class="sc">|&gt;</span> </span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> range_diff, <span class="at">color =</span> diabetes)) <span class="sc">+</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pulse pressure distribution"</span>, <span class="at">x =</span> <span class="st">"sysBP - diaBP"</span>)</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/pulse_pressure_1.jpg"</span>, p1)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/pulse_pressure_2.jpg"</span>, p2)</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/pulse_pressure_3.jpg"</span>, p3)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">Względem zmiennej TenYearCHD</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">Względem zmiennej prevalentHyp</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false" href="">Względem zmiennej diabetes</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/pulse_pressure_1.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/pulse_pressure_2.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/pulse_pressure_3.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Wpływ pracy zakresu serca możemy przedstawić również następująco:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>zakres_pracy_serca <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TenYearCHD) <span class="sc">|&gt;</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sredni_zakres =</span> <span class="fu">mean</span>(sysBP <span class="sc">-</span> diaBP),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mediana_zakres =</span> <span class="fu">median</span>(sysBP <span class="sc">-</span> diaBP)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>zakres_pracy_serca</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">TenYearCHD</th>
<th style="text-align: right;">Sredni_zakres</th>
<th style="text-align: right;">Mediana_zakres</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">No</td>
<td style="text-align: right;">48.14364</td>
<td style="text-align: right;">46</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">56.66139</td>
<td style="text-align: right;">53</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sysBP <span class="sc">-</span> diaBP)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"#6AAED9"</span>) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Value of sysBP - diaBP by TenYearCHD"</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> sysBP <span class="sc">-</span> diaBP, <span class="at">color =</span> TenYearCHD)) <span class="sc">+</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span> </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Value of sysBP - diaBP by TenYearCHD"</span>)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/zakres_pracy_serca_histogram.png"</span>, p1)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/zakres_pracy_serca_boxplot.png"</span>, p2)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">Histogram</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">Boxplot</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/zakres_pracy_serca_histogram.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/zakres_pracy_serca_boxplot.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Analizując powyższe wykresy oraz tabele możemy wywnioskować, że osoby w grupie ryzyka zawału serca mają średnio wyższe ciśnienie tętna od osób zdrowych. Wysoki zakres pracy serca działa niekorzystnie w dużym okresie czasu i przyczynia się do osłabienia serca i całego układu krwionośnego. Duża liczba badanych osób posiada ciśnienite tętna wyższe od 50 mmHg, co jest umownie granicznym poziomem prawidłowego zakresu pracy serca. Dodatkowo choroby takie jak nadciśnienie tętnicze oraz cukrzyca negatywnie wpływają na serce oraz zwiększają zakres jego pracy, co dodatkowo je wysila.</p>
</section>
<section id="ciśnienie-serca-jako-przyczyna-zawału-serca" class="level3" data-number="6.9">
<h3 data-number="6.9" class="anchored" data-anchor-id="ciśnienie-serca-jako-przyczyna-zawału-serca"><span class="header-section-number">6.9</span> Ciśnienie serca jako przyczyna zawału serca</h3>
<section id="z-uzględnieniem-płci" class="level4">
<h4 class="anchored" data-anchor-id="z-uzględnieniem-płci">Z uzględnieniem płci</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> sysBP, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Value of sysBP by Sex"</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> diaBP, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Value of diaBP by Sex"</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/cisnienie_wzlgedem_ryzyka_bySex_1.png"</span>, p1)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/cisnienie_wzlgedem_ryzyka_bySex_2.png"</span>, p2)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">Ciśnienie skurczowe</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href="">Ciśnienie rozkurczowe</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/cisnienie_wzlgedem_ryzyka_bySex_1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/cisnienie_wzlgedem_ryzyka_bySex_2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Widzimy, że osoby w grupie ryzyka cechują się średnio wyższymi wartościami mierzonego ciśnienia. Możemy przez to rozumieć, że wyższy poziom ciśnienia wiąże się w pośrednio większym ryzykiem wystąpienia choroby wieńcowej. Rozkłady tych wartości ze względu na płeć badanych osób są do siebie podobne, z delikatną przewagą średniej mężczyzn dla ciśnienia rozkurczowego.</p>
</section>
<section id="z-uwzględnieniem-nadciśnienia" class="level4">
<h4 class="anchored" data-anchor-id="z-uwzględnieniem-nadciśnienia">Z uwzględnieniem nadciśnienia</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> sysBP, <span class="at">color =</span> prevalentHyp)) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span> </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Value of sysBP by the fact of prevalent Hypothesis"</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> diaBP, <span class="at">color =</span> prevalentHyp)) <span class="sc">+</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Value of diaBP by the fact of prevalent Hypothesis"</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/cisnienie_wzlgedem_ryzyka_byprevHyp_1.png"</span>, p1)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/cisnienie_wzlgedem_ryzyka_byprevHyp_2.png"</span>, p2)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href="">Ciśnienie skurczowe</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href="">Ciśnienie rozkurczowe</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/cisnienie_wzlgedem_ryzyka_byprevHyp_1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/cisnienie_wzlgedem_ryzyka_byprevHyp_2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Biorąc pod uwagę fakt wystepowania nadciśnienia tętniczego widzimy, że ma on istotny wpływ w ocenie ryzka choroby. Jednocześnie wartości ciśnienia skurczowego jak i rozkurczowego są znacząco wyższe wśród osób z przewlekłym nadciśnieniem tętniczy. Widać, że pierwszy kwartyl osób <code>prevalentHyp</code> = <code>Yes</code>, zawsze jest ponad trzecim kwartylem osób <code>prevalenHyp</code> = <code>No</code>.</p>
</section>
<section id="rozkład-wartości-ciśnienia" class="level4">
<h4 class="anchored" data-anchor-id="rozkład-wartości-ciśnienia">Rozkład wartości ciśnienia</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sysBP, <span class="at">color =</span> TenYearCHD)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of sysBP including risk of disease"</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">color =</span> TenYearCHD)) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of diaBP including risk of disease"</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/rozklad_cisnienia_1.png"</span>, p1)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/rozklad_cisnienia_2.png"</span>, p2)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href="">Ciśnienie skurczowe</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false" href="">Ciśnienie rozkurczowe</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/rozklad_cisnienia_1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/rozklad_cisnienia_2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p>W obu przypadkach widzimy przewagę grupy objętej ryzykiem wsród wyższych wartości odpowiednich ciśnień. Potwierdza to nasze dotychczasowe wnioski, że wartości badanego ciśnienia wpływają bezpośrednio na pracę układu sercowo-naczyniowego oraz są jedną z głównych przyczyn wystąpienia zawału serca.</p>
</section>
</section>
<section id="analiza-wartości-tętna" class="level3" data-number="6.10">
<h3 data-number="6.10" class="anchored" data-anchor-id="analiza-wartości-tętna"><span class="header-section-number">6.10</span> Analiza wartości tętna</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>bins <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(badania<span class="sc">$</span>heartRate), <span class="fu">max</span>(badania<span class="sc">$</span>heartRate), <span class="at">length.out =</span> <span class="dv">16</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>hist_data <span class="ot">&lt;-</span> badania <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bin =</span> <span class="fu">cut</span>(heartRate, <span class="at">breaks =</span> bins, <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(TenYearCHD, bin) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count_adj =</span> <span class="fu">ifelse</span>(TenYearCHD <span class="sc">==</span> <span class="st">"No"</span>, n, <span class="sc">-</span>n))</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> hist_data <span class="sc">|&gt;</span> </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bin, <span class="at">y =</span> count_adj, <span class="at">fill =</span> TenYearCHD)) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Liczebność w grupie"</span>, <span class="at">x =</span> <span class="st">"Przedziały"</span>) <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>))</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/poziom_tetna.png"</span>, p)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/poziom_tetna.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<section id="rozkład-zmiennej" class="level4">
<h4 class="anchored" data-anchor-id="rozkład-zmiennej">Rozkład zmiennej</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> heartRate)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"#6AAED9"</span>, <span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> dnorm,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(badania<span class="sc">$</span>heartRate), <span class="at">sd =</span> <span class="fu">sd</span>(badania<span class="sc">$</span>heartRate)),</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">1.2</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"#F25041"</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>()</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/rozklad_tetna_gestosc.png"</span>, p)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/rozklad_tetna_gestosc.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="poziom-tętna-ze-względu-na-inne-zmienne" class="level4">
<h4 class="anchored" data-anchor-id="poziom-tętna-ze-względu-na-inne-zmienne">Poziom tętna ze względu na inne zmienne</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> heartRate, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"heartRate ~ TenYearCHD"</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> heartRate, <span class="at">color =</span> currentSmoker)) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"heartRate ~ TenYearCHD"</span>)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> heartRate, <span class="at">color =</span> BPMeds)) <span class="sc">+</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"heartRate ~ TenYearCHD"</span>)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/heartRate_bySex.png"</span>, p1)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/heartRate_bycurrentSmoker.png"</span>, p2)</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/heartRate_byBPMeds.png"</span>, p3)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true" href="">sex</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false" href="">currentSmoker</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false" href="">BPMeds</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/heartRate_bySex.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/heartRate_bycurrentSmoker.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/heartRate_byBPMeds.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="leki-na-nadciśnienie-i-ich-skutek" class="level3" data-number="6.11">
<h3 data-number="6.11" class="anchored" data-anchor-id="leki-na-nadciśnienie-i-ich-skutek"><span class="header-section-number">6.11</span> Leki na nadciśnienie i ich skutek</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sysBP, <span class="at">color =</span> BPMeds)) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>))</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">color =</span> BPMeds)) <span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>))</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/leki_nadcisnienie_rozklad1.png"</span>, p1)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/leki_nadcisnienie_rozklad2.png"</span>, p2)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true" href="">Ciśnienie skurczowe</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false" href="">Ciśnienie rozkurczowe</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/leki_nadcisnienie_rozklad1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/leki_nadcisnienie_rozklad2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="alert alert-dismissible alert-danger">
<button type="button" class="btn-close" data-bs-dismiss="alert">
</button>
<p><strong>Weryfikacja Hipotezy</strong></p>
<p><span class="math inline">\(H_0\)</span> : Leki na nadciśnienie zmniejszają ryzyko choroby wieńcowej.</p>
<p><strong>Tak.</strong> Osoby z podwyższonym ciśnieniem posiadają większe ryzyko choroby wieńcowej, niż osoby z prawidłowym ciśnieniem, ponieważ ciśnienie jest jednym z głównych predyktorów zawału serca w medycynie. Osoby stosujące leki w celu obniżenia ciśnienia serca w dużej mierze ciągle mają wyższe wyniki niż osoby zdrowe, lecz przyczyniają się tym do zmniejszenia ryzyka zawału serca.</p>
</div>
</section>
<section id="skutki-palenia-na-układ-krążenia" class="level3" data-number="6.12">
<h3 data-number="6.12" class="anchored" data-anchor-id="skutki-palenia-na-układ-krążenia"><span class="header-section-number">6.12</span> Skutki palenia na układ krążenia</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>osoby_palace <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(currentSmoker <span class="sc">==</span> <span class="st">"Yes"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>osoby_niepalace <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(cigsPerDay <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">osoby_palace =</span> <span class="fu">nrow</span>(osoby_palace),</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">osoby_niepalace =</span> <span class="fu">nrow</span>(osoby_niepalace),</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="st">"Liczba osób"</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>           )</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">osoby_palace</th>
<th style="text-align: right;">osoby_niepalace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Liczba osób</td>
<td style="text-align: right;">2057</td>
<td style="text-align: right;">2122</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="podział-pacjentów-ze-względu-na-palenie" class="level4">
<h4 class="anchored" data-anchor-id="podział-pacjentów-ze-względu-na-palenie">Podział pacjentów ze względu na palenie</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> currentSmoker, <span class="at">fill =</span> currentSmoker)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>), <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Smokers vs No Smokers"</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> currentSmoker, <span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">color =</span> <span class="st">"black"</span>,  <span class="at">width =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Smoking including sex"</span>)</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> currentSmoker, <span class="at">fill =</span> TenYearCHD)) <span class="sc">+</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">color =</span> <span class="st">"black"</span>,  <span class="at">width =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Smoking including potential risk of disease"</span>)</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/number_of_smokers.png"</span>, p1)</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/number_of_smokers_bySex.png"</span>, p2)</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/number_of_smokers_byTenYearCHD.png"</span>, p3)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true" href="">Distribution by Smoking Status</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false" href="">Number of Smokers by sex</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false" href="">Number of smokers including disease risk</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/number_of_smokers.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/number_of_smokers_bySex.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/number_of_smokers_byTenYearCHD.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="nawyki-palenia-papierosów" class="level4">
<h4 class="anchored" data-anchor-id="nawyki-palenia-papierosów">Nawyki palenia papierosów</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> cigsPerDay)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#6AAED9"</span>) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>()</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> osoby_palace <span class="sc">|&gt;</span> </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> cigsPerDay)) <span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#6AAED9"</span>) <span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>()</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/cigsPerDay1.png"</span>, p1)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/cigsPerDay2.png"</span>, p2)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true" href="">Uwzględniając wszystkich pacjentów</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false" href="">Uwzględnając tylko osoby palące</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/cigsPerDay1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/cigsPerDay2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="wpływ-poziomu-palenia-na-ryzyko-choroby" class="level4">
<h4 class="anchored" data-anchor-id="wpływ-poziomu-palenia-na-ryzyko-choroby">Wpływ poziomu palenia na ryzyko choroby</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>paczki <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cigsPerDay, TenYearCHD) <span class="sc">|&gt;</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cigsPerDay) <span class="sc">|&gt;</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> paczki[<span class="dv">1</span><span class="sc">:</span><span class="dv">28</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cigsPerDay), <span class="at">y =</span> n, <span class="at">fill =</span> <span class="fu">factor</span>(TenYearCHD))) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Cigarettes per Day"</span>,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Liczba osób"</span>,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"TenYearCHD"</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Impact of smoking for potential risk"</span>)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> paczki[<span class="dv">3</span><span class="sc">:</span><span class="dv">28</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cigsPerDay), <span class="at">y =</span> n, <span class="at">fill =</span> <span class="fu">factor</span>(TenYearCHD))) <span class="sc">+</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Cigarettes per Day"</span>,</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Liczba osób"</span>,</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"TenYearCHD"</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Impact of smoking for potential risk"</span>)</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> paczki[<span class="dv">29</span><span class="sc">:</span><span class="fu">nrow</span>(paczki), ] <span class="sc">|&gt;</span> </span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cigsPerDay), <span class="at">y =</span> n, <span class="at">fill =</span> <span class="fu">factor</span>(TenYearCHD))) <span class="sc">+</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Cigarettes per Day"</span>,</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Liczba osób"</span>,</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"TenYearCHD"</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Impact of smoking for potential risk"</span>)</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/impact_of_smoking_all.png"</span>, p1)</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/impact_of_smoking_part1.png"</span>, p2)</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/impact_of_smoking_part2.png"</span>, p3)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true" href="">Uwzględniając osoby niepalące</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false" href="">Osoby palące do 15 papierosów dziennie</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false" href="">Osoby palące powyżej 15 papierosów dziennie</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/impact_of_smoking_all.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/impact_of_smoking_part1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/impact_of_smoking_part2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>paczki_procenty <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cigsPerDay) <span class="sc">|&gt;</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cigsSum =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(cigsSum <span class="sc">&gt;</span> <span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cigsPerDay, TenYearCHD) <span class="sc">|&gt;</span> </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cigsPerDay) <span class="sc">|&gt;</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> paczki_procenty <span class="sc">|&gt;</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cigsPerDay),</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> perc,</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="fu">factor</span>(TenYearCHD)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Cigarettes per Day"</span>,</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Procent"</span>,</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Ten-Year CHD"</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Fraction of risk group"</span>)</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/fraction.png"</span>, p1)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/fraction.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="alert alert-dismissible alert-danger">
<button type="button" class="btn-close" data-bs-dismiss="alert">
</button>
<p><strong>Weryfikacja Hipotezy</strong></p>
<p><span class="math inline">\(H_0\)</span> : Palenie zwiększa ryzyko zawału serca.</p>
<p><strong>Tak.</strong>Palenie wpływa negatywnie na układ sercowo-naczyniowy, podnosi ciśnienie serca oraz działa toksycznie na ludzki organizm. Wraz z liczbą palonych papierosów oraz okresem palenia zwiększa się ryzyko wystąpienia m.in. choroby wieńcowej.</p>
</div>
</section>
</section>
<section id="relacja-pomiędzy-zmienną-age-a-zmienną-cigsperday" class="level3" data-number="6.13">
<h3 data-number="6.13" class="anchored" data-anchor-id="relacja-pomiędzy-zmienną-age-a-zmienną-cigsperday"><span class="header-section-number">6.13</span> Relacja pomiędzy zmienną <code>age</code>, a zmienną <code>cigsPerDay</code></h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> age, <span class="at">color =</span> currentSmoker)) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">lwd =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of age"</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">color =</span> currentSmoker)) <span class="sc">+</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span> </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of age"</span>)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/smoking_byAge_1.png"</span>, p1)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/smoking_byAge_2.png"</span>, p2)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true" href="">Boxplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false" href="">Density</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/smoking_byAge_1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/smoking_byAge_2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>paczki_mean <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cigsPerDay) <span class="sc">|&gt;</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cigsSum =</span> <span class="fu">n</span>(),</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sysBP_mean =</span> <span class="fu">mean</span>(sysBP),</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">diaBP_mean =</span> <span class="fu">mean</span>(diaBP)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(cigsSum <span class="sc">&gt;</span> <span class="dv">50</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> paczki_mean <span class="sc">|&gt;</span> </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> cigsPerDay)) <span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> diaBP_mean), <span class="at">lwd =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">"#6AAED9"</span>) <span class="sc">+</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> sysBP_mean), <span class="at">lwd =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">"#F2A391"</span>) <span class="sc">+</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Mean values of sysBP and diaBP including smoking"</span>)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/mean_BP.png"</span>, p)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/mean_BP.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a> p <span class="ot">&lt;-</span> <span class="fu">ggVennDiagram</span>(<span class="fu">list</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Udar =</span> <span class="fu">which</span>(badania<span class="sc">$</span>prevalentStroke <span class="sc">==</span> <span class="st">"Yes"</span>),</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Nadcisnienie =</span> <span class="fu">which</span>(badania<span class="sc">$</span>prevalentHyp <span class="sc">==</span> <span class="st">"Yes"</span>),</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ryzyko =</span> <span class="fu">which</span>(badania<span class="sc">$</span>TenYearCHD<span class="sc">==</span> <span class="st">"Yes"</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>), <span class="at">set_size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"#6AAED9"</span>, <span class="at">high =</span> <span class="st">"#F2A391"</span>) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Concatenation of dangerous diseases"</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/concatenation.png"</span>, p)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/plots/concatenation.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="model-regresji-logistycznej" class="level3" data-number="6.14">
<h3 data-number="6.14" class="anchored" data-anchor-id="model-regresji-logistycznej"><span class="header-section-number">6.14</span> Model regresji logistycznej</h3>
<p>::DO PRZENIESIENIA !!!::</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(badania)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   4179 obs. of  17 variables:
 $ age            : int  39 43 60 39 63 51 41 41 61 45 ...
 $ sex            : Factor w/ 2 levels "Female","Male": 1 1 1 1 1 2 1 2 2 2 ...
 $ education      : Ord.factor w/ 4 levels "1"&lt;"2"&lt;"3"&lt;"4": 2 1 1 2 4 3 1 1 1 1 ...
 $ sysBP          : num  114 124 110 115 164 ...
 $ diaBP          : num  64 77.5 72.5 75 76 92.5 98 70 80 75 ...
 $ heartRate      : int  85 70 65 90 70 70 90 70 48 77 ...
 $ BMI            : num  22.4 29.9 26.6 22.5 29.4 ...
 $ totChol        : int  226 185 260 209 248 214 265 239 239 191 ...
 $ glucose        : int  86 122 82 86 80 83 76 70 64 77 ...
 $ diabetes       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ cigsPerDay     : int  9 0 0 20 0 0 0 40 0 43 ...
 $ currentSmoker  : Factor w/ 2 levels "No","Yes": 2 1 1 2 1 1 1 2 1 2 ...
 $ BPMeds         : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ prevalentStroke: Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ prevalentHyp   : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 2 1 1 2 ...
 $ TenYearCHD     : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ ID             : int  1 2 3 4 5 6 7 8 9 10 ...</code></pre>
</div>
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(TenYearCHD <span class="sc">~</span> age <span class="sc">+</span> sex <span class="sc">+</span> education <span class="sc">+</span> sysBP <span class="sc">+</span> diaBP <span class="sc">+</span> heartRate <span class="sc">+</span> BMI <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                     totChol <span class="sc">+</span> glucose <span class="sc">+</span> diabetes <span class="sc">+</span> cigsPerDay <span class="sc">+</span> currentSmoker <span class="sc">+</span> BPMeds <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                     prevalentStroke <span class="sc">+</span> prevalentHyp,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> badania,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_model)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TenYearCHD ~ age + sex + education + sysBP + diaBP + 
    heartRate + BMI + totChol + glucose + diabetes + cigsPerDay + 
    currentSmoker + BPMeds + prevalentStroke + prevalentHyp, 
    family = binomial(link = "logit"), data = badania)

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        -8.391550   0.658101 -12.751  &lt; 2e-16 ***
age                 0.063331   0.006384   9.919  &lt; 2e-16 ***
sexMale             0.486744   0.102701   4.739 2.14e-06 ***
education.L         0.031826   0.108381   0.294 0.769026    
education.Q         0.187070   0.108838   1.719 0.085652 .  
education.C        -0.081832   0.108016  -0.758 0.448698    
sysBP               0.014181   0.003590   3.950 7.80e-05 ***
diaBP              -0.002648   0.006067  -0.436 0.662573    
heartRate          -0.001267   0.003919  -0.323 0.746557    
BMI                 0.004445   0.011946   0.372 0.709820    
totChol             0.001977   0.001033   1.914 0.055589 .  
glucose             0.007495   0.002105   3.561 0.000369 ***
diabetesYes         0.011013   0.304486   0.036 0.971149    
cigsPerDay          0.021069   0.005786   3.641 0.000271 ***
currentSmokerYes    0.044019   0.146289   0.301 0.763488    
BPMedsYes           0.196862   0.225515   0.873 0.382695    
prevalentStrokeYes  0.976699   0.446291   2.188 0.028635 *  
prevalentHypYes     0.215914   0.129877   1.662 0.096422 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 3550.8  on 4178  degrees of freedom
Residual deviance: 3136.1  on 4161  degrees of freedom
AIC: 3172.1

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(logit_model))</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       (Intercept)                age            sexMale        education.L 
      0.0002267756       1.0653790772       1.6270108321       1.0323380439 
       education.Q        education.C              sysBP              diaBP 
      1.2057113611       0.9214267686       1.0142820912       0.9973558706 
         heartRate                BMI            totChol            glucose 
      0.9987341278       1.0044550231       1.0019793166       1.0075233771 
       diabetesYes         cigsPerDay   currentSmokerYes          BPMedsYes 
      1.0110733954       1.0212922856       1.0450019837       1.2175755164 
prevalentStrokeYes    prevalentHypYes 
      2.6556753010       1.2409959521 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>step_model <span class="ot">&lt;-</span> <span class="fu">step</span>(logit_model, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=3172.13
TenYearCHD ~ age + sex + education + sysBP + diaBP + heartRate + 
    BMI + totChol + glucose + diabetes + cigsPerDay + currentSmoker + 
    BPMeds + prevalentStroke + prevalentHyp

                  Df Deviance    AIC
- diabetes         1   3136.1 3170.1
- currentSmoker    1   3136.2 3170.2
- heartRate        1   3136.2 3170.2
- BMI              1   3136.3 3170.3
- diaBP            1   3136.3 3170.3
- BPMeds           1   3136.9 3170.9
- education        3   3141.2 3171.2
&lt;none&gt;                 3136.1 3172.1
- prevalentHyp     1   3138.9 3172.9
- totChol          1   3139.8 3173.8
- prevalentStroke  1   3140.7 3174.7
- cigsPerDay       1   3149.2 3183.2
- glucose          1   3149.3 3183.3
- sysBP            1   3151.7 3185.7
- sex              1   3158.7 3192.7
- age              1   3237.7 3271.7

Step:  AIC=3170.13
TenYearCHD ~ age + sex + education + sysBP + diaBP + heartRate + 
    BMI + totChol + glucose + cigsPerDay + currentSmoker + BPMeds + 
    prevalentStroke + prevalentHyp

                  Df Deviance    AIC
- currentSmoker    1   3136.2 3168.2
- heartRate        1   3136.2 3168.2
- BMI              1   3136.3 3168.3
- diaBP            1   3136.3 3168.3
- BPMeds           1   3136.9 3168.9
- education        3   3141.2 3169.2
&lt;none&gt;                 3136.1 3170.1
- prevalentHyp     1   3138.9 3170.9
- totChol          1   3139.8 3171.8
+ diabetes         1   3136.1 3172.1
- prevalentStroke  1   3140.7 3172.7
- cigsPerDay       1   3149.2 3181.2
- sysBP            1   3151.7 3183.7
- glucose          1   3158.6 3190.6
- sex              1   3158.7 3190.7
- age              1   3237.8 3269.8

Step:  AIC=3168.22
TenYearCHD ~ age + sex + education + sysBP + diaBP + heartRate + 
    BMI + totChol + glucose + cigsPerDay + BPMeds + prevalentStroke + 
    prevalentHyp

                  Df Deviance    AIC
- heartRate        1   3136.3 3166.3
- BMI              1   3136.3 3166.3
- diaBP            1   3136.4 3166.4
- BPMeds           1   3137.0 3167.0
- education        3   3141.3 3167.3
&lt;none&gt;                 3136.2 3168.2
- prevalentHyp     1   3139.0 3169.0
- totChol          1   3139.8 3169.8
+ currentSmoker    1   3136.1 3170.1
+ diabetes         1   3136.2 3170.2
- prevalentStroke  1   3140.8 3170.8
- sysBP            1   3151.8 3181.8
- glucose          1   3158.7 3188.7
- sex              1   3158.7 3188.7
- cigsPerDay       1   3167.4 3197.4
- age              1   3237.9 3267.9

Step:  AIC=3166.32
TenYearCHD ~ age + sex + education + sysBP + diaBP + BMI + totChol + 
    glucose + cigsPerDay + BPMeds + prevalentStroke + prevalentHyp

                  Df Deviance    AIC
- BMI              1   3136.4 3164.4
- diaBP            1   3136.5 3164.5
- BPMeds           1   3137.1 3165.1
- education        3   3141.4 3165.4
&lt;none&gt;                 3136.3 3166.3
- prevalentHyp     1   3139.0 3167.0
- totChol          1   3139.9 3167.9
+ heartRate        1   3136.2 3168.2
+ currentSmoker    1   3136.2 3168.2
+ diabetes         1   3136.3 3168.3
- prevalentStroke  1   3141.0 3169.0
- sysBP            1   3151.8 3179.8
- glucose          1   3158.7 3186.7
- sex              1   3159.5 3187.5
- cigsPerDay       1   3167.5 3195.5
- age              1   3239.1 3267.1

Step:  AIC=3164.44
TenYearCHD ~ age + sex + education + sysBP + diaBP + totChol + 
    glucose + cigsPerDay + BPMeds + prevalentStroke + prevalentHyp

                  Df Deviance    AIC
- diaBP            1   3136.6 3162.6
- BPMeds           1   3137.2 3163.2
- education        3   3141.7 3163.7
&lt;none&gt;                 3136.4 3164.4
- prevalentHyp     1   3139.2 3165.2
- totChol          1   3140.0 3166.0
+ BMI              1   3136.3 3166.3
+ heartRate        1   3136.3 3166.3
+ currentSmoker    1   3136.4 3166.4
+ diabetes         1   3136.4 3166.4
- prevalentStroke  1   3141.1 3167.1
- sysBP            1   3151.9 3177.9
- glucose          1   3159.0 3185.0
- sex              1   3159.8 3185.8
- cigsPerDay       1   3167.5 3193.5
- age              1   3239.1 3265.1

Step:  AIC=3162.6
TenYearCHD ~ age + sex + education + sysBP + totChol + glucose + 
    cigsPerDay + BPMeds + prevalentStroke + prevalentHyp

                  Df Deviance    AIC
- BPMeds           1   3137.4 3161.4
- education        3   3141.9 3161.9
&lt;none&gt;                 3136.6 3162.6
- prevalentHyp     1   3139.3 3163.3
- totChol          1   3140.2 3164.2
+ diaBP            1   3136.4 3164.4
+ heartRate        1   3136.5 3164.5
+ currentSmoker    1   3136.5 3164.5
+ BMI              1   3136.5 3164.5
+ diabetes         1   3136.6 3164.6
- prevalentStroke  1   3141.3 3165.3
- glucose          1   3159.5 3183.5
- sex              1   3159.8 3183.8
- sysBP            1   3159.9 3183.9
- cigsPerDay       1   3167.9 3191.9
- age              1   3246.4 3270.4

Step:  AIC=3161.4
TenYearCHD ~ age + sex + education + sysBP + totChol + glucose + 
    cigsPerDay + prevalentStroke + prevalentHyp

                  Df Deviance    AIC
- education        3   3142.6 3160.6
&lt;none&gt;                 3137.4 3161.4
- prevalentHyp     1   3140.3 3162.3
+ BPMeds           1   3136.6 3162.6
- totChol          1   3141.1 3163.1
+ diaBP            1   3137.2 3163.2
+ heartRate        1   3137.3 3163.3
+ BMI              1   3137.3 3163.3
+ currentSmoker    1   3137.3 3163.3
+ diabetes         1   3137.4 3163.4
- prevalentStroke  1   3142.5 3164.5
- sex              1   3160.3 3182.3
- glucose          1   3160.4 3182.4
- sysBP            1   3162.2 3184.2
- cigsPerDay       1   3168.7 3190.7
- age              1   3247.4 3269.4

Step:  AIC=3160.65
TenYearCHD ~ age + sex + sysBP + totChol + glucose + cigsPerDay + 
    prevalentStroke + prevalentHyp

                  Df Deviance    AIC
&lt;none&gt;                 3142.6 3160.6
+ education        3   3137.4 3161.4
- prevalentHyp     1   3145.6 3161.6
+ BPMeds           1   3141.9 3161.9
- totChol          1   3146.0 3162.0
+ BMI              1   3142.4 3162.4
+ heartRate        1   3142.5 3162.5
+ diaBP            1   3142.5 3162.5
+ currentSmoker    1   3142.6 3162.6
+ diabetes         1   3142.6 3162.6
- prevalentStroke  1   3147.8 3163.8
- glucose          1   3165.5 3181.5
- sysBP            1   3167.6 3183.6
- sex              1   3169.0 3185.0
- cigsPerDay       1   3173.2 3189.2
- age              1   3266.6 3282.6</code></pre>
</div>
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(step_model)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = TenYearCHD ~ age + sex + sysBP + totChol + glucose + 
    cigsPerDay + prevalentStroke + prevalentHyp, family = binomial(link = "logit"), 
    data = badania)

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        -8.623738   0.488971 -17.636  &lt; 2e-16 ***
age                 0.066249   0.006067  10.920  &lt; 2e-16 ***
sexMale             0.510682   0.099716   5.121 3.03e-07 ***
sysBP               0.013506   0.002701   5.000 5.74e-07 ***
totChol             0.001898   0.001026   1.850   0.0644 .  
glucose             0.007549   0.001576   4.789 1.67e-06 ***
cigsPerDay          0.021824   0.003904   5.590 2.28e-08 ***
prevalentStrokeYes  1.022303   0.439270   2.327   0.0200 *  
prevalentHypYes     0.218618   0.126938   1.722   0.0850 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 3550.8  on 4178  degrees of freedom
Residual deviance: 3142.6  on 4170  degrees of freedom
AIC: 3160.6

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>badania<span class="sc">$</span>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>badania<span class="sc">$</span>pred_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(badania<span class="sc">$</span>pred_prob <span class="sc">&gt;</span> <span class="fl">0.2</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>badania<span class="sc">$</span>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(badania<span class="sc">$</span>pred_class, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>))</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(badania<span class="sc">$</span>TenYearCHD, badania<span class="sc">$</span>pred_prob)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dane_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc_obj)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.7379</code></pre>
</div>
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(logit_model)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    GVIF Df GVIF^(1/(2*Df))
age             1.329892  1        1.153210
sex             1.256529  1        1.120950
education       1.117057  3        1.018621
sysBP           3.590601  1        1.894888
diaBP           2.819458  1        1.679124
heartRate       1.099415  1        1.048530
BMI             1.204830  1        1.097647
totChol         1.066084  1        1.032513
glucose         1.807564  1        1.344457
diabetes        1.806143  1        1.343928
cigsPerDay      2.705619  1        1.644877
currentSmoker   2.551898  1        1.597466
BPMeds          1.104040  1        1.050733
prevalentStroke 1.024017  1        1.011937
prevalentHyp    1.995309  1        1.412554</code></pre>
</div>
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="at">Predicted =</span> badania<span class="sc">$</span>pred_class, <span class="at">Actual =</span> badania<span class="sc">$</span>TenYearCHD)</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         Actual
Predicted   No  Yes
      No  2824  299
      Yes  723  333</code></pre>
</div>
<details open="" class="code-fold">
<summary>Pokaż/Ukryj Kod</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">mean</span>(badania<span class="sc">$</span>pred_class <span class="sc">==</span> badania<span class="sc">$</span>TenYearCHD)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>accuracy</span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7554439</code></pre>
</div>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/article/picture_2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="margin-top: 25px;"></p>
</figure>
</div>
</div>


<!-- -->

</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Powrót do góry</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Skopiowano!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Skopiowano!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./plan.html" class="pagination-link" aria-label="<i class=&quot;bi bi-dot&quot;></i>Plan Projektu <i class=&quot;bi bi-box-seam&quot;></i>">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><i class="bi bi-dot"></i>Plan Projektu <i class="bi bi-box-seam"></i></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./modele.html" class="pagination-link" aria-label="<i class=&quot;bi bi-dot&quot;></i>Modele <i class=&quot;bi bi-cpu&quot;></i>">
        <span class="nav-page-text"><i class="bi bi-dot"></i>Modele <i class="bi bi-cpu"></i></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Kod źródłowy</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb70" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Wczesne Wykrywanie Ryzyka Zawału Serca"</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Zapoznanie I Praca Z Danymi"</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="an">warning:</span><span class="co"> false</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="an">output:</span><span class="co"> </span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf_document:</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co">    includes:</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co">      in_header: polish_language.sty</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rozpoczęcie</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>W tej części projektu skupimy się na pracy z naszymi danymi. Zapoznamy się z ich strukturą oraz właściwościami. Poznamy podstawowe statystyki wyjaśniające dokładnie każdą ze zmiennych. Pozwoli nam to na wysnucie pewnych przypuszczeń, które postaramy się zbadać i wyjaśnić za pomocą analizy i wizualizacji. Dodatkowo przeprowadzimy odpowiednie testy statystyczne, aby dokładniej określić właściwości naszych zmiennych, m. in. różnicę wartości średniej w grupach oraz istotność zmiennych. Postaramy się odpowiedzień na wcześniej postawione hipotezy i poszerzyć odpowiedź o informacje zdobyte podczas analizy. Po przeprowadzeniu wszystkich etapów związanych z pracą nad danymi przejdziemy do tworzenia modeli predykcyjnych i obliczaniu ich statystyk. Podczas projektu użyliśmy następujących bibliotek.</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Biblioteki</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tinythemes)</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VennDiagram)</span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggVennDiagram)</span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zapoznanie z Danymi</span></span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a>Wczytanie pliku z rozszerzeniem <span class="in">`csv`</span> do zmiennej o nazwie <span class="in">`data`</span>.</span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-48"><a href="#cb70-48" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">"data/badania.csv"</span>, <span class="at">sep=</span><span class="st">","</span>)</span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-50"><a href="#cb70-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-51"><a href="#cb70-51" aria-hidden="true" tabindex="-1"></a>Sprawdźmy jak wyglądają nasze dane. Użyjemy do tego funkcji <span class="in">`head()`</span> oraz <span class="in">`tail()`</span> do podglądu kilku pierwszych i ostatnich obserwacji w naszym zbiorze danych. Pierwsze 10 obserwacji ma postać:</span>
<span id="cb70-52"><a href="#cb70-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-55"><a href="#cb70-55" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-56"><a href="#cb70-56" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span>
<span id="cb70-57"><a href="#cb70-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-58"><a href="#cb70-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-59"><a href="#cb70-59" aria-hidden="true" tabindex="-1"></a>Natomiast kilka ostatnich obserwcji nad którymi bedziemy pracować mają postać:</span>
<span id="cb70-60"><a href="#cb70-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-63"><a href="#cb70-63" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-64"><a href="#cb70-64" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(data)</span>
<span id="cb70-65"><a href="#cb70-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-66"><a href="#cb70-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-67"><a href="#cb70-67" aria-hidden="true" tabindex="-1"></a>Spradźmy rozmiary naszej ramki danych. W tym celu posłużymy się funkcjami <span class="in">`nrow()`</span> oraz <span class="in">`ncol()`</span>, które zawracają odpowiednio **liczbę wierszy** oraz **liczbę kolumn**.</span>
<span id="cb70-68"><a href="#cb70-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-71"><a href="#cb70-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-72"><a href="#cb70-72" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(data)</span>
<span id="cb70-73"><a href="#cb70-73" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(data)</span>
<span id="cb70-74"><a href="#cb70-74" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-75"><a href="#cb70-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-76"><a href="#cb70-76" aria-hidden="true" tabindex="-1"></a>Widzimy że mamy ponad 4200 obserwacji i 16 zmiennych, które posłużą nam do stworzenia kilku modeli predykcyjnych i wyboru tego, który najlepiej będzie oceniał ryzyko zawału serca. Jest to naprawdę duży zasób danych, które mogą odpowiedzieć na wiele interesujących pytań. Nadszedł czas sprawdzić zmienne, które posiadamy. Użyjemy do tego funkcji <span class="in">`colnames().`</span></span>
<span id="cb70-77"><a href="#cb70-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-80"><a href="#cb70-80" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-81"><a href="#cb70-81" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data)</span>
<span id="cb70-82"><a href="#cb70-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-83"><a href="#cb70-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-84"><a href="#cb70-84" aria-hidden="true" tabindex="-1"></a>Okazuje się, że nasz zbiór zawiera cenne informacje medyczne takie jak:</span>
<span id="cb70-85"><a href="#cb70-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-86"><a href="#cb70-86" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Tętno</span>
<span id="cb70-87"><a href="#cb70-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-88"><a href="#cb70-88" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>BMI</span>
<span id="cb70-89"><a href="#cb70-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-90"><a href="#cb70-90" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Ciśnienie skurczowe i rozkurczowe</span>
<span id="cb70-91"><a href="#cb70-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-92"><a href="#cb70-92" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Poziom cholesterolu i glukozy</span>
<span id="cb70-93"><a href="#cb70-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-94"><a href="#cb70-94" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Informacje o tym, czy pacjent był palaczem, czy też nie</span>
<span id="cb70-95"><a href="#cb70-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-96"><a href="#cb70-96" aria-hidden="true" tabindex="-1"></a>Dokładniej przyjrzymy się naszym zmiennym w dalszej części analizy zbioru danych. Wyjaśnimy dokładniej cechy poszczególnych kolumn zbioru danych oraz ich podstawowe statystyki. Czas sprawdzić podstawowe statystki dotyczące danych oraz to z jakimi typami danych będziemy pracować.</span>
<span id="cb70-97"><a href="#cb70-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-100"><a href="#cb70-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-101"><a href="#cb70-101" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(data)</span>
<span id="cb70-102"><a href="#cb70-102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-103"><a href="#cb70-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-104"><a href="#cb70-104" aria-hidden="true" tabindex="-1"></a>Tak jak widać na powyższym raporcie, zaczytując dane otrzymujemy 3 zmienne typu <span class="in">`character`</span> oraz 13 zmiennych typu <span class="in">`numeric`</span>. Taki podział ze względu na typ zmiennych nie jest odpowiedni. Wszystkie cechy typu <span class="in">`character`</span> mają w naszym przypadku błędne formatowanie. Dodatkowo będziemy musieli dodać nowe typy zmiennych takie jak <span class="in">`boolean`</span> oraz <span class="in">`factor`</span>, aby móc szybko i praktycznie pracować z danymi. Odpowiedni wybór typów zmiennych jest podstawowym krokiem rozpczynając analizę zbioru danych. Zrobimy to w następujący sposób.</span>
<span id="cb70-105"><a href="#cb70-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-108"><a href="#cb70-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-109"><a href="#cb70-109" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb70-110"><a href="#cb70-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb70-111"><a href="#cb70-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">sysBP =</span> <span class="fu">as.numeric</span>(sysBP),</span>
<span id="cb70-112"><a href="#cb70-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">diaBP =</span> <span class="fu">as.numeric</span>(diaBP),</span>
<span id="cb70-113"><a href="#cb70-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">BMI =</span> <span class="fu">as.numeric</span>(BMI),</span>
<span id="cb70-114"><a href="#cb70-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">factor</span>(male, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>)),</span>
<span id="cb70-115"><a href="#cb70-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">education =</span> <span class="fu">factor</span>(education, <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb70-116"><a href="#cb70-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">currentSmoker =</span> <span class="fu">factor</span>(currentSmoker, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb70-117"><a href="#cb70-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">BPMeds =</span> <span class="fu">factor</span>(BPMeds, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb70-118"><a href="#cb70-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">prevalentStroke =</span> <span class="fu">factor</span>(prevalentStroke, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb70-119"><a href="#cb70-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">prevalentHyp =</span> <span class="fu">factor</span>(prevalentHyp, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb70-120"><a href="#cb70-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">diabetes =</span> <span class="fu">factor</span>(diabetes, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>)),</span>
<span id="cb70-121"><a href="#cb70-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">TenYearCHD =</span> <span class="fu">factor</span>(TenYearCHD, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>))</span>
<span id="cb70-122"><a href="#cb70-122" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>male)   </span>
<span id="cb70-123"><a href="#cb70-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-124"><a href="#cb70-124" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> badania[<span class="fu">order</span>(<span class="fu">is.na</span>(badania<span class="sc">$</span>glucose), <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb70-125"><a href="#cb70-125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-126"><a href="#cb70-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-127"><a href="#cb70-127" aria-hidden="true" tabindex="-1"></a>W tym momencie wszystkie zmienne mają przypisane odpowiednie typy danych, co pozwoli zaoszczędzić czas podczas przeprowadzania obliczeń i analizy nad nimi. Dla wygody uporządkujemy teraz kolumny w odpowiedniej dla nas kolejności, tak aby informacje powiązane ze sobą były obok siebie (Np. zmienna <span class="in">`glucose`</span> obok zmiennej <span class="in">`diabetes`</span>)</span>
<span id="cb70-128"><a href="#cb70-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-131"><a href="#cb70-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-132"><a href="#cb70-132" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(badania, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>, <span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">12</span>, <span class="dv">9</span>, <span class="dv">14</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">15</span>))</span>
<span id="cb70-133"><a href="#cb70-133" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(badania)</span>
<span id="cb70-134"><a href="#cb70-134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-135"><a href="#cb70-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-136"><a href="#cb70-136" aria-hidden="true" tabindex="-1"></a>Zrobione. Teraz możemy przejść do wyjaśnienia zmiennych, aby było jasne z czym pracujemy oraz na czym możemy polegać podczas wykonywania analizy.</span>
<span id="cb70-137"><a href="#cb70-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-138"><a href="#cb70-138" aria-hidden="true" tabindex="-1"></a><span class="fu">## Opis i wyjaśnienie zmiennych</span></span>
<span id="cb70-139"><a href="#cb70-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-140"><a href="#cb70-140" aria-hidden="true" tabindex="-1"></a>Poniżej znajduje się tabela zawierająca wszystkie cechy wraz z ich wytłumaczeniem.</span>
<span id="cb70-141"><a href="#cb70-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-142"><a href="#cb70-142" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-143"><a href="#cb70-143" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Zmienna           <span class="pp">|</span> Opis                                                                 <span class="pp">|</span> Jednostka                                                    <span class="pp">|</span> Typ         <span class="pp">|</span></span>
<span id="cb70-144"><a href="#cb70-144" aria-hidden="true" tabindex="-1"></a>+:===============<span class="al">==:+:====================================================================:+:============================================================:+:==</span>=========:+</span>
<span id="cb70-145"><a href="#cb70-145" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`age`</span>             <span class="pp">|</span> Wiek (w latach)                                                      <span class="pp">|</span> Lata                                                         <span class="pp">|</span> <span class="in">`int`</span>       <span class="pp">|</span></span>
<span id="cb70-146"><a href="#cb70-146" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-147"><a href="#cb70-147" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`sex`</span>             <span class="pp">|</span> Płeć (1 - Mężczyzna, 0 - Kobieta)                                    <span class="pp">|</span> Brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb70-148"><a href="#cb70-148" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-149"><a href="#cb70-149" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`education`</span>       <span class="pp">|</span> Wykształcenie                                                        <span class="pp">|</span> Brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb70-150"><a href="#cb70-150" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span>                                                                      <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb70-151"><a href="#cb70-151" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> (1 - Brak ukończonej szkoły średniej,                                <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb70-152"><a href="#cb70-152" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span>                                                                      <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb70-153"><a href="#cb70-153" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> 2 - Ukończona szkoła średnia,                                        <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb70-154"><a href="#cb70-154" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span>                                                                      <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb70-155"><a href="#cb70-155" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> 3 - Nieukończone studia lub ukończona szkoła zawodowa,               <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb70-156"><a href="#cb70-156" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span>                                                                      <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb70-157"><a href="#cb70-157" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> 4 - Wykształcenie Wyższe)                                            <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb70-158"><a href="#cb70-158" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-159"><a href="#cb70-159" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`sysBP`</span>           <span class="pp">|</span> Wartość ciśnienia skurczowego (Średnia ostatnich dwóch pomiarów)     <span class="pp">|</span> mmHg                                                         <span class="pp">|</span> <span class="in">`numerical`</span> <span class="pp">|</span></span>
<span id="cb70-160"><a href="#cb70-160" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-161"><a href="#cb70-161" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`diaBP`</span>           <span class="pp">|</span> Wartość ciśnienia rozkurczowego (Średnia ostatnich dwóch pomiarów)   <span class="pp">|</span> mmHg                                                         <span class="pp">|</span> <span class="in">`numerical`</span> <span class="pp">|</span></span>
<span id="cb70-162"><a href="#cb70-162" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-163"><a href="#cb70-163" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`heartRate`</span>       <span class="pp">|</span> Poziom tętna ()                                                      <span class="pp">|</span> Uderzeń na minutę                                            <span class="pp">|</span> <span class="in">`int`</span>       <span class="pp">|</span></span>
<span id="cb70-164"><a href="#cb70-164" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-165"><a href="#cb70-165" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`BMI`</span>             <span class="pp">|</span> Wartość współczynnika BMI                                            <span class="pp">|</span> $\displaystyle \frac{\text{masa (kg)}}{\text{wzrost (m)}^2}$ <span class="pp">|</span> <span class="in">`float`</span>     <span class="pp">|</span></span>
<span id="cb70-166"><a href="#cb70-166" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-167"><a href="#cb70-167" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`totalChol`</span>       <span class="pp">|</span> Wartość poziomu cholesterolu ()                                      <span class="pp">|</span> $\displaystyle \frac{\text{mg}}{\text{dL}}$                  <span class="pp">|</span> <span class="in">`int`</span>       <span class="pp">|</span></span>
<span id="cb70-168"><a href="#cb70-168" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-169"><a href="#cb70-169" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`glucose`</span>         <span class="pp">|</span> Poziom glukozy we krwi ()                                            <span class="pp">|</span> $\displaystyle \frac{\text{mg}}{\text{dL}}$                  <span class="pp">|</span> <span class="in">`int`</span>       <span class="pp">|</span></span>
<span id="cb70-170"><a href="#cb70-170" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-171"><a href="#cb70-171" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`diabetes`</span>        <span class="pp">|</span> Fakt czy pacjent jest cukrzykiem\                                    <span class="pp">|</span> brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb70-172"><a href="#cb70-172" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> (1 - Tak, 0 - Nie)                                                   <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb70-173"><a href="#cb70-173" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-174"><a href="#cb70-174" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`cigsPerDay`</span>      <span class="pp">|</span> Średnia liczba palonych dziennie papierosów                          <span class="pp">|</span> sztuki                                                       <span class="pp">|</span> <span class="in">`int`</span>       <span class="pp">|</span></span>
<span id="cb70-175"><a href="#cb70-175" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-176"><a href="#cb70-176" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`currentSmoker`</span>   <span class="pp">|</span> Fakt czy pacjent jest palaczem\                                      <span class="pp">|</span> brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb70-177"><a href="#cb70-177" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> (1- Tak, 0 - Nie)                                                    <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb70-178"><a href="#cb70-178" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-179"><a href="#cb70-179" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`BMPmeds`</span>         <span class="pp">|</span> Fakt czy pacjent leczy się na nadciśnienie krwi (1 - Tak, 0 - Nie)   <span class="pp">|</span> brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb70-180"><a href="#cb70-180" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-181"><a href="#cb70-181" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`prevalentStroke`</span> <span class="pp">|</span> Wskazuje czy pacjent przeżył udar mózgu. (1 - Tak, 0 - Nie)          <span class="pp">|</span> brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb70-182"><a href="#cb70-182" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-183"><a href="#cb70-183" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`prevalentHyp`</span>    <span class="pp">|</span> Wskazuje czy u pacjenta występowało nadciśnienie.\                   <span class="pp">|</span> brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb70-184"><a href="#cb70-184" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> (1 - Tak, 0 - Nie)                                                   <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb70-185"><a href="#cb70-185" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-186"><a href="#cb70-186" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`TenYearCHD`</span>      <span class="pp">|</span> Wskazuje 10-letnie ryzyko wystąpienia choroby wieńcowej u pacjenta.\ <span class="pp">|</span> brak                                                         <span class="pp">|</span> <span class="in">`factor`</span>    <span class="pp">|</span></span>
<span id="cb70-187"><a href="#cb70-187" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>                   <span class="pp">|</span> (1- Tak, 0-Nie)                                                      <span class="pp">|</span>                                                              <span class="pp">|</span>             <span class="pp">|</span></span>
<span id="cb70-188"><a href="#cb70-188" aria-hidden="true" tabindex="-1"></a>+-------------------+----------------------------------------------------------------------+--------------------------------------------------------------+-------------+</span>
<span id="cb70-189"><a href="#cb70-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-190"><a href="#cb70-190" aria-hidden="true" tabindex="-1"></a><span class="fu">## Uzupełnienie brakujących wartości</span></span>
<span id="cb70-191"><a href="#cb70-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-192"><a href="#cb70-192" aria-hidden="true" tabindex="-1"></a>Zastanówmy się co zrobić z brakami danych w naszym zbiorze badań. Przedstawmy ilość wartości <span class="in">`NA`</span> dla każdej zmiennej, w której takie wartości wystepują.</span>
<span id="cb70-193"><a href="#cb70-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-196"><a href="#cb70-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-197"><a href="#cb70-197" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: NA_columns</span></span>
<span id="cb70-198"><a href="#cb70-198" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-199"><a href="#cb70-199" aria-hidden="true" tabindex="-1"></a>NA_count <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(badania))[<span class="fu">colSums</span>(<span class="fu">is.na</span>(badania)) <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="sc">|&gt;</span> </span>
<span id="cb70-200"><a href="#cb70-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb70-201"><a href="#cb70-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-202"><a href="#cb70-202" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(NA_count) <span class="ot">&lt;-</span> <span class="st">"count"</span></span>
<span id="cb70-203"><a href="#cb70-203" aria-hidden="true" tabindex="-1"></a>NA_count<span class="sc">$</span>var <span class="ot">=</span> <span class="fu">rownames</span>(NA_count)</span>
<span id="cb70-204"><a href="#cb70-204" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(NA_count) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb70-205"><a href="#cb70-205" aria-hidden="true" tabindex="-1"></a>NA_count <span class="ot">&lt;-</span> <span class="fu">select</span>(NA_count, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb70-206"><a href="#cb70-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-207"><a href="#cb70-207" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(NA_count, <span class="fu">aes</span>(<span class="at">x =</span> var, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb70-208"><a href="#cb70-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">"#6AAED9"</span>) <span class="sc">+</span></span>
<span id="cb70-209"><a href="#cb70-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-210"><a href="#cb70-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> count), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb70-211"><a href="#cb70-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">max</span>(NA_count<span class="sc">$</span>count) <span class="sc">*</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb70-212"><a href="#cb70-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Liczba wartości NA w zmiennych"</span>)</span>
<span id="cb70-213"><a href="#cb70-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-214"><a href="#cb70-214" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/na_count_before.png"</span>, p)</span>
<span id="cb70-215"><a href="#cb70-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-216"><a href="#cb70-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-217"><a href="#cb70-217" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/na_count_before.png)</span>{fig-align="center"}</span>
<span id="cb70-218"><a href="#cb70-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-219"><a href="#cb70-219" aria-hidden="true" tabindex="-1"></a>Widzimy, że mamy kilka zmiennych, które zawierają braki danych. Liczby wartośći <span class="in">`NA`</span> w poszczególnych kolumnach są zazwyczaj mniejsze lub równe około 100, jedynym wyjątkiem z aż 388 wartościami <span class="in">`NA`</span> jest zmienna <span class="in">`glucose`</span> oznaczająca poziom glukozy we krwi pacjenta. Zanim uzupełnimy braki danych odpowiednią techniką spróbujemy dowiedzieć się w jaki sposób rozkładają się wartości <span class="in">`NA`</span> tzn. czy braki te wystepują u różnych pacjentów, czy też jeden pacjent posiada brak informacji w więcej niż tylko jednej zmiennej.</span>
<span id="cb70-220"><a href="#cb70-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-223"><a href="#cb70-223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-224"><a href="#cb70-224" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: NA_rows</span></span>
<span id="cb70-225"><a href="#cb70-225" aria-hidden="true" tabindex="-1"></a>NA_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">NA_w_wierszu =</span> <span class="fu">rowSums</span>(<span class="fu">is.na</span>(badania))) <span class="sc">|&gt;</span> </span>
<span id="cb70-226"><a href="#cb70-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(NA_w_wierszu) <span class="sc">|&gt;</span> </span>
<span id="cb70-227"><a href="#cb70-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">liczebnosc =</span> <span class="fu">n</span>())</span>
<span id="cb70-228"><a href="#cb70-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-229"><a href="#cb70-229" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> NA_df <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(NA_w_wierszu, liczebnosc)) <span class="sc">+</span></span>
<span id="cb70-230"><a href="#cb70-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">"#6AAED9"</span>) <span class="sc">+</span></span>
<span id="cb70-231"><a href="#cb70-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-232"><a href="#cb70-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> liczebnosc), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb70-233"><a href="#cb70-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">max</span>(NA_df<span class="sc">$</span>liczebnosc) <span class="sc">*</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb70-234"><a href="#cb70-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Liczba wartości NA w rekordach"</span>)</span>
<span id="cb70-235"><a href="#cb70-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-236"><a href="#cb70-236" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/NA_count_perRow.png"</span>, p)</span>
<span id="cb70-237"><a href="#cb70-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-238"><a href="#cb70-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-239"><a href="#cb70-239" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/NA_count_perRow.png)</span>{fig-align="center"}</span>
<span id="cb70-240"><a href="#cb70-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-241"><a href="#cb70-241" aria-hidden="true" tabindex="-1"></a>Do uzupełniania wartości brakujących przyjeliśmy następującą metodykę:</span>
<span id="cb70-242"><a href="#cb70-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-243"><a href="#cb70-243" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Rekordy posiadające dokładnie jedną wartość <span class="in">`NA`</span> uzupełnimy na podstawie metody wielokrotnej imputacji</span>
<span id="cb70-244"><a href="#cb70-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-245"><a href="#cb70-245" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Rekordy posiadające więcej niż jedną wartość <span class="in">`NA`</span> odrzucamy, aby nie bazować na znacznie brakujących danych</span>
<span id="cb70-246"><a href="#cb70-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-247"><a href="#cb70-247" aria-hidden="true" tabindex="-1"></a>W zmiennej <span class="in">`badania`</span> wybieramy te wiersze, w których znajduje się co najwyżej jedna wartość <span class="in">`NA`</span>.</span>
<span id="cb70-248"><a href="#cb70-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-251"><a href="#cb70-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-252"><a href="#cb70-252" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> badania[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(badania)) <span class="sc">&lt;=</span> <span class="dv">1</span>, ]</span>
<span id="cb70-253"><a href="#cb70-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-254"><a href="#cb70-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-257"><a href="#cb70-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-258"><a href="#cb70-258" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-259"><a href="#cb70-259" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb70-260"><a href="#cb70-260" aria-hidden="true" tabindex="-1"></a>NA_count <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(badania))[<span class="fu">colSums</span>(<span class="fu">is.na</span>(badania)) <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="sc">|&gt;</span> </span>
<span id="cb70-261"><a href="#cb70-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb70-262"><a href="#cb70-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-263"><a href="#cb70-263" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(NA_count) <span class="ot">&lt;-</span> <span class="st">"count"</span></span>
<span id="cb70-264"><a href="#cb70-264" aria-hidden="true" tabindex="-1"></a>NA_count<span class="sc">$</span>var <span class="ot">=</span> <span class="fu">rownames</span>(NA_count)</span>
<span id="cb70-265"><a href="#cb70-265" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(NA_count) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb70-266"><a href="#cb70-266" aria-hidden="true" tabindex="-1"></a>NA_count <span class="ot">&lt;-</span> <span class="fu">select</span>(NA_count, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb70-267"><a href="#cb70-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-268"><a href="#cb70-268" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(NA_count, <span class="fu">aes</span>(<span class="at">x =</span> var, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb70-269"><a href="#cb70-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">"#6AAED9"</span>) <span class="sc">+</span></span>
<span id="cb70-270"><a href="#cb70-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-271"><a href="#cb70-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> count), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb70-272"><a href="#cb70-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">max</span>(NA_count<span class="sc">$</span>count) <span class="sc">*</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb70-273"><a href="#cb70-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Liczba wartości NA w zmiennych"</span>)</span>
<span id="cb70-274"><a href="#cb70-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-275"><a href="#cb70-275" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/na_count_after.png"</span>, p)</span>
<span id="cb70-276"><a href="#cb70-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-277"><a href="#cb70-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-278"><a href="#cb70-278" aria-hidden="true" tabindex="-1"></a>Wizualizacja liczby brakujących danych ma postać:</span>
<span id="cb70-279"><a href="#cb70-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-280"><a href="#cb70-280" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-281"><a href="#cb70-281" aria-hidden="true" tabindex="-1"></a><span class="fu">### Po wczytaniu danych</span></span>
<span id="cb70-282"><a href="#cb70-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-283"><a href="#cb70-283" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/na_count_before.png)</span>{fig-align="center"}</span>
<span id="cb70-284"><a href="#cb70-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-285"><a href="#cb70-285" aria-hidden="true" tabindex="-1"></a><span class="fu">### Po wstępnym usunięciu danych</span></span>
<span id="cb70-286"><a href="#cb70-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-287"><a href="#cb70-287" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/na_count_after.png)</span>{fig-align="center"}</span>
<span id="cb70-288"><a href="#cb70-288" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-289"><a href="#cb70-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-290"><a href="#cb70-290" aria-hidden="true" tabindex="-1"></a>W tym momencie przeprowadzimy proces uzupełniania zmiennych przy pomocy funkcji <span class="in">`mice`</span> - metodą wielokrotnej imputacji. Braki danych znajdują się w kolumnach o różnych typach zmiennych.</span>
<span id="cb70-291"><a href="#cb70-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-292"><a href="#cb70-292" aria-hidden="true" tabindex="-1"></a>**Zmienne kategoryczne:**</span>
<span id="cb70-293"><a href="#cb70-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-294"><a href="#cb70-294" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`BPMeds`</span></span>
<span id="cb70-295"><a href="#cb70-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-296"><a href="#cb70-296" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`education`</span></span>
<span id="cb70-297"><a href="#cb70-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-298"><a href="#cb70-298" aria-hidden="true" tabindex="-1"></a>**Zmienne numeryczne:**</span>
<span id="cb70-299"><a href="#cb70-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-300"><a href="#cb70-300" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`BMI`</span></span>
<span id="cb70-301"><a href="#cb70-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-302"><a href="#cb70-302" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`cigsPerDay`</span></span>
<span id="cb70-303"><a href="#cb70-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-304"><a href="#cb70-304" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`glucose`</span></span>
<span id="cb70-305"><a href="#cb70-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-306"><a href="#cb70-306" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`heartRate`</span></span>
<span id="cb70-307"><a href="#cb70-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-308"><a href="#cb70-308" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`totChol`</span></span>
<span id="cb70-309"><a href="#cb70-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-310"><a href="#cb70-310" aria-hidden="true" tabindex="-1"></a>Ze względu na typy zmiennych oraz rozkłady, jakimi te zmienne się charakteryzują decydujemy się użyć metodę <span class="in">`pmm`</span> (Predictive Mean Matching) dla zmiennych numerycznych oraz metodę <span class="in">`logreg`</span> dla <span class="in">`BPMeds`</span> oraz <span class="in">`polr`</span> dla <span class="in">`education`</span>.</span>
<span id="cb70-311"><a href="#cb70-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-312"><a href="#cb70-312" aria-hidden="true" tabindex="-1"></a>**Uzasadnienie:** <span class="in">`pmm`</span> zachowuje rozkłady i wybiera realne obserwacje jako wartości wejściowe, co jest szczególnie ważne przy zmiennych o rozkładzie ciągłym. Dla zmiennych kategorycznych używamy odpowiednich regresji klasyfikacyjnych w zależności od cech zmiennej.</span>
<span id="cb70-313"><a href="#cb70-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-316"><a href="#cb70-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-317"><a href="#cb70-317" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb70-318"><a href="#cb70-318" aria-hidden="true" tabindex="-1"></a>statystyki_przed <span class="ot">&lt;-</span> <span class="fu">describe</span>(badania[NA_count<span class="sc">$</span>var])</span>
<span id="cb70-319"><a href="#cb70-319" aria-hidden="true" tabindex="-1"></a>metody <span class="ot">&lt;-</span> <span class="fu">make.method</span>(badania)</span>
<span id="cb70-320"><a href="#cb70-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-321"><a href="#cb70-321" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"BPMeds"</span>] <span class="ot">&lt;-</span> <span class="st">"logreg"</span>        <span class="co">#</span></span>
<span id="cb70-322"><a href="#cb70-322" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"education"</span>] <span class="ot">&lt;-</span> <span class="st">"polr"</span> </span>
<span id="cb70-323"><a href="#cb70-323" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"BMI"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb70-324"><a href="#cb70-324" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"cigsPerDay"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb70-325"><a href="#cb70-325" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"glucose"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb70-326"><a href="#cb70-326" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"heartRate"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb70-327"><a href="#cb70-327" aria-hidden="true" tabindex="-1"></a>metody[<span class="st">"totChol"</span>] <span class="ot">&lt;-</span> <span class="st">"pmm"</span></span>
<span id="cb70-328"><a href="#cb70-328" aria-hidden="true" tabindex="-1"></a>uzupelnienia <span class="ot">&lt;-</span> <span class="fu">mice</span>(badania,</span>
<span id="cb70-329"><a href="#cb70-329" aria-hidden="true" tabindex="-1"></a>                <span class="at">m =</span> <span class="dv">5</span>,</span>
<span id="cb70-330"><a href="#cb70-330" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> metody,</span>
<span id="cb70-331"><a href="#cb70-331" aria-hidden="true" tabindex="-1"></a>                <span class="at">seed =</span> <span class="dv">2025</span>)</span>
<span id="cb70-332"><a href="#cb70-332" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> <span class="fu">complete</span>(uzupelnienia)</span>
<span id="cb70-333"><a href="#cb70-333" aria-hidden="true" tabindex="-1"></a>statystyki_po <span class="ot">&lt;-</span> <span class="fu">describe</span>(badania[NA_count<span class="sc">$</span>var])</span>
<span id="cb70-334"><a href="#cb70-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-335"><a href="#cb70-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-336"><a href="#cb70-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-337"><a href="#cb70-337" aria-hidden="true" tabindex="-1"></a>Po uzupełnieniu brakujących wartości porównajmy statystyki dla naszych zmiennych.</span>
<span id="cb70-338"><a href="#cb70-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-339"><a href="#cb70-339" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-340"><a href="#cb70-340" aria-hidden="true" tabindex="-1"></a><span class="fu">### Przed uzupełnieniem danych</span></span>
<span id="cb70-341"><a href="#cb70-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-344"><a href="#cb70-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-345"><a href="#cb70-345" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(statystyki_przed))[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>), ], <span class="dv">3</span>)</span>
<span id="cb70-346"><a href="#cb70-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-347"><a href="#cb70-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-348"><a href="#cb70-348" aria-hidden="true" tabindex="-1"></a><span class="fu">### Po uzupełnieniu danych</span></span>
<span id="cb70-349"><a href="#cb70-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-352"><a href="#cb70-352" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-353"><a href="#cb70-353" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">data.frame</span>(<span class="fu">t</span>(statystyki_po))[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>), ], <span class="dv">3</span>)</span>
<span id="cb70-354"><a href="#cb70-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-355"><a href="#cb70-355" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-356"><a href="#cb70-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-357"><a href="#cb70-357" aria-hidden="true" tabindex="-1"></a>Sprawdzając podstawowe statystki widzimy, że uzupełniając dane zachowaliśmy ich strukturę. Różnica pomiędzy wartościami statystyk polega najczęściej na zmianie części tysięcznych lub setnych, więc wartości <span class="in">`NA`</span> zostały bardzo dobrze odwzorowane. Teraz możemy wykonać analizę wstępną naszego zbioru danych, aby następnie przejść do stworzenia modeli predykcyjnych oraz głębszej analizy. Ostatnim punktem pracy nad modyfikowaniem naszych danych jest zapisanie oszyszczonych i uzupełnionych danych do pliku <span class="in">`.csv`</span>, który wykorzystamy m. in. podczas tworzenia modeli w języku programowania <span class="in">`R`</span> lub <span class="in">`python.`</span></span>
<span id="cb70-358"><a href="#cb70-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-361"><a href="#cb70-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-362"><a href="#cb70-362" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(badania, <span class="at">file =</span> <span class="st">"data/badania_clean.csv"</span>)</span>
<span id="cb70-363"><a href="#cb70-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-364"><a href="#cb70-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-365"><a href="#cb70-365" aria-hidden="true" tabindex="-1"></a><span class="fu">## Analiza Danych</span></span>
<span id="cb70-366"><a href="#cb70-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-367"><a href="#cb70-367" aria-hidden="true" tabindex="-1"></a>W trakcie wykonywynia wizualizacji bedziemy posługiwać się pacjentami, których traktujemy jako tych, którzy nie są w grupie zagrożenia oraz tych, którzy w tej grupie są. Dla ułatwienia przeprowadzania operacji stworzymy dwie ramki danych <span class="in">`zdrowi`</span> oraz <span class="in">`chorzy`</span> aby odwoływać się do tych grup bezpośrednio.</span>
<span id="cb70-368"><a href="#cb70-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-371"><a href="#cb70-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-372"><a href="#cb70-372" aria-hidden="true" tabindex="-1"></a>badania <span class="ot">&lt;-</span> <span class="fu">mutate</span>(badania, <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(badania))</span>
<span id="cb70-373"><a href="#cb70-373" aria-hidden="true" tabindex="-1"></a>zdrowi <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-374"><a href="#cb70-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(TenYearCHD <span class="sc">==</span> <span class="st">"No"</span>)</span>
<span id="cb70-375"><a href="#cb70-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-376"><a href="#cb70-376" aria-hidden="true" tabindex="-1"></a>chorzy <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-377"><a href="#cb70-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(TenYearCHD <span class="sc">==</span> <span class="st">"Yes"</span>)</span>
<span id="cb70-378"><a href="#cb70-378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-379"><a href="#cb70-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-380"><a href="#cb70-380" aria-hidden="true" tabindex="-1"></a><span class="fu">### Funkcja Tworzenia Wykresów</span></span>
<span id="cb70-381"><a href="#cb70-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-384"><a href="#cb70-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-385"><a href="#cb70-385" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-386"><a href="#cb70-386" aria-hidden="true" tabindex="-1"></a>zmienna_wykres <span class="ot">&lt;-</span> <span class="cf">function</span>(dane, typ_zmiennej, typ_wykresu) {</span>
<span id="cb70-387"><a href="#cb70-387" aria-hidden="true" tabindex="-1"></a>  my_plots <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb70-388"><a href="#cb70-388" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (typ_zmiennej <span class="sc">==</span> <span class="st">"kategoryczna"</span>) {</span>
<span id="cb70-389"><a href="#cb70-389" aria-hidden="true" tabindex="-1"></a>    dane <span class="ot">&lt;-</span> dane <span class="sc">|&gt;</span> </span>
<span id="cb70-390"><a href="#cb70-390" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.factor))</span>
<span id="cb70-391"><a href="#cb70-391" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (typ_zmiennej <span class="sc">==</span> <span class="st">"numeryczna"</span>) {</span>
<span id="cb70-392"><a href="#cb70-392" aria-hidden="true" tabindex="-1"></a>    dane <span class="ot">&lt;-</span> dane <span class="sc">|&gt;</span> </span>
<span id="cb70-393"><a href="#cb70-393" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span>
<span id="cb70-394"><a href="#cb70-394" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb70-395"><a href="#cb70-395" aria-hidden="true" tabindex="-1"></a>    <span class="co"># nic nie robimy</span></span>
<span id="cb70-396"><a href="#cb70-396" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-397"><a href="#cb70-397" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-398"><a href="#cb70-398" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(dane)) {</span>
<span id="cb70-399"><a href="#cb70-399" aria-hidden="true" tabindex="-1"></a>    kolumna <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dane)[i]</span>
<span id="cb70-400"><a href="#cb70-400" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"barplot"</span>) {</span>
<span id="cb70-401"><a href="#cb70-401" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna), <span class="at">fill =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna))) <span class="sc">+</span></span>
<span id="cb70-402"><a href="#cb70-402" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_bar</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">width =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb70-403"><a href="#cb70-403" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-404"><a href="#cb70-404" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(kolumna) <span class="sc">+</span></span>
<span id="cb70-405"><a href="#cb70-405" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>))</span>
<span id="cb70-406"><a href="#cb70-406" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb70-407"><a href="#cb70-407" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb70-408"><a href="#cb70-408" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"pie"</span>) {</span>
<span id="cb70-409"><a href="#cb70-409" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> dane <span class="sc">%&gt;%</span></span>
<span id="cb70-410"><a href="#cb70-410" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(<span class="sc">!!</span><span class="fu">sym</span>(kolumna)) <span class="sc">%&gt;%</span></span>
<span id="cb70-411"><a href="#cb70-411" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> n, <span class="at">fill =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna))) <span class="sc">+</span></span>
<span id="cb70-412"><a href="#cb70-412" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb70-413"><a href="#cb70-413" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb70-414"><a href="#cb70-414" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb70-415"><a href="#cb70-415" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(kolumna) <span class="sc">+</span></span>
<span id="cb70-416"><a href="#cb70-416" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>))</span>
<span id="cb70-417"><a href="#cb70-417" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb70-418"><a href="#cb70-418" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"histogram"</span>) {</span>
<span id="cb70-419"><a href="#cb70-419" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna))) <span class="sc">+</span></span>
<span id="cb70-420"><a href="#cb70-420" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">"#6AAED9"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb70-421"><a href="#cb70-421" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-422"><a href="#cb70-422" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(kolumna)</span>
<span id="cb70-423"><a href="#cb70-423" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb70-424"><a href="#cb70-424" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb70-425"><a href="#cb70-425" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (typ_wykresu <span class="sc">==</span> <span class="st">"violin"</span>) {</span>
<span id="cb70-426"><a href="#cb70-426" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">sym</span>(kolumna), <span class="at">fill =</span> <span class="st">"#6AAED9"</span>)) <span class="sc">+</span></span>
<span id="cb70-427"><a href="#cb70-427" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_violin</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb70-428"><a href="#cb70-428" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-429"><a href="#cb70-429" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(kolumna) <span class="sc">+</span></span>
<span id="cb70-430"><a href="#cb70-430" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>))</span>
<span id="cb70-431"><a href="#cb70-431" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb70-432"><a href="#cb70-432" aria-hidden="true" tabindex="-1"></a>      <span class="cf">next</span>  <span class="co"># pomiń jeśli nieznany typ wykresu</span></span>
<span id="cb70-433"><a href="#cb70-433" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb70-434"><a href="#cb70-434" aria-hidden="true" tabindex="-1"></a>    my_plots[[i]] <span class="ot">&lt;-</span> p</span>
<span id="cb70-435"><a href="#cb70-435" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb70-436"><a href="#cb70-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-437"><a href="#cb70-437" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-438"><a href="#cb70-438" aria-hidden="true" tabindex="-1"></a>gotowy_wykres_1 <span class="ot">&lt;-</span> (my_plots[[<span class="dv">1</span>]] <span class="sc">+</span> my_plots[[<span class="dv">2</span>]]) <span class="sc">/</span> (my_plots[[<span class="dv">3</span>]] <span class="sc">+</span> my_plots[[<span class="dv">4</span>]]) </span>
<span id="cb70-439"><a href="#cb70-439" aria-hidden="true" tabindex="-1"></a>gotowy_wykres_2 <span class="ot">&lt;-</span> (my_plots[[<span class="dv">5</span>]] <span class="sc">+</span> my_plots[[<span class="dv">6</span>]]) <span class="sc">/</span> (my_plots[[<span class="dv">7</span>]] <span class="sc">+</span> my_plots[[<span class="dv">8</span>]])</span>
<span id="cb70-440"><a href="#cb70-440" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"images/plots/"</span>, typ_zmiennej, <span class="st">"_"</span>, typ_wykresu, <span class="st">"1.png"</span>), gotowy_wykres_1)</span>
<span id="cb70-441"><a href="#cb70-441" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"images/plots/"</span>, typ_zmiennej, <span class="st">"_"</span>, typ_wykresu, <span class="st">"2.png"</span>), gotowy_wykres_2)</span>
<span id="cb70-442"><a href="#cb70-442" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-443"><a href="#cb70-443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-444"><a href="#cb70-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-445"><a href="#cb70-445" aria-hidden="true" tabindex="-1"></a>Tak zbudowana funkcja pozwala nam na generowanie wykresów w zależności od:</span>
<span id="cb70-446"><a href="#cb70-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-447"><a href="#cb70-447" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Typu zmiennej</span>
<span id="cb70-448"><a href="#cb70-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-449"><a href="#cb70-449" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Typu wykresu</span>
<span id="cb70-450"><a href="#cb70-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-451"><a href="#cb70-451" aria-hidden="true" tabindex="-1"></a>Dzięki temu możemy szybko i prosto uzyskać wiele wizualizacji na temat interesujących nas zmiennych. Zdecydowaliśmy się przedstawić nasze zmienne z podziałem na:</span>
<span id="cb70-452"><a href="#cb70-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-453"><a href="#cb70-453" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Zmienne typu kategorycznego, przedstawiając liczebność ogólną oraz względem siebie, za pomocą wykresów <span class="in">`barplot`</span> oraz <span class="in">`pie`</span>.</span>
<span id="cb70-454"><a href="#cb70-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-455"><a href="#cb70-455" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Zmienne typu numerycznego, przedstawiając gęstośc oraz rozkład zmiennej, za pomocą wykresów <span class="in">`violin`</span> oraz <span class="in">`histogram`</span></span>
<span id="cb70-456"><a href="#cb70-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-457"><a href="#cb70-457" aria-hidden="true" tabindex="-1"></a>Poniżej przedstawiamy efekty naszej pracy, gdzie przeanalizujemy poszczególne zmienne.</span>
<span id="cb70-458"><a href="#cb70-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-459"><a href="#cb70-459" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zmienne Kategoryczne</span></span>
<span id="cb70-460"><a href="#cb70-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-463"><a href="#cb70-463" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-464"><a href="#cb70-464" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Kategoryczne_Wstep</span></span>
<span id="cb70-465"><a href="#cb70-465" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"kategoryczna"</span>, <span class="st">"barplot"</span>)</span>
<span id="cb70-466"><a href="#cb70-466" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"kategoryczna"</span>, <span class="st">"pie"</span>)</span>
<span id="cb70-467"><a href="#cb70-467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-468"><a href="#cb70-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-469"><a href="#cb70-469" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-470"><a href="#cb70-470" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Barplot</span></span>
<span id="cb70-471"><a href="#cb70-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-472"><a href="#cb70-472" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/kategoryczna_barplot1.png)</span>{fig-align="center"}</span>
<span id="cb70-473"><a href="#cb70-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-474"><a href="#cb70-474" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/kategoryczna_barplot2.png)</span>{fig-align="center"}</span>
<span id="cb70-475"><a href="#cb70-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-476"><a href="#cb70-476" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pie</span></span>
<span id="cb70-477"><a href="#cb70-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-478"><a href="#cb70-478" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/kategoryczna_pie1.png)</span>{fig-align="center"}</span>
<span id="cb70-479"><a href="#cb70-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-480"><a href="#cb70-480" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/kategoryczna_pie2.png)</span>{fig-align="center"}</span>
<span id="cb70-481"><a href="#cb70-481" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-482"><a href="#cb70-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-483"><a href="#cb70-483" aria-hidden="true" tabindex="-1"></a>**Po przeanalizowaniu wykresów nasuwają się nastepujące wnioski:**</span>
<span id="cb70-484"><a href="#cb70-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-485"><a href="#cb70-485" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Analizujemy zbiór ponad 4.000 osób, w którym kobiety lekko przewyższają swoją liczebnością mężczyzn.</span>
<span id="cb70-486"><a href="#cb70-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-487"><a href="#cb70-487" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wraz z poziomem wykształcenia zmniejsza się liczba osób w danej kategorii wykształcenia. Osób bez ukończonej szkoły średniej jest około 1750, stopniowo zmniejszając się do 500 osób z wykształceniem wyższym. Wśród naszych danych przeważają osoby bez wykształcenia lub jedynie z wykształceniem średnim.</span>
<span id="cb70-488"><a href="#cb70-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-489"><a href="#cb70-489" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Podział na osoby palące i niepalące jest jednakowy. Obie grupy zawierają około 2.000 osób.</span>
<span id="cb70-490"><a href="#cb70-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-491"><a href="#cb70-491" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Grupy osób w których skład wchodzą osoby z cukrzycą, osoby leczące nadciśnienie krwi oraz osoby, które przeżyły udar mózgu są bardzo nieliczne. Ograniczają się maksymalnie do kilkudziesięciu osób. Mimo wszystko osoby te mogą dostarczyć wiele cennych informacji w dalszej analizie ryzyka choroby serca.</span>
<span id="cb70-492"><a href="#cb70-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-493"><a href="#cb70-493" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bazujemy na danych w których stosunek liczby osób, u których nie występowało nadciśnienie do liczby osób u których nadciśnienie występowało jest równe w przybliżeniu 2:1.</span>
<span id="cb70-494"><a href="#cb70-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-495"><a href="#cb70-495" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Zmienna predykcyjna <span class="in">`TenYearCHD`</span> przewiduje potencjalne ryzyko choroby serca dla ponad 500 osób, co stanowi około 12.5% liczby wszystkich badanych. Oznacza to, że średnio co 8 badana osoba jest kwalifikowana w grupie ryzyka.</span>
<span id="cb70-496"><a href="#cb70-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-497"><a href="#cb70-497" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zmienne numeryczne</span></span>
<span id="cb70-498"><a href="#cb70-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-501"><a href="#cb70-501" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-502"><a href="#cb70-502" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Numeryczne_Wstep</span></span>
<span id="cb70-503"><a href="#cb70-503" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"numeryczna"</span>, <span class="st">"violin"</span>)</span>
<span id="cb70-504"><a href="#cb70-504" aria-hidden="true" tabindex="-1"></a><span class="fu">zmienna_wykres</span>(badania, <span class="st">"numeryczna"</span>, <span class="st">"histogram"</span>)</span>
<span id="cb70-505"><a href="#cb70-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-506"><a href="#cb70-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-507"><a href="#cb70-507" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-508"><a href="#cb70-508" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Violin</span></span>
<span id="cb70-509"><a href="#cb70-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-510"><a href="#cb70-510" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/numeryczna_violin1.png)</span>{fig-align="center"}</span>
<span id="cb70-511"><a href="#cb70-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-512"><a href="#cb70-512" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/numeryczna_violin2.png)</span>{fig-align="center"}</span>
<span id="cb70-513"><a href="#cb70-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-514"><a href="#cb70-514" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Histogram</span></span>
<span id="cb70-515"><a href="#cb70-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-516"><a href="#cb70-516" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/numeryczna_histogram1.png)</span>{fig-align="center"}</span>
<span id="cb70-517"><a href="#cb70-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-518"><a href="#cb70-518" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/numeryczna_histogram2.png)</span>{fig-align="center"}</span>
<span id="cb70-519"><a href="#cb70-519" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-520"><a href="#cb70-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-521"><a href="#cb70-521" aria-hidden="true" tabindex="-1"></a>**Po przeanalizowaniu wykresów nasuwają się nastepujące wnioski:**</span>
<span id="cb70-522"><a href="#cb70-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-523"><a href="#cb70-523" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Badamy grupę osób, w której większość osób ma od 35 do 65 lat.</span>
<span id="cb70-524"><a href="#cb70-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-525"><a href="#cb70-525" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ciśnienie rozkurczowe zawiera się głównie w przedziale <span class="sc">\&lt;</span>70; 90<span class="sc">\&gt;</span> natomiast ciśnienie skurczowe w przedziale <span class="sc">\&lt;</span>115; 140<span class="sc">\&gt;</span></span>
<span id="cb70-526"><a href="#cb70-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-527"><a href="#cb70-527" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Najczęściej badane osoby posiadają tętno serca na poziomie 70-80 uderzeń na minutę.</span>
<span id="cb70-528"><a href="#cb70-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-529"><a href="#cb70-529" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interesujący jest rozkład zmiennej <span class="in">`cigsPerDay`</span>. Widać znaczący wzrost wystąpień osób palących 20 papierosów dziennie. Dokładnie taka liczba papierosów znajduje się w pojedyńczej paczce. Możemy zatem przyjąć, że dla wielu osób codziennym nawykiem jest wypalenie dokładnie całej paczki w trakcie dnia.</span>
<span id="cb70-530"><a href="#cb70-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-531"><a href="#cb70-531" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Zmienne cechują się niesymetrycznym rozkładem, dodatkowo zaburzone są rozkłady dla zmiennej <span class="in">`age`</span> oraz <span class="in">`cigsPerDay`</span>.</span>
<span id="cb70-532"><a href="#cb70-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-533"><a href="#cb70-533" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Większość zmiennych jest prawostronnie asymetryczna, ciężko mówić o normalności rozkładów ze względu na obecność wartości odstających, które są powszechne wśród danych medycznych.</span>
<span id="cb70-534"><a href="#cb70-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-535"><a href="#cb70-535" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zależności pomiędzy zmiennymi</span></span>
<span id="cb70-536"><a href="#cb70-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-537"><a href="#cb70-537" aria-hidden="true" tabindex="-1"></a>Wśród naszych zmiennych mogą istnieć zależności liniowe. W celu sprawdzenia tego faktu stworzymy macierz korelacji, aby przedstawić jak wygląda korelacja pomiędzy poszczególnymi zmiennymi. Posłużymy się w tym celu zmiennymi numerycznymi.</span>
<span id="cb70-538"><a href="#cb70-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-541"><a href="#cb70-541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-542"><a href="#cb70-542" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Korelacja</span></span>
<span id="cb70-543"><a href="#cb70-543" aria-hidden="true" tabindex="-1"></a>cor_mat <span class="ot">&lt;-</span> badania <span class="sc">%&gt;%</span> </span>
<span id="cb70-544"><a href="#cb70-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-545"><a href="#cb70-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span>
<span id="cb70-546"><a href="#cb70-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-547"><a href="#cb70-547" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(</span>
<span id="cb70-548"><a href="#cb70-548" aria-hidden="true" tabindex="-1"></a>    cor_mat,</span>
<span id="cb70-549"><a href="#cb70-549" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab =</span> <span class="cn">TRUE</span>,               </span>
<span id="cb70-550"><a href="#cb70-550" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"lower"</span>,           </span>
<span id="cb70-551"><a href="#cb70-551" aria-hidden="true" tabindex="-1"></a>    <span class="at">hc.order =</span> <span class="cn">TRUE</span>,          <span class="co">#</span></span>
<span id="cb70-552"><a href="#cb70-552" aria-hidden="true" tabindex="-1"></a>    <span class="at">outline.col =</span> <span class="st">"white"</span>,</span>
<span id="cb70-553"><a href="#cb70-553" aria-hidden="true" tabindex="-1"></a>    <span class="at">ggtheme =</span> ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>(),</span>
<span id="cb70-554"><a href="#cb70-554" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"white"</span>, <span class="st">"#F25041"</span>) </span>
<span id="cb70-555"><a href="#cb70-555" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Macierz Korelacji"</span>)</span>
<span id="cb70-556"><a href="#cb70-556" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/korelacja.jpg"</span>, p)</span>
<span id="cb70-557"><a href="#cb70-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-558"><a href="#cb70-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-559"><a href="#cb70-559" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/korelacja.jpg)</span>{fig-align="center"}</span>
<span id="cb70-560"><a href="#cb70-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-561"><a href="#cb70-561" aria-hidden="true" tabindex="-1"></a>Widzimy, że istnieje duża korelacja równa 0.78 pomiędzy zmiennymi <span class="in">`sysBP`</span> oraz <span class="in">`diaBP`</span>. Nie powinno nas to specjalnie dziwić, ponieważ wartość ciśnienia rozkurczowego ma bezpośredni wypływ na wartość ciśnienia skurczowego. Dodatkowo poziom BMI a co za tym idzie - nasza waga ma wpływ na wartośc ciśnienia rozkurczowego oraz skurczowego. W oczy może rzucić nam się również wartość korelacji na poziomie -0.19 między zmienną <span class="in">`age`</span> oraz <span class="in">`cigsPerDay`</span>, która oznacza, że wraz z wiekiem palimy coraz mniej papierosów dziennie. Nie są to jednak wysokie wartości współczynnika korelacji, więc nie możemy powiedzieć, że pomiędzy tymi zmiennymi istnieje statystycznie istotna korelacja. Możemy jedna informacje traktować jako wskazówki podczas dalszej analizy i zgłębić analizę w kierunku tych zmiennych.</span>
<span id="cb70-562"><a href="#cb70-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-563"><a href="#cb70-563" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-dismissible .alert-danger}</span>
<span id="cb70-564"><a href="#cb70-564" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">"button"</span><span class="ot"> class</span><span class="op">=</span><span class="st">"btn-close"</span><span class="ot"> data-bs-dismiss</span><span class="op">=</span><span class="st">"alert"</span><span class="dt">&gt;</span></span>
<span id="cb70-565"><a href="#cb70-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-566"><a href="#cb70-566" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb70-567"><a href="#cb70-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-568"><a href="#cb70-568" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">strong</span><span class="dt">&gt;</span>Weryfikacja Hipotezy<span class="dt">&lt;/</span><span class="kw">strong</span><span class="dt">&gt;</span></span>
<span id="cb70-569"><a href="#cb70-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-570"><a href="#cb70-570" aria-hidden="true" tabindex="-1"></a>$H_0$ : Nie istnieje zależność liniowa pomiędzy jakąkolwiek parą zmiennych.</span>
<span id="cb70-571"><a href="#cb70-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-572"><a href="#cb70-572" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">strong</span><span class="dt">&gt;</span>Nie.<span class="dt">&lt;/</span><span class="kw">strong</span><span class="dt">&gt;</span> Istnieje jedna para zmiennych silnie skorelowanych. Są to zmienne <span class="in">`sysBP`</span> oraz <span class="in">`diaBP`</span>. Wartość korelacji dla tych zmiennych wynosi 0.78.</span>
<span id="cb70-573"><a href="#cb70-573" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-574"><a href="#cb70-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-575"><a href="#cb70-575" aria-hidden="true" tabindex="-1"></a><span class="fu">### Relacja pomiędzy diaBP oraz sysBP</span></span>
<span id="cb70-576"><a href="#cb70-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-577"><a href="#cb70-577" aria-hidden="true" tabindex="-1"></a>Sprawdźmy jak będzie wyglądać zestawienie wartości ciśnienia skurczowego od wartości ciśnienia rozkurczowego, dodatkowo dodamy kilka czynników, które dotakowo pokażą zależności pomiędzy większą liczbą zmiennych.</span>
<span id="cb70-578"><a href="#cb70-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-581"><a href="#cb70-581" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-582"><a href="#cb70-582" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sysBP_wzgledem_diaBP</span></span>
<span id="cb70-583"><a href="#cb70-583" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">y =</span> sysBP, <span class="at">color =</span> sex, <span class="at">shape =</span> sex)) <span class="sc">+</span></span>
<span id="cb70-584"><a href="#cb70-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb70-585"><a href="#cb70-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-586"><a href="#cb70-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"sysBP ~ diaBP"</span>) <span class="sc">+</span></span>
<span id="cb70-587"><a href="#cb70-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb70-588"><a href="#cb70-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb70-589"><a href="#cb70-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-590"><a href="#cb70-590" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysBP_wzgledem_diaBP.jpg"</span>, p1)</span>
<span id="cb70-591"><a href="#cb70-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-592"><a href="#cb70-592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-593"><a href="#cb70-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-594"><a href="#cb70-594" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/sysBP_wzgledem_diaBP.jpg)</span>{fig-align="center"}</span>
<span id="cb70-595"><a href="#cb70-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-596"><a href="#cb70-596" aria-hidden="true" tabindex="-1"></a>Ze względu na dużą liczbę rekordów, punkty zaznaczone na wykresie typu <span class="in">`scatter plot`</span> tworzą masywną chmurę punktów, utrudniając interpretację. Aby ułatwić analizę na podstawie wykresu posłużymy się wykresami gęstości porównując dodatkowo wpływ innych zmiennych na wartość ciśnienia rozkurczowego oraz skurczowego.</span>
<span id="cb70-597"><a href="#cb70-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-598"><a href="#cb70-598" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ciśnienie rozkurczowe</span></span>
<span id="cb70-599"><a href="#cb70-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-600"><a href="#cb70-600" aria-hidden="true" tabindex="-1"></a>Ciśnienie rozkurczowe to **niższa wartość ciśnienia krwi**, mierzona gdy serce **rozluźnia się między uderzeniami** i napełnia krwią. Jego prawidłowa wartość u osób dorosłych wynosi zwykle około **60-80 mmHg.** Ciśnienie rozkurczowe jest istotnym parametrem mówiącym nam w jaki sposób działa serce. Zdarzają się jednak odstępstwa od prawidłowej pracy serca.</span>
<span id="cb70-601"><a href="#cb70-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-602"><a href="#cb70-602" aria-hidden="true" tabindex="-1"></a>Zbyt wysokie ciśnienie może świadczyć o **nadciśnieniu**, natomiast zbyt niskie o **niedociśnieniu.** Sytuacje te są niebezpieczne dla naszego życia i zdrowia, dlatego w takim przypadku pacjent powinien systematycznie się badać oraz przyjmować odpowiednie leki. Zaburzenia pracy serca objawiające się zawyżoną lub zaniżoną wartością ciśnienia mogą być istotną przyczyną zawału serca.</span>
<span id="cb70-603"><a href="#cb70-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-604"><a href="#cb70-604" aria-hidden="true" tabindex="-1"></a>Sprawdźmy jak wygląda rozkład wartości ciśnienia rozkurczowego względem płci.</span>
<span id="cb70-605"><a href="#cb70-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-608"><a href="#cb70-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-609"><a href="#cb70-609" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: diaBP</span></span>
<span id="cb70-610"><a href="#cb70-610" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb70-611"><a href="#cb70-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-612"><a href="#cb70-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-613"><a href="#cb70-613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of diaBP by Sex"</span>) <span class="sc">+</span></span>
<span id="cb70-614"><a href="#cb70-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-615"><a href="#cb70-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb70-616"><a href="#cb70-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-617"><a href="#cb70-617" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">color =</span> education)) <span class="sc">+</span></span>
<span id="cb70-618"><a href="#cb70-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-619"><a href="#cb70-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-620"><a href="#cb70-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of diaBP by Education Level"</span>) <span class="sc">+</span></span>
<span id="cb70-621"><a href="#cb70-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb70-622"><a href="#cb70-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb70-623"><a href="#cb70-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-624"><a href="#cb70-624" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">color =</span> currentSmoker)) <span class="sc">+</span></span>
<span id="cb70-625"><a href="#cb70-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-626"><a href="#cb70-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-627"><a href="#cb70-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of diaBP by Smoking"</span>) <span class="sc">+</span></span>
<span id="cb70-628"><a href="#cb70-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb70-629"><a href="#cb70-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb70-630"><a href="#cb70-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-631"><a href="#cb70-631" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/diaBP_bySex.jpg"</span>, p1)</span>
<span id="cb70-632"><a href="#cb70-632" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/diaBP_byEducation.jpg"</span>, p2)</span>
<span id="cb70-633"><a href="#cb70-633" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/diaBP_byCurrentSmoker.jpg"</span>, p3)</span>
<span id="cb70-634"><a href="#cb70-634" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-635"><a href="#cb70-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-638"><a href="#cb70-638" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-639"><a href="#cb70-639" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-640"><a href="#cb70-640" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-641"><a href="#cb70-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> diaBP, <span class="at">color =</span> education)) <span class="sc">+</span></span>
<span id="cb70-642"><a href="#cb70-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb70-643"><a href="#cb70-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-644"><a href="#cb70-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>))</span>
<span id="cb70-645"><a href="#cb70-645" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/diabp_boxplot.jpg"</span>, p1)</span>
<span id="cb70-646"><a href="#cb70-646" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-647"><a href="#cb70-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-648"><a href="#cb70-648" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-649"><a href="#cb70-649" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Względem zmiennej sex</span></span>
<span id="cb70-650"><a href="#cb70-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-651"><a href="#cb70-651" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/diaBP_bySex.jpg)</span></span>
<span id="cb70-652"><a href="#cb70-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-653"><a href="#cb70-653" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Względem zmiennej education</span></span>
<span id="cb70-654"><a href="#cb70-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-655"><a href="#cb70-655" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/diaBP_byEducation.jpg)</span>{fig-align="center"}</span>
<span id="cb70-656"><a href="#cb70-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-657"><a href="#cb70-657" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Względem zmiennej currentSmoker</span></span>
<span id="cb70-658"><a href="#cb70-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-659"><a href="#cb70-659" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/diaBP_byCurrentSmoker.jpg)</span>{fig-align="center"}</span>
<span id="cb70-660"><a href="#cb70-660" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-661"><a href="#cb70-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-662"><a href="#cb70-662" aria-hidden="true" tabindex="-1"></a>Analogicznie wpływ edukacji możemy przedstawić następująco:</span>
<span id="cb70-663"><a href="#cb70-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-664"><a href="#cb70-664" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/diabp_boxplot.jpg)</span>{fig-align="center"}</span>
<span id="cb70-665"><a href="#cb70-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-666"><a href="#cb70-666" aria-hidden="true" tabindex="-1"></a>Analizując powyższe wykresy dotyczące rozkładu zmiennej <span class="in">`diaBP`</span> możemy określić następujące wnioski:</span>
<span id="cb70-667"><a href="#cb70-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-668"><a href="#cb70-668" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Rozkłady zmiennej ze względu na płeć są do siebie zbliżone. Są one delikatnie prawostronnie asymetryczne, jednocześnie kobiety mają tendencję do przyjmowania lekko niższych wartości podczas badania.</span>
<span id="cb70-669"><a href="#cb70-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-670"><a href="#cb70-670" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Podział na poziom wykształcenia mówi nam, że rozkłady są między sobą analogiczne z drobnymi odstępstwami. Dla wartości ciśnienia równych około 70mmHg do 80mmHg czyli wartości najczęstszych, większą gęstość mają grupy wykształcenia 3 oraz 4. Widzimy, że osoby z wyższym wykształceniem minimalnie częściej posiadają niższą wartość ciśnienia.</span>
<span id="cb70-671"><a href="#cb70-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-672"><a href="#cb70-672" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wartość ciśnienia rozkurczowego u osób palących jest niższa niż u osób niepalących, wydaje się to nieintuicyjne. Możemy to tłumaczyć faktem, że osoby palące są często młodsze, co łączy się z średnio niższym ciśnieniem. Aby uzasadnić tą tezę sprawdzimy średni wiek oraz medianę w obu grupach.</span>
<span id="cb70-673"><a href="#cb70-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-676"><a href="#cb70-676" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-677"><a href="#cb70-677" aria-hidden="true" tabindex="-1"></a>cisnienie_porownanie <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-678"><a href="#cb70-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(currentSmoker) <span class="sc">|&gt;</span> </span>
<span id="cb70-679"><a href="#cb70-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb70-680"><a href="#cb70-680" aria-hidden="true" tabindex="-1"></a>    <span class="at">Liczebnosc =</span> <span class="fu">n</span>(),</span>
<span id="cb70-681"><a href="#cb70-681" aria-hidden="true" tabindex="-1"></a>    <span class="at">Srednia_wieku =</span> <span class="fu">round</span>(<span class="fu">mean</span>(age), <span class="dv">2</span>),</span>
<span id="cb70-682"><a href="#cb70-682" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mediana_wieku =</span> <span class="fu">median</span>(age)</span>
<span id="cb70-683"><a href="#cb70-683" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-684"><a href="#cb70-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-685"><a href="#cb70-685" aria-hidden="true" tabindex="-1"></a>cisnienie_porownanie</span>
<span id="cb70-686"><a href="#cb70-686" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-687"><a href="#cb70-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-688"><a href="#cb70-688" aria-hidden="true" tabindex="-1"></a>Widać, że osoby palące są średnio młodsze, co przekłada się na zaburzenie wcześniej omawianych rozkładów oraz fakt, że wiek jest nawet ważniejszym czynnikiem wpływającym na wartość ciśnienia, niż fakt czy osoba pali. Nie powinno nas to dziwić, ponieważ z upływem lat serce człowieka słabnie, a zakres jego pracy ulega zmianie, szczególnie podczas obecności chorób układu sercowo-naczyniowego oraz ukłądu oddechowego.</span>
<span id="cb70-689"><a href="#cb70-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-690"><a href="#cb70-690" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ciśnienie skurczowe</span></span>
<span id="cb70-691"><a href="#cb70-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-692"><a href="#cb70-692" aria-hidden="true" tabindex="-1"></a>Ciśnienie skurczowe to wyższa wartość ciśnienia krwi, mierzona w momencie skurczu serca, gdy mięsień sercowy kurczy się i wypycha krew do tętnic. Jego prawidłowa wartość u osób dorosłych wynosi zazwyczaj około 100–120 mmHg. Ciśnienie skurczowe jest ważnym wskaźnikiem siły, z jaką serce pompuje krew oraz stanu naczyń krwionośnych. Odchylenia od normy mogą świadczyć o zaburzeniach w pracy układu krążenia.</span>
<span id="cb70-693"><a href="#cb70-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-694"><a href="#cb70-694" aria-hidden="true" tabindex="-1"></a>Zbyt wysokie ciśnienie skurczowe może wskazywać na nadciśnienie tętnicze i prowadzić do uszkodzenia naczyń krwionośnych oraz narządów wewnętrznych, natomiast zbyt niskie może być objawem osłabionej pracy serca lub odwodnienia organizmu. Oba stany są groźne dla zdrowia i życia, dlatego wymagają regularnej kontroli oraz, w razie potrzeby, odpowiedniego leczenia. Nieprawidłowe wartości ciśnienia skurczowego mogą zwiększać ryzyko poważnych powikłań, takich jak zawał serca czy udar mózgu.</span>
<span id="cb70-695"><a href="#cb70-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-696"><a href="#cb70-696" aria-hidden="true" tabindex="-1"></a>Analogicznie postepujemy dla zmiennej <span class="in">`sysBP`</span>. Pamiętamy że omawiane zmienne są silnie ze sobą skorelowane, więc spodziewamy się podobnych rezultatów.</span>
<span id="cb70-697"><a href="#cb70-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-700"><a href="#cb70-700" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-701"><a href="#cb70-701" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sysBP</span></span>
<span id="cb70-702"><a href="#cb70-702" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> sysBP, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb70-703"><a href="#cb70-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-704"><a href="#cb70-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-705"><a href="#cb70-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of sysBP by Sex"</span>) <span class="sc">+</span></span>
<span id="cb70-706"><a href="#cb70-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-707"><a href="#cb70-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb70-708"><a href="#cb70-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-709"><a href="#cb70-709" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> sysBP, <span class="at">color =</span> education)) <span class="sc">+</span></span>
<span id="cb70-710"><a href="#cb70-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-711"><a href="#cb70-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-712"><a href="#cb70-712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of sysBP by Education Level"</span>) <span class="sc">+</span></span>
<span id="cb70-713"><a href="#cb70-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb70-714"><a href="#cb70-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb70-715"><a href="#cb70-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-716"><a href="#cb70-716" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(badania, <span class="fu">aes</span>(<span class="at">x =</span> sysBP, <span class="at">color =</span> currentSmoker)) <span class="sc">+</span></span>
<span id="cb70-717"><a href="#cb70-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-718"><a href="#cb70-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-719"><a href="#cb70-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of sysBP by Smoking"</span>) <span class="sc">+</span></span>
<span id="cb70-720"><a href="#cb70-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb70-721"><a href="#cb70-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb70-722"><a href="#cb70-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-723"><a href="#cb70-723" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysBP_bySex.jpg"</span>, p1)</span>
<span id="cb70-724"><a href="#cb70-724" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysBP_byEducation.jpg"</span>, p2)</span>
<span id="cb70-725"><a href="#cb70-725" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysBP_byCurrentSmoker.jpg"</span>, p3)</span>
<span id="cb70-726"><a href="#cb70-726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-727"><a href="#cb70-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-730"><a href="#cb70-730" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-731"><a href="#cb70-731" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-732"><a href="#cb70-732" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-733"><a href="#cb70-733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> sysBP, <span class="at">color =</span> education)) <span class="sc">+</span></span>
<span id="cb70-734"><a href="#cb70-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb70-735"><a href="#cb70-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-736"><a href="#cb70-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>))</span>
<span id="cb70-737"><a href="#cb70-737" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/sysbp_boxplot.jpg"</span>, p1)</span>
<span id="cb70-738"><a href="#cb70-738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-739"><a href="#cb70-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-740"><a href="#cb70-740" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-741"><a href="#cb70-741" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Względem zmiennej sex</span></span>
<span id="cb70-742"><a href="#cb70-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-743"><a href="#cb70-743" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/sysBP_bySex.jpg)</span>{fig-align="center"}</span>
<span id="cb70-744"><a href="#cb70-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-745"><a href="#cb70-745" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Względem zmiennej education</span></span>
<span id="cb70-746"><a href="#cb70-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-747"><a href="#cb70-747" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/sysBP_byEducation.jpg)</span>{fig-align="center"}</span>
<span id="cb70-748"><a href="#cb70-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-749"><a href="#cb70-749" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Względem zmiennej currentSmoker</span></span>
<span id="cb70-750"><a href="#cb70-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-751"><a href="#cb70-751" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/sysBP_byCurrentSmoker.jpg)</span>{fig-align="center"}</span>
<span id="cb70-752"><a href="#cb70-752" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-753"><a href="#cb70-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-754"><a href="#cb70-754" aria-hidden="true" tabindex="-1"></a>Dla ułatwienia wnioskowania względem poziomu edukacji wykorzystamy <span class="in">`boxplot`</span>.</span>
<span id="cb70-755"><a href="#cb70-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-756"><a href="#cb70-756" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/sysbp_boxplot.jpg)</span>{fig-align="center"}</span>
<span id="cb70-757"><a href="#cb70-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-758"><a href="#cb70-758" aria-hidden="true" tabindex="-1"></a>Analizując powyższe wykresy dotyczące rozkładu zmiennej <span class="in">`sysBP`</span> możemy określić następujące wnioski:</span>
<span id="cb70-759"><a href="#cb70-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-760"><a href="#cb70-760" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Rozkłady zmiennej ze względu na płeć są do siebie podobne. Są one prawostronnie asymetryczne ze względu na występowanie wartości odstających, które są powszechne w medycynie. Widać, że w większości przypadków to mężczyźni mają lekko wyższy poziom ciśnienia skurczowego.</span>
<span id="cb70-761"><a href="#cb70-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-762"><a href="#cb70-762" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Podział na poziom wykształcenia zachowuje się analogicznie do ciśnienia rozkurczowego, osoby z niższym wykształceniem cechują się delikatnie wyższymi wartościami podczas badania ciśnienia</span>
<span id="cb70-763"><a href="#cb70-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-764"><a href="#cb70-764" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ze względu na różnicę wieku w grupie osób palących i niepalących możemy wysnuć podobne wnioski jak wcześniej, dokładniejszą analizę dotyczącą wpływu palenia na ryzyko zawału przeprowadzimy później.</span>
<span id="cb70-765"><a href="#cb70-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-766"><a href="#cb70-766" aria-hidden="true" tabindex="-1"></a>Sprawdźmy jakie wartości ciśnień cechują osoby ze względu na ryzyko zawału.</span>
<span id="cb70-767"><a href="#cb70-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-770"><a href="#cb70-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-771"><a href="#cb70-771" aria-hidden="true" tabindex="-1"></a>cisnienie_w_grupach <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-772"><a href="#cb70-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TenYearCHD) <span class="sc">|&gt;</span> </span>
<span id="cb70-773"><a href="#cb70-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb70-774"><a href="#cb70-774" aria-hidden="true" tabindex="-1"></a>    <span class="at">Srednia_sysBP =</span> <span class="fu">mean</span>(sysBP),</span>
<span id="cb70-775"><a href="#cb70-775" aria-hidden="true" tabindex="-1"></a>    <span class="at">Srednia_diaBP =</span> <span class="fu">mean</span>(diaBP),</span>
<span id="cb70-776"><a href="#cb70-776" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mediana_sysBP =</span> <span class="fu">median</span>(sysBP),</span>
<span id="cb70-777"><a href="#cb70-777" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mediana_diaBP =</span> <span class="fu">median</span>(diaBP)</span>
<span id="cb70-778"><a href="#cb70-778" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-779"><a href="#cb70-779" aria-hidden="true" tabindex="-1"></a>cisnienie_w_grupach</span>
<span id="cb70-780"><a href="#cb70-780" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-781"><a href="#cb70-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-782"><a href="#cb70-782" aria-hidden="true" tabindex="-1"></a>Jak widać wszystkie wartości są wyższe dla osób w grupie ryzyka.</span>
<span id="cb70-783"><a href="#cb70-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-784"><a href="#cb70-784" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-dismissible .alert-danger}</span>
<span id="cb70-785"><a href="#cb70-785" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">"button"</span><span class="ot"> class</span><span class="op">=</span><span class="st">"btn-close"</span><span class="ot"> data-bs-dismiss</span><span class="op">=</span><span class="st">"alert"</span><span class="dt">&gt;</span></span>
<span id="cb70-786"><a href="#cb70-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-787"><a href="#cb70-787" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb70-788"><a href="#cb70-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-789"><a href="#cb70-789" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">strong</span><span class="dt">&gt;</span>Weryfikacja Hipotezy<span class="dt">&lt;/</span><span class="kw">strong</span><span class="dt">&gt;</span></span>
<span id="cb70-790"><a href="#cb70-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-791"><a href="#cb70-791" aria-hidden="true" tabindex="-1"></a>$H_0$ : Ciśnienie serca jest istotnym czynnikiem powodującym zawał serca.</span>
<span id="cb70-792"><a href="#cb70-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-793"><a href="#cb70-793" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">strong</span><span class="dt">&gt;</span>Tak.<span class="dt">&lt;/</span><span class="kw">strong</span><span class="dt">&gt;</span> Podwyższone ciśnienie skurczowe i rozkurczowe przez dłuższy okres negatywnie wpływają na pracę układu sercowo-naczyniowego oraz zwiększają ryzyko wystapienia choroby wieńcowej.</span>
<span id="cb70-794"><a href="#cb70-794" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-795"><a href="#cb70-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-796"><a href="#cb70-796" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zakres pracy serca, a ryzyko zawału</span></span>
<span id="cb70-797"><a href="#cb70-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-798"><a href="#cb70-798" aria-hidden="true" tabindex="-1"></a>Zakres pracy serca, określany jako różnica pomiędzy ciśnieniem skurczowym (sysBP) a rozkurczowym (diaBP), nazywany jest również **ciśnieniem tętna**. Wartość ta odzwierciedla elastyczność naczyń krwionośnych oraz siłę, z jaką serce wypompowuje krew do układu krążenia. U osób dorosłych prawidłowy zakres pracy serca wynosi zazwyczaj około **30–50 mmHg**.</span>
<span id="cb70-799"><a href="#cb70-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-800"><a href="#cb70-800" aria-hidden="true" tabindex="-1"></a>Zbyt wysoki zakres pracy serca może świadczyć o sztywności naczyń krwionośnych, nadciśnieniu tętniczym lub zwiększonym obciążeniu serca, natomiast zbyt niski może wskazywać na osłabioną kurczliwość mięśnia sercowego, niewydolność serca lub znaczne obniżenie ciśnienia krwi. Oba te stany są niekorzystne dla zdrowia i mogą prowadzić do poważnych powikłań. Nieprawidłowa różnica pomiędzy ciśnieniem skurczowym a rozkurczowym zwiększa ryzyko chorób sercowo-naczyniowych, w tym zawału serca, dlatego regularna kontrola parametrów ciśnienia krwi jest niezwykle istotna.</span>
<span id="cb70-801"><a href="#cb70-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-804"><a href="#cb70-804" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-805"><a href="#cb70-805" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Pulse_pressure</span></span>
<span id="cb70-806"><a href="#cb70-806" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-807"><a href="#cb70-807" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-808"><a href="#cb70-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">range_diff =</span> sysBP <span class="sc">-</span> diaBP) <span class="sc">|&gt;</span> </span>
<span id="cb70-809"><a href="#cb70-809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(range_diff) <span class="sc">|&gt;</span> </span>
<span id="cb70-810"><a href="#cb70-810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> range_diff, <span class="at">color =</span> TenYearCHD)) <span class="sc">+</span></span>
<span id="cb70-811"><a href="#cb70-811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-812"><a href="#cb70-812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-813"><a href="#cb70-813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-814"><a href="#cb70-814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pulse pressure distribution"</span>, <span class="at">x =</span> <span class="st">"sysBP - diaBP"</span>)</span>
<span id="cb70-815"><a href="#cb70-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-816"><a href="#cb70-816" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-817"><a href="#cb70-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">range_diff =</span> sysBP <span class="sc">-</span> diaBP) <span class="sc">|&gt;</span> </span>
<span id="cb70-818"><a href="#cb70-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(range_diff) <span class="sc">|&gt;</span> </span>
<span id="cb70-819"><a href="#cb70-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> range_diff, <span class="at">color =</span> prevalentHyp)) <span class="sc">+</span></span>
<span id="cb70-820"><a href="#cb70-820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-821"><a href="#cb70-821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-822"><a href="#cb70-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-823"><a href="#cb70-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pulse pressure distribution"</span>, <span class="at">x =</span> <span class="st">"sysBP - diaBP"</span>)</span>
<span id="cb70-824"><a href="#cb70-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-825"><a href="#cb70-825" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-826"><a href="#cb70-826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">range_diff =</span> sysBP <span class="sc">-</span> diaBP) <span class="sc">|&gt;</span> </span>
<span id="cb70-827"><a href="#cb70-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(range_diff) <span class="sc">|&gt;</span> </span>
<span id="cb70-828"><a href="#cb70-828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> range_diff, <span class="at">color =</span> diabetes)) <span class="sc">+</span></span>
<span id="cb70-829"><a href="#cb70-829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-830"><a href="#cb70-830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-831"><a href="#cb70-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>, <span class="st">"#2C5DBF"</span>, <span class="st">"#F25041"</span>)) <span class="sc">+</span></span>
<span id="cb70-832"><a href="#cb70-832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pulse pressure distribution"</span>, <span class="at">x =</span> <span class="st">"sysBP - diaBP"</span>)</span>
<span id="cb70-833"><a href="#cb70-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-834"><a href="#cb70-834" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/pulse_pressure_1.jpg"</span>, p1)</span>
<span id="cb70-835"><a href="#cb70-835" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/pulse_pressure_2.jpg"</span>, p2)</span>
<span id="cb70-836"><a href="#cb70-836" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/pulse_pressure_3.jpg"</span>, p3)</span>
<span id="cb70-837"><a href="#cb70-837" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-838"><a href="#cb70-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-839"><a href="#cb70-839" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-840"><a href="#cb70-840" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Względem zmiennej TenYearCHD</span></span>
<span id="cb70-841"><a href="#cb70-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-842"><a href="#cb70-842" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/pulse_pressure_1.jpg)</span>{fig-align="center"}</span>
<span id="cb70-843"><a href="#cb70-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-844"><a href="#cb70-844" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Względem zmiennej prevalentHyp</span></span>
<span id="cb70-845"><a href="#cb70-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-846"><a href="#cb70-846" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/pulse_pressure_2.jpg)</span>{fig-align="center"}</span>
<span id="cb70-847"><a href="#cb70-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-848"><a href="#cb70-848" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Względem zmiennej diabetes</span></span>
<span id="cb70-849"><a href="#cb70-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-850"><a href="#cb70-850" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/pulse_pressure_3.jpg)</span>{fig-align="center"}</span>
<span id="cb70-851"><a href="#cb70-851" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-852"><a href="#cb70-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-853"><a href="#cb70-853" aria-hidden="true" tabindex="-1"></a>Wpływ pracy zakresu serca możemy przedstawić również następująco:</span>
<span id="cb70-854"><a href="#cb70-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-857"><a href="#cb70-857" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-858"><a href="#cb70-858" aria-hidden="true" tabindex="-1"></a>zakres_pracy_serca <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-859"><a href="#cb70-859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(TenYearCHD) <span class="sc">|&gt;</span> </span>
<span id="cb70-860"><a href="#cb70-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb70-861"><a href="#cb70-861" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sredni_zakres =</span> <span class="fu">mean</span>(sysBP <span class="sc">-</span> diaBP),</span>
<span id="cb70-862"><a href="#cb70-862" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mediana_zakres =</span> <span class="fu">median</span>(sysBP <span class="sc">-</span> diaBP)</span>
<span id="cb70-863"><a href="#cb70-863" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-864"><a href="#cb70-864" aria-hidden="true" tabindex="-1"></a>zakres_pracy_serca</span>
<span id="cb70-865"><a href="#cb70-865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-866"><a href="#cb70-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-869"><a href="#cb70-869" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-870"><a href="#cb70-870" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-871"><a href="#cb70-871" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-872"><a href="#cb70-872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sysBP <span class="sc">-</span> diaBP)) <span class="sc">+</span></span>
<span id="cb70-873"><a href="#cb70-873" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"#6AAED9"</span>) <span class="sc">+</span></span>
<span id="cb70-874"><a href="#cb70-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-875"><a href="#cb70-875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Value of sysBP - diaBP by TenYearCHD"</span>)</span>
<span id="cb70-876"><a href="#cb70-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-877"><a href="#cb70-877" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-878"><a href="#cb70-878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> sysBP <span class="sc">-</span> diaBP, <span class="at">color =</span> TenYearCHD)) <span class="sc">+</span></span>
<span id="cb70-879"><a href="#cb70-879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb70-880"><a href="#cb70-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-881"><a href="#cb70-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span> </span>
<span id="cb70-882"><a href="#cb70-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Value of sysBP - diaBP by TenYearCHD"</span>)</span>
<span id="cb70-883"><a href="#cb70-883" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/zakres_pracy_serca_histogram.png"</span>, p1)</span>
<span id="cb70-884"><a href="#cb70-884" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/zakres_pracy_serca_boxplot.png"</span>, p2)</span>
<span id="cb70-885"><a href="#cb70-885" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-886"><a href="#cb70-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-887"><a href="#cb70-887" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-888"><a href="#cb70-888" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Histogram</span></span>
<span id="cb70-889"><a href="#cb70-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-890"><a href="#cb70-890" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/zakres_pracy_serca_histogram.png)</span>{fig-align="center"}</span>
<span id="cb70-891"><a href="#cb70-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-892"><a href="#cb70-892" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Boxplot</span></span>
<span id="cb70-893"><a href="#cb70-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-894"><a href="#cb70-894" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/zakres_pracy_serca_boxplot.png)</span>{fig-align="center"}</span>
<span id="cb70-895"><a href="#cb70-895" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-896"><a href="#cb70-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-897"><a href="#cb70-897" aria-hidden="true" tabindex="-1"></a>Analizując powyższe wykresy oraz tabele możemy wywnioskować, że osoby w grupie ryzyka zawału serca mają średnio wyższe ciśnienie tętna od osób zdrowych. Wysoki zakres pracy serca działa niekorzystnie w dużym okresie czasu i przyczynia się do osłabienia serca i całego układu krwionośnego. Duża liczba badanych osób posiada ciśnienite tętna wyższe od 50 mmHg, co jest umownie granicznym poziomem prawidłowego zakresu pracy serca. Dodatkowo choroby takie jak nadciśnienie tętnicze oraz cukrzyca negatywnie wpływają na serce oraz zwiększają zakres jego pracy, co dodatkowo je wysila.</span>
<span id="cb70-898"><a href="#cb70-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-899"><a href="#cb70-899" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ciśnienie serca jako przyczyna zawału serca</span></span>
<span id="cb70-900"><a href="#cb70-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-901"><a href="#cb70-901" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Z uzględnieniem płci</span></span>
<span id="cb70-902"><a href="#cb70-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-905"><a href="#cb70-905" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-906"><a href="#cb70-906" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Cisnienie_wzgledem_ryzyka</span></span>
<span id="cb70-907"><a href="#cb70-907" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-908"><a href="#cb70-908" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-909"><a href="#cb70-909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> sysBP, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb70-910"><a href="#cb70-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb70-911"><a href="#cb70-911" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-912"><a href="#cb70-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span> </span>
<span id="cb70-913"><a href="#cb70-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Value of sysBP by Sex"</span>)</span>
<span id="cb70-914"><a href="#cb70-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-915"><a href="#cb70-915" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-916"><a href="#cb70-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> diaBP, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb70-917"><a href="#cb70-917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb70-918"><a href="#cb70-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-919"><a href="#cb70-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-920"><a href="#cb70-920" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Value of diaBP by Sex"</span>)</span>
<span id="cb70-921"><a href="#cb70-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-922"><a href="#cb70-922" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/cisnienie_wzlgedem_ryzyka_bySex_1.png"</span>, p1)</span>
<span id="cb70-923"><a href="#cb70-923" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/cisnienie_wzlgedem_ryzyka_bySex_2.png"</span>, p2)</span>
<span id="cb70-924"><a href="#cb70-924" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-925"><a href="#cb70-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-926"><a href="#cb70-926" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-927"><a href="#cb70-927" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Ciśnienie skurczowe</span></span>
<span id="cb70-928"><a href="#cb70-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-929"><a href="#cb70-929" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/cisnienie_wzlgedem_ryzyka_bySex_1.png)</span>{fig-align="center"}</span>
<span id="cb70-930"><a href="#cb70-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-931"><a href="#cb70-931" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Ciśnienie rozkurczowe</span></span>
<span id="cb70-932"><a href="#cb70-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-933"><a href="#cb70-933" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/cisnienie_wzlgedem_ryzyka_bySex_2.png)</span>{fig-align="center"}</span>
<span id="cb70-934"><a href="#cb70-934" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-935"><a href="#cb70-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-936"><a href="#cb70-936" aria-hidden="true" tabindex="-1"></a>Widzimy, że osoby w grupie ryzyka cechują się średnio wyższymi wartościami mierzonego ciśnienia. Możemy przez to rozumieć, że wyższy poziom ciśnienia wiąże się w pośrednio większym ryzykiem wystąpienia choroby wieńcowej. Rozkłady tych wartości ze względu na płeć badanych osób są do siebie podobne, z delikatną przewagą średniej mężczyzn dla ciśnienia rozkurczowego.</span>
<span id="cb70-937"><a href="#cb70-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-938"><a href="#cb70-938" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Z uwzględnieniem nadciśnienia</span></span>
<span id="cb70-939"><a href="#cb70-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-942"><a href="#cb70-942" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-943"><a href="#cb70-943" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Cisnienie_wzgledem_ryzyka_2</span></span>
<span id="cb70-944"><a href="#cb70-944" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-945"><a href="#cb70-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> sysBP, <span class="at">color =</span> prevalentHyp)) <span class="sc">+</span></span>
<span id="cb70-946"><a href="#cb70-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb70-947"><a href="#cb70-947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-948"><a href="#cb70-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span> </span>
<span id="cb70-949"><a href="#cb70-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Value of sysBP by the fact of prevalent Hypothesis"</span>)</span>
<span id="cb70-950"><a href="#cb70-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-951"><a href="#cb70-951" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-952"><a href="#cb70-952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> diaBP, <span class="at">color =</span> prevalentHyp)) <span class="sc">+</span></span>
<span id="cb70-953"><a href="#cb70-953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb70-954"><a href="#cb70-954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-955"><a href="#cb70-955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-956"><a href="#cb70-956" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"Value of diaBP by the fact of prevalent Hypothesis"</span>)</span>
<span id="cb70-957"><a href="#cb70-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-958"><a href="#cb70-958" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/cisnienie_wzlgedem_ryzyka_byprevHyp_1.png"</span>, p1)</span>
<span id="cb70-959"><a href="#cb70-959" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/cisnienie_wzlgedem_ryzyka_byprevHyp_2.png"</span>, p2)</span>
<span id="cb70-960"><a href="#cb70-960" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-961"><a href="#cb70-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-962"><a href="#cb70-962" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-963"><a href="#cb70-963" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Ciśnienie skurczowe</span></span>
<span id="cb70-964"><a href="#cb70-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-965"><a href="#cb70-965" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/cisnienie_wzlgedem_ryzyka_byprevHyp_1.png)</span>{fig-align="center"}</span>
<span id="cb70-966"><a href="#cb70-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-967"><a href="#cb70-967" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Ciśnienie rozkurczowe</span></span>
<span id="cb70-968"><a href="#cb70-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-969"><a href="#cb70-969" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/cisnienie_wzlgedem_ryzyka_byprevHyp_2.png)</span>{fig-align="center"}</span>
<span id="cb70-970"><a href="#cb70-970" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-971"><a href="#cb70-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-972"><a href="#cb70-972" aria-hidden="true" tabindex="-1"></a>Biorąc pod uwagę fakt wystepowania nadciśnienia tętniczego widzimy, że ma on istotny wpływ w ocenie ryzka choroby. Jednocześnie wartości ciśnienia skurczowego jak i rozkurczowego są znacząco wyższe wśród osób z przewlekłym nadciśnieniem tętniczy. Widać, że pierwszy kwartyl osób <span class="in">`prevalentHyp`</span> = <span class="in">`Yes`</span>, zawsze jest ponad trzecim kwartylem osób <span class="in">`prevalenHyp`</span> = <span class="in">`No`</span>.</span>
<span id="cb70-973"><a href="#cb70-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-974"><a href="#cb70-974" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Rozkład wartości ciśnienia</span></span>
<span id="cb70-975"><a href="#cb70-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-978"><a href="#cb70-978" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-979"><a href="#cb70-979" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: rozklad_cisnienia</span></span>
<span id="cb70-980"><a href="#cb70-980" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-981"><a href="#cb70-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-982"><a href="#cb70-982" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-983"><a href="#cb70-983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sysBP, <span class="at">color =</span> TenYearCHD)) <span class="sc">+</span></span>
<span id="cb70-984"><a href="#cb70-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-985"><a href="#cb70-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-986"><a href="#cb70-986" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-987"><a href="#cb70-987" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of sysBP including risk of disease"</span>)</span>
<span id="cb70-988"><a href="#cb70-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-989"><a href="#cb70-989" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-990"><a href="#cb70-990" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">color =</span> TenYearCHD)) <span class="sc">+</span></span>
<span id="cb70-991"><a href="#cb70-991" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-992"><a href="#cb70-992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-993"><a href="#cb70-993" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-994"><a href="#cb70-994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of diaBP including risk of disease"</span>)</span>
<span id="cb70-995"><a href="#cb70-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-996"><a href="#cb70-996" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/rozklad_cisnienia_1.png"</span>, p1)</span>
<span id="cb70-997"><a href="#cb70-997" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/rozklad_cisnienia_2.png"</span>, p2)</span>
<span id="cb70-998"><a href="#cb70-998" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-999"><a href="#cb70-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1000"><a href="#cb70-1000" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-1001"><a href="#cb70-1001" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Ciśnienie skurczowe</span></span>
<span id="cb70-1002"><a href="#cb70-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1003"><a href="#cb70-1003" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/rozklad_cisnienia_1.png)</span>{fig-align="center"}</span>
<span id="cb70-1004"><a href="#cb70-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1005"><a href="#cb70-1005" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Ciśnienie rozkurczowe</span></span>
<span id="cb70-1006"><a href="#cb70-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1007"><a href="#cb70-1007" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/rozklad_cisnienia_2.png)</span>{fig-align="center"}</span>
<span id="cb70-1008"><a href="#cb70-1008" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-1009"><a href="#cb70-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1010"><a href="#cb70-1010" aria-hidden="true" tabindex="-1"></a>W obu przypadkach widzimy przewagę grupy objętej ryzykiem wsród wyższych wartości odpowiednich ciśnień. Potwierdza to nasze dotychczasowe wnioski, że wartości badanego ciśnienia wpływają bezpośrednio na pracę układu sercowo-naczyniowego oraz są jedną z głównych przyczyn wystąpienia zawału serca.</span>
<span id="cb70-1011"><a href="#cb70-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1012"><a href="#cb70-1012" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analiza wartości tętna</span></span>
<span id="cb70-1013"><a href="#cb70-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1016"><a href="#cb70-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1017"><a href="#cb70-1017" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: poziom_tetna</span></span>
<span id="cb70-1018"><a href="#cb70-1018" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-1019"><a href="#cb70-1019" aria-hidden="true" tabindex="-1"></a>bins <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(badania<span class="sc">$</span>heartRate), <span class="fu">max</span>(badania<span class="sc">$</span>heartRate), <span class="at">length.out =</span> <span class="dv">16</span>)</span>
<span id="cb70-1020"><a href="#cb70-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1021"><a href="#cb70-1021" aria-hidden="true" tabindex="-1"></a>hist_data <span class="ot">&lt;-</span> badania <span class="sc">%&gt;%</span></span>
<span id="cb70-1022"><a href="#cb70-1022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bin =</span> <span class="fu">cut</span>(heartRate, <span class="at">breaks =</span> bins, <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb70-1023"><a href="#cb70-1023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(TenYearCHD, bin) <span class="sc">%&gt;%</span></span>
<span id="cb70-1024"><a href="#cb70-1024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count_adj =</span> <span class="fu">ifelse</span>(TenYearCHD <span class="sc">==</span> <span class="st">"No"</span>, n, <span class="sc">-</span>n))</span>
<span id="cb70-1025"><a href="#cb70-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1026"><a href="#cb70-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1027"><a href="#cb70-1027" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> hist_data <span class="sc">|&gt;</span> </span>
<span id="cb70-1028"><a href="#cb70-1028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bin, <span class="at">y =</span> count_adj, <span class="at">fill =</span> TenYearCHD)) <span class="sc">+</span></span>
<span id="cb70-1029"><a href="#cb70-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb70-1030"><a href="#cb70-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Liczebność w grupie"</span>, <span class="at">x =</span> <span class="st">"Przedziały"</span>) <span class="sc">+</span></span>
<span id="cb70-1031"><a href="#cb70-1031" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1032"><a href="#cb70-1032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-1033"><a href="#cb70-1033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-1034"><a href="#cb70-1034" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb70-1035"><a href="#cb70-1035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of heart rate including risk of disease"</span>) <span class="sc">+</span> </span>
<span id="cb70-1036"><a href="#cb70-1036" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">2.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb70-1037"><a href="#cb70-1037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">7.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb70-1038"><a href="#cb70-1038" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-1039"><a href="#cb70-1039" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/poziom_tetna.png"</span>, p)</span>
<span id="cb70-1040"><a href="#cb70-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1041"><a href="#cb70-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1042"><a href="#cb70-1042" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/poziom_tetna.png)</span>{fig-align="center"}</span>
<span id="cb70-1043"><a href="#cb70-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1044"><a href="#cb70-1044" aria-hidden="true" tabindex="-1"></a>Dla porównania rozkładu w obu grupach użyliśmy wykresu typu <span class="in">`histogram`</span> , wskazując jak wygląda rozkład dla każdej z tych grup. Ze względu na niższą liczbę osób w grupie ryzyka słupki histogramu mają znacznie mniejszą wartość, ale ich rozkład jest podobny do siebie. Większość badanych osób posiada wartość tętna w zakresie od około 64mmHg do 84mmHg co jest prawidłowym zakresem ciśnienia tętniczego. Widać to lepiej na wykresie poniżej, który przedstawia wykres gęstości prawdopodobieństwa dla zmiennej <span class="in">`heartRate`</span> ze względu na osoby zagrożone chorbą oraz nie.</span>
<span id="cb70-1045"><a href="#cb70-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1046"><a href="#cb70-1046" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Rozkład zmiennej</span></span>
<span id="cb70-1047"><a href="#cb70-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1050"><a href="#cb70-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1051"><a href="#cb70-1051" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: rozklad_tetna_gestosc</span></span>
<span id="cb70-1052"><a href="#cb70-1052" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-1053"><a href="#cb70-1053" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1054"><a href="#cb70-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> heartRate, <span class="at">color =</span> TenYearCHD)) <span class="sc">+</span></span>
<span id="cb70-1055"><a href="#cb70-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-1056"><a href="#cb70-1056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1057"><a href="#cb70-1057" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-1058"><a href="#cb70-1058" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Heart rate distribution including TenYearCHD"</span>)</span>
<span id="cb70-1059"><a href="#cb70-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1060"><a href="#cb70-1060" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1061"><a href="#cb70-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> heartRate, <span class="at">color =</span> diabetes)) <span class="sc">+</span></span>
<span id="cb70-1062"><a href="#cb70-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-1063"><a href="#cb70-1063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1064"><a href="#cb70-1064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-1065"><a href="#cb70-1065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Heart rate distribution including diabetes"</span>)</span>
<span id="cb70-1066"><a href="#cb70-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1067"><a href="#cb70-1067" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1068"><a href="#cb70-1068" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> diabetes, <span class="at">y =</span> heartRate, <span class="at">color =</span> diabetes)) <span class="sc">+</span></span>
<span id="cb70-1069"><a href="#cb70-1069" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb70-1070"><a href="#cb70-1070" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1071"><a href="#cb70-1071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-1072"><a href="#cb70-1072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Heart rate distribution including diabetes"</span>)</span>
<span id="cb70-1073"><a href="#cb70-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1074"><a href="#cb70-1074" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/rozklad_tetna_gestosc_CHD.png"</span>, p1)</span>
<span id="cb70-1075"><a href="#cb70-1075" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/rozklad_tetna_gestosc_diabetes.png"</span>, p2)</span>
<span id="cb70-1076"><a href="#cb70-1076" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/rozklad_tetna_gestosc_diabetes_boxplot.png"</span>, p3)</span>
<span id="cb70-1077"><a href="#cb70-1077" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1078"><a href="#cb70-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1079"><a href="#cb70-1079" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-1080"><a href="#cb70-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Względem TenYearCHD</span></span>
<span id="cb70-1081"><a href="#cb70-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1082"><a href="#cb70-1082" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/rozklad_tetna_gestosc.png)</span>{fig-align="center"}</span>
<span id="cb70-1083"><a href="#cb70-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1084"><a href="#cb70-1084" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Względem diabetes</span></span>
<span id="cb70-1085"><a href="#cb70-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1086"><a href="#cb70-1086" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/rozklad_tetna_gestosc_diabetes.png)</span>{fig-align="center"}</span>
<span id="cb70-1087"><a href="#cb70-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1088"><a href="#cb70-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Względem diabetes - boxplot</span></span>
<span id="cb70-1089"><a href="#cb70-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1090"><a href="#cb70-1090" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/rozklad_tetna_gestosc_diabetes_boxplot.png)</span>{fig-align="center"}</span>
<span id="cb70-1091"><a href="#cb70-1091" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-1092"><a href="#cb70-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1093"><a href="#cb70-1093" aria-hidden="true" tabindex="-1"></a>Na podstawie powyższych wykresów możemy twierdzić, że ciśnienie tętnicze wpływa delikatnie na fakt, czy daną osobę kwalifikujemy do grupy ryzyka, szczególnie jeżeli poziom tego ciśnienia jest wyższy niż 80mmHg. Dodatkowo możemy zauważyć fakt, że cukrzyca wpływa na zmianę ciśnienia tętniczego i podwyższa je względem osób zdrowych. Zatem cukrzyca jest czynnikiem podnoszącym ciśnienie tętnicze.</span>
<span id="cb70-1094"><a href="#cb70-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1095"><a href="#cb70-1095" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Poziom tętna ze względu na inne zmienne</span></span>
<span id="cb70-1096"><a href="#cb70-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1099"><a href="#cb70-1099" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1100"><a href="#cb70-1100" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: heartRate_by</span></span>
<span id="cb70-1101"><a href="#cb70-1101" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-1102"><a href="#cb70-1102" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1103"><a href="#cb70-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> heartRate, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb70-1104"><a href="#cb70-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb70-1105"><a href="#cb70-1105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1106"><a href="#cb70-1106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-1107"><a href="#cb70-1107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"heartRate ~ TenYearCHD"</span>)</span>
<span id="cb70-1108"><a href="#cb70-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1109"><a href="#cb70-1109" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1110"><a href="#cb70-1110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> heartRate, <span class="at">color =</span> currentSmoker)) <span class="sc">+</span></span>
<span id="cb70-1111"><a href="#cb70-1111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb70-1112"><a href="#cb70-1112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1113"><a href="#cb70-1113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-1114"><a href="#cb70-1114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"heartRate ~ TenYearCHD"</span>)</span>
<span id="cb70-1115"><a href="#cb70-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1116"><a href="#cb70-1116" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1117"><a href="#cb70-1117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TenYearCHD, <span class="at">y =</span> heartRate, <span class="at">color =</span> BPMeds)) <span class="sc">+</span></span>
<span id="cb70-1118"><a href="#cb70-1118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb70-1119"><a href="#cb70-1119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1120"><a href="#cb70-1120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-1121"><a href="#cb70-1121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"heartRate ~ TenYearCHD"</span>)</span>
<span id="cb70-1122"><a href="#cb70-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1123"><a href="#cb70-1123" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/heartRate_bySex.png"</span>, p1)</span>
<span id="cb70-1124"><a href="#cb70-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/heartRate_bycurrentSmoker.png"</span>, p2)</span>
<span id="cb70-1125"><a href="#cb70-1125" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/heartRate_byBPMeds.png"</span>, p3)</span>
<span id="cb70-1126"><a href="#cb70-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1127"><a href="#cb70-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1128"><a href="#cb70-1128" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-1129"><a href="#cb70-1129" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Zmienna sex</span></span>
<span id="cb70-1130"><a href="#cb70-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1131"><a href="#cb70-1131" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/heartRate_bySex.png)</span>{fig-align="center"}</span>
<span id="cb70-1132"><a href="#cb70-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1133"><a href="#cb70-1133" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Zmienna currentSmoker</span></span>
<span id="cb70-1134"><a href="#cb70-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1135"><a href="#cb70-1135" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/heartRate_bycurrentSmoker.png)</span>{fig-align="center"}</span>
<span id="cb70-1136"><a href="#cb70-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1137"><a href="#cb70-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Zmienna BPMeds</span></span>
<span id="cb70-1138"><a href="#cb70-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1139"><a href="#cb70-1139" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/heartRate_byBPMeds.png)</span>{fig-align="center"}</span>
<span id="cb70-1140"><a href="#cb70-1140" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-1141"><a href="#cb70-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1142"><a href="#cb70-1142" aria-hidden="true" tabindex="-1"></a>Analizując wykresy zależności ciśnienia tętniczego od innych zmiennych możemy zauważyć:</span>
<span id="cb70-1143"><a href="#cb70-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1144"><a href="#cb70-1144" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Kobiety posiadają lekko wyższe wartości ciśnienia tętniczego, brak znaczących różnić w grupach osób zdrowych i zagrożonych ryzykiem. Osoby zdrowe posiadają więcej wartości odstających co świadczy o tym, że sam fakt odmiennej wartości ciśnienia nie wiąże się od razu z kwalifikacją osoby do osób zagrożonych zawałem serca.</span>
<span id="cb70-1145"><a href="#cb70-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1146"><a href="#cb70-1146" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Palenie zwiększa delikatnie ciśnienie tętniecze, jest to jednak delikatny wpływ tego czynnika.</span>
<span id="cb70-1147"><a href="#cb70-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1148"><a href="#cb70-1148" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Do osób zagrożonych zaliczamy często osoby z wysokim ciśnieniem tętniczym, które przyjmują leki obniżające ciśnienie.</span>
<span id="cb70-1149"><a href="#cb70-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1150"><a href="#cb70-1150" aria-hidden="true" tabindex="-1"></a><span class="fu">### Leki na nadciśnienie i ich skutek</span></span>
<span id="cb70-1151"><a href="#cb70-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1154"><a href="#cb70-1154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1155"><a href="#cb70-1155" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: leki_nadcisnienie</span></span>
<span id="cb70-1156"><a href="#cb70-1156" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-1157"><a href="#cb70-1157" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1158"><a href="#cb70-1158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sysBP, <span class="at">color =</span> BPMeds)) <span class="sc">+</span></span>
<span id="cb70-1159"><a href="#cb70-1159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-1160"><a href="#cb70-1160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1161"><a href="#cb70-1161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>))</span>
<span id="cb70-1162"><a href="#cb70-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1163"><a href="#cb70-1163" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1164"><a href="#cb70-1164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> diaBP, <span class="at">color =</span> BPMeds)) <span class="sc">+</span></span>
<span id="cb70-1165"><a href="#cb70-1165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-1166"><a href="#cb70-1166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1167"><a href="#cb70-1167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>))</span>
<span id="cb70-1168"><a href="#cb70-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1169"><a href="#cb70-1169" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/leki_nadcisnienie_rozklad1.png"</span>, p1)</span>
<span id="cb70-1170"><a href="#cb70-1170" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/leki_nadcisnienie_rozklad2.png"</span>, p2)</span>
<span id="cb70-1171"><a href="#cb70-1171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1172"><a href="#cb70-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1173"><a href="#cb70-1173" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-1174"><a href="#cb70-1174" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ciśnienie skurczowe</span></span>
<span id="cb70-1175"><a href="#cb70-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1176"><a href="#cb70-1176" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/leki_nadcisnienie_rozklad1.png)</span>{fig-align="center"}</span>
<span id="cb70-1177"><a href="#cb70-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1178"><a href="#cb70-1178" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ciśnienie rozkurczowe</span></span>
<span id="cb70-1179"><a href="#cb70-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1180"><a href="#cb70-1180" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/leki_nadcisnienie_rozklad2.png)</span>{fig-align="center"}</span>
<span id="cb70-1181"><a href="#cb70-1181" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-1182"><a href="#cb70-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1183"><a href="#cb70-1183" aria-hidden="true" tabindex="-1"></a>Wykresy pokazują jasno, że istnieją znaczące rożnice w rozkładzie wartości ciśnienia skurczowego i rozkurczowego względem osób przyjmujących leki na nadciśnienie oraz osób zdrowych. Fakt ten jest oczywistym skutkiem nadciśnienia tętniczego. Osoby przyjmujące takie leki mają znacząco podwyższone ciśnienie. Przyjmowanie takich leków obniża co prawda jego wartość, ale nie na tyle, aby poziom ciśnienia był jednakowy jak u osób zdrowych. Przyjmowanie leków u pacjentów z wysokim poziomem ciśnienia przyczynia się do zmniejszenia ryzyka wystąpienia zawału serca, gdyby nie ten fakt ciśnienie było by jeszcze wyższe, a co za tym idzie - ryzyko choroby wieńcowej byłoby bardzo wysokie, ponieważ ciśnienie jest jednym z głównych predyktorów zawału serca.</span>
<span id="cb70-1184"><a href="#cb70-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1185"><a href="#cb70-1185" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-dismissible .alert-danger}</span>
<span id="cb70-1186"><a href="#cb70-1186" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">"button"</span><span class="ot"> class</span><span class="op">=</span><span class="st">"btn-close"</span><span class="ot"> data-bs-dismiss</span><span class="op">=</span><span class="st">"alert"</span><span class="dt">&gt;</span></span>
<span id="cb70-1187"><a href="#cb70-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1188"><a href="#cb70-1188" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb70-1189"><a href="#cb70-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1190"><a href="#cb70-1190" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">strong</span><span class="dt">&gt;</span>Weryfikacja Hipotezy<span class="dt">&lt;/</span><span class="kw">strong</span><span class="dt">&gt;</span></span>
<span id="cb70-1191"><a href="#cb70-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1192"><a href="#cb70-1192" aria-hidden="true" tabindex="-1"></a>$H_0$ : Leki na nadciśnienie zmniejszają ryzyko choroby wieńcowej.</span>
<span id="cb70-1193"><a href="#cb70-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1194"><a href="#cb70-1194" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">strong</span><span class="dt">&gt;</span>Tak.<span class="dt">&lt;/</span><span class="kw">strong</span><span class="dt">&gt;</span> Osoby z podwyższonym ciśnieniem posiadają większe ryzyko choroby wieńcowej, niż osoby z prawidłowym ciśnieniem, ponieważ ciśnienie jest jednym z głównych predyktorów zawału serca w medycynie. Osoby stosujące leki w celu obniżenia ciśnienia serca w dużej mierze ciągle mają wyższe wyniki niż osoby zdrowe, lecz przyczyniają się tym do zmniejszenia ryzyka zawału serca.</span>
<span id="cb70-1195"><a href="#cb70-1195" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-1196"><a href="#cb70-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1197"><a href="#cb70-1197" aria-hidden="true" tabindex="-1"></a><span class="fu">### Skutki palenia na układ krążenia</span></span>
<span id="cb70-1198"><a href="#cb70-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1201"><a href="#cb70-1201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1202"><a href="#cb70-1202" aria-hidden="true" tabindex="-1"></a>osoby_palace <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1203"><a href="#cb70-1203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(currentSmoker <span class="sc">==</span> <span class="st">"Yes"</span>)</span>
<span id="cb70-1204"><a href="#cb70-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1205"><a href="#cb70-1205" aria-hidden="true" tabindex="-1"></a>osoby_niepalace <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1206"><a href="#cb70-1206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(cigsPerDay <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb70-1207"><a href="#cb70-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1208"><a href="#cb70-1208" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">osoby_palace =</span> <span class="fu">nrow</span>(osoby_palace),</span>
<span id="cb70-1209"><a href="#cb70-1209" aria-hidden="true" tabindex="-1"></a>           <span class="at">osoby_niepalace =</span> <span class="fu">nrow</span>(osoby_niepalace),</span>
<span id="cb70-1210"><a href="#cb70-1210" aria-hidden="true" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="st">"Liczba osób"</span></span>
<span id="cb70-1211"><a href="#cb70-1211" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb70-1212"><a href="#cb70-1212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1213"><a href="#cb70-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1214"><a href="#cb70-1214" aria-hidden="true" tabindex="-1"></a>W badanej grupie pacjentów mamy podobny podział na osoby palące oraz osoby niepalące. Grupy te posiadają około 50% całej próbki.</span>
<span id="cb70-1215"><a href="#cb70-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1216"><a href="#cb70-1216" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Podział pacjentów ze względu na palenie</span></span>
<span id="cb70-1217"><a href="#cb70-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1220"><a href="#cb70-1220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1221"><a href="#cb70-1221" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-1222"><a href="#cb70-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1223"><a href="#cb70-1223" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1224"><a href="#cb70-1224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> currentSmoker, <span class="at">fill =</span> currentSmoker)) <span class="sc">+</span></span>
<span id="cb70-1225"><a href="#cb70-1225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>), <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb70-1226"><a href="#cb70-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1227"><a href="#cb70-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Smokers vs No Smokers"</span>)</span>
<span id="cb70-1228"><a href="#cb70-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1229"><a href="#cb70-1229" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1230"><a href="#cb70-1230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> currentSmoker, <span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb70-1231"><a href="#cb70-1231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">color =</span> <span class="st">"black"</span>,  <span class="at">width =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb70-1232"><a href="#cb70-1232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1233"><a href="#cb70-1233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-1234"><a href="#cb70-1234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Smoking including sex"</span>)</span>
<span id="cb70-1235"><a href="#cb70-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1236"><a href="#cb70-1236" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1237"><a href="#cb70-1237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> currentSmoker, <span class="at">fill =</span> TenYearCHD)) <span class="sc">+</span></span>
<span id="cb70-1238"><a href="#cb70-1238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">color =</span> <span class="st">"black"</span>,  <span class="at">width =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb70-1239"><a href="#cb70-1239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1240"><a href="#cb70-1240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-1241"><a href="#cb70-1241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Smoking including potential risk of disease"</span>)</span>
<span id="cb70-1242"><a href="#cb70-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1243"><a href="#cb70-1243" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/number_of_smokers.png"</span>, p1)</span>
<span id="cb70-1244"><a href="#cb70-1244" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/number_of_smokers_bySex.png"</span>, p2)</span>
<span id="cb70-1245"><a href="#cb70-1245" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/number_of_smokers_byTenYearCHD.png"</span>, p3)</span>
<span id="cb70-1246"><a href="#cb70-1246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1247"><a href="#cb70-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1248"><a href="#cb70-1248" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-1249"><a href="#cb70-1249" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Distribution by Smoking Status</span></span>
<span id="cb70-1250"><a href="#cb70-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1251"><a href="#cb70-1251" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/number_of_smokers.png)</span>{fig-align="center"}</span>
<span id="cb70-1252"><a href="#cb70-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1253"><a href="#cb70-1253" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Number of Smokers by sex</span></span>
<span id="cb70-1254"><a href="#cb70-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1255"><a href="#cb70-1255" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/number_of_smokers_bySex.png)</span>{fig-align="center"}</span>
<span id="cb70-1256"><a href="#cb70-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1257"><a href="#cb70-1257" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Number of smokers including disease risk</span></span>
<span id="cb70-1258"><a href="#cb70-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1259"><a href="#cb70-1259" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/number_of_smokers_byTenYearCHD.png)</span>{fig-align="center"}</span>
<span id="cb70-1260"><a href="#cb70-1260" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-1261"><a href="#cb70-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1262"><a href="#cb70-1262" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Nawyki palenia papierosów</span></span>
<span id="cb70-1263"><a href="#cb70-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1266"><a href="#cb70-1266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1267"><a href="#cb70-1267" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cigs_per_Day</span></span>
<span id="cb70-1268"><a href="#cb70-1268" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-1269"><a href="#cb70-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1270"><a href="#cb70-1270" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1271"><a href="#cb70-1271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> cigsPerDay)) <span class="sc">+</span></span>
<span id="cb70-1272"><a href="#cb70-1272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#6AAED9"</span>) <span class="sc">+</span></span>
<span id="cb70-1273"><a href="#cb70-1273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>()</span>
<span id="cb70-1274"><a href="#cb70-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1275"><a href="#cb70-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1276"><a href="#cb70-1276" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> osoby_palace <span class="sc">|&gt;</span> </span>
<span id="cb70-1277"><a href="#cb70-1277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> cigsPerDay)) <span class="sc">+</span></span>
<span id="cb70-1278"><a href="#cb70-1278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#6AAED9"</span>) <span class="sc">+</span></span>
<span id="cb70-1279"><a href="#cb70-1279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>()</span>
<span id="cb70-1280"><a href="#cb70-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1281"><a href="#cb70-1281" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/cigsPerDay1.png"</span>, p1)</span>
<span id="cb70-1282"><a href="#cb70-1282" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/cigsPerDay2.png"</span>, p2)</span>
<span id="cb70-1283"><a href="#cb70-1283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1284"><a href="#cb70-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1285"><a href="#cb70-1285" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-1286"><a href="#cb70-1286" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Uwzględniając wszystkich pacjentów</span></span>
<span id="cb70-1287"><a href="#cb70-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1288"><a href="#cb70-1288" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/cigsPerDay1.png)</span>{fig-align="center"}</span>
<span id="cb70-1289"><a href="#cb70-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1290"><a href="#cb70-1290" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Uwzględnając tylko osoby palące</span></span>
<span id="cb70-1291"><a href="#cb70-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1292"><a href="#cb70-1292" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/cigsPerDay2.png)</span>{fig-align="center"}</span>
<span id="cb70-1293"><a href="#cb70-1293" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-1294"><a href="#cb70-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1295"><a href="#cb70-1295" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Wpływ poziomu palenia na ryzyko choroby</span></span>
<span id="cb70-1296"><a href="#cb70-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1299"><a href="#cb70-1299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1300"><a href="#cb70-1300" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: impact_of_smkoing</span></span>
<span id="cb70-1301"><a href="#cb70-1301" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-1302"><a href="#cb70-1302" aria-hidden="true" tabindex="-1"></a>paczki <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1303"><a href="#cb70-1303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cigsPerDay, TenYearCHD) <span class="sc">|&gt;</span> </span>
<span id="cb70-1304"><a href="#cb70-1304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-1305"><a href="#cb70-1305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cigsPerDay) <span class="sc">|&gt;</span></span>
<span id="cb70-1306"><a href="#cb70-1306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb70-1307"><a href="#cb70-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1308"><a href="#cb70-1308" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> paczki[<span class="dv">1</span><span class="sc">:</span><span class="dv">28</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb70-1309"><a href="#cb70-1309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cigsPerDay), <span class="at">y =</span> n, <span class="at">fill =</span> <span class="fu">factor</span>(TenYearCHD))) <span class="sc">+</span></span>
<span id="cb70-1310"><a href="#cb70-1310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb70-1311"><a href="#cb70-1311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb70-1312"><a href="#cb70-1312" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Cigarettes per Day"</span>,</span>
<span id="cb70-1313"><a href="#cb70-1313" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Liczba osób"</span>,</span>
<span id="cb70-1314"><a href="#cb70-1314" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"TenYearCHD"</span></span>
<span id="cb70-1315"><a href="#cb70-1315" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb70-1316"><a href="#cb70-1316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1317"><a href="#cb70-1317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-1318"><a href="#cb70-1318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Impact of smoking for potential risk"</span>)</span>
<span id="cb70-1319"><a href="#cb70-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1320"><a href="#cb70-1320" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> paczki[<span class="dv">3</span><span class="sc">:</span><span class="dv">28</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb70-1321"><a href="#cb70-1321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cigsPerDay), <span class="at">y =</span> n, <span class="at">fill =</span> <span class="fu">factor</span>(TenYearCHD))) <span class="sc">+</span></span>
<span id="cb70-1322"><a href="#cb70-1322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb70-1323"><a href="#cb70-1323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb70-1324"><a href="#cb70-1324" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Cigarettes per Day"</span>,</span>
<span id="cb70-1325"><a href="#cb70-1325" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Liczba osób"</span>,</span>
<span id="cb70-1326"><a href="#cb70-1326" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"TenYearCHD"</span></span>
<span id="cb70-1327"><a href="#cb70-1327" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb70-1328"><a href="#cb70-1328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1329"><a href="#cb70-1329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-1330"><a href="#cb70-1330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Impact of smoking for potential risk"</span>)</span>
<span id="cb70-1331"><a href="#cb70-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1332"><a href="#cb70-1332" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> paczki[<span class="dv">29</span><span class="sc">:</span><span class="fu">nrow</span>(paczki), ] <span class="sc">|&gt;</span> </span>
<span id="cb70-1333"><a href="#cb70-1333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cigsPerDay), <span class="at">y =</span> n, <span class="at">fill =</span> <span class="fu">factor</span>(TenYearCHD))) <span class="sc">+</span></span>
<span id="cb70-1334"><a href="#cb70-1334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb70-1335"><a href="#cb70-1335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb70-1336"><a href="#cb70-1336" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Cigarettes per Day"</span>,</span>
<span id="cb70-1337"><a href="#cb70-1337" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Liczba osób"</span>,</span>
<span id="cb70-1338"><a href="#cb70-1338" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"TenYearCHD"</span></span>
<span id="cb70-1339"><a href="#cb70-1339" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb70-1340"><a href="#cb70-1340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1341"><a href="#cb70-1341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-1342"><a href="#cb70-1342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Impact of smoking for potential risk"</span>)</span>
<span id="cb70-1343"><a href="#cb70-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1344"><a href="#cb70-1344" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/impact_of_smoking_all.png"</span>, p1)</span>
<span id="cb70-1345"><a href="#cb70-1345" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/impact_of_smoking_part1.png"</span>, p2)</span>
<span id="cb70-1346"><a href="#cb70-1346" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/impact_of_smoking_part2.png"</span>, p3)</span>
<span id="cb70-1347"><a href="#cb70-1347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1348"><a href="#cb70-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1349"><a href="#cb70-1349" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-1350"><a href="#cb70-1350" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Uwzględniając osoby niepalące</span></span>
<span id="cb70-1351"><a href="#cb70-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1352"><a href="#cb70-1352" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/impact_of_smoking_all.png)</span>{fig-align="center"}</span>
<span id="cb70-1353"><a href="#cb70-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1354"><a href="#cb70-1354" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Osoby palące do 15 papierosów dziennie</span></span>
<span id="cb70-1355"><a href="#cb70-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1356"><a href="#cb70-1356" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/impact_of_smoking_part1.png)</span>{fig-align="center"}</span>
<span id="cb70-1357"><a href="#cb70-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1358"><a href="#cb70-1358" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Osoby palące powyżej 15 papierosów dziennie</span></span>
<span id="cb70-1359"><a href="#cb70-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1360"><a href="#cb70-1360" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/impact_of_smoking_part2.png)</span>{fig-align="center"}</span>
<span id="cb70-1361"><a href="#cb70-1361" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-1362"><a href="#cb70-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1365"><a href="#cb70-1365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1366"><a href="#cb70-1366" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Fraction_of_risk</span></span>
<span id="cb70-1367"><a href="#cb70-1367" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-1368"><a href="#cb70-1368" aria-hidden="true" tabindex="-1"></a>paczki_procenty <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1369"><a href="#cb70-1369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cigsPerDay) <span class="sc">|&gt;</span> </span>
<span id="cb70-1370"><a href="#cb70-1370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cigsSum =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb70-1371"><a href="#cb70-1371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(cigsSum <span class="sc">&gt;</span> <span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-1372"><a href="#cb70-1372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cigsPerDay, TenYearCHD) <span class="sc">|&gt;</span> </span>
<span id="cb70-1373"><a href="#cb70-1373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-1374"><a href="#cb70-1374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cigsPerDay) <span class="sc">|&gt;</span></span>
<span id="cb70-1375"><a href="#cb70-1375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb70-1376"><a href="#cb70-1376" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-1377"><a href="#cb70-1377" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> paczki_procenty <span class="sc">|&gt;</span></span>
<span id="cb70-1378"><a href="#cb70-1378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cigsPerDay),</span>
<span id="cb70-1379"><a href="#cb70-1379" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> perc,</span>
<span id="cb70-1380"><a href="#cb70-1380" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="fu">factor</span>(TenYearCHD)</span>
<span id="cb70-1381"><a href="#cb70-1381" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb70-1382"><a href="#cb70-1382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb70-1383"><a href="#cb70-1383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb70-1384"><a href="#cb70-1384" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Cigarettes per Day"</span>,</span>
<span id="cb70-1385"><a href="#cb70-1385" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Procent"</span>,</span>
<span id="cb70-1386"><a href="#cb70-1386" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Ten-Year CHD"</span></span>
<span id="cb70-1387"><a href="#cb70-1387" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb70-1388"><a href="#cb70-1388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1389"><a href="#cb70-1389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-1390"><a href="#cb70-1390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Fraction of risk group"</span>)</span>
<span id="cb70-1391"><a href="#cb70-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1392"><a href="#cb70-1392" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/fraction.png"</span>, p1)</span>
<span id="cb70-1393"><a href="#cb70-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1394"><a href="#cb70-1394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1395"><a href="#cb70-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1396"><a href="#cb70-1396" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/fraction.png)</span>{fig-align="center"}</span>
<span id="cb70-1397"><a href="#cb70-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1398"><a href="#cb70-1398" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-dismissible .alert-danger}</span>
<span id="cb70-1399"><a href="#cb70-1399" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> type</span><span class="op">=</span><span class="st">"button"</span><span class="ot"> class</span><span class="op">=</span><span class="st">"btn-close"</span><span class="ot"> data-bs-dismiss</span><span class="op">=</span><span class="st">"alert"</span><span class="dt">&gt;</span></span>
<span id="cb70-1400"><a href="#cb70-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1401"><a href="#cb70-1401" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb70-1402"><a href="#cb70-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1403"><a href="#cb70-1403" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">strong</span><span class="dt">&gt;</span>Weryfikacja Hipotezy<span class="dt">&lt;/</span><span class="kw">strong</span><span class="dt">&gt;</span></span>
<span id="cb70-1404"><a href="#cb70-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1405"><a href="#cb70-1405" aria-hidden="true" tabindex="-1"></a>$H_0$ : Palenie zwiększa ryzyko zawału serca.</span>
<span id="cb70-1406"><a href="#cb70-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1407"><a href="#cb70-1407" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">strong</span><span class="dt">&gt;</span>Tak.<span class="dt">&lt;/</span><span class="kw">strong</span><span class="dt">&gt;</span>Palenie wpływa negatywnie na układ sercowo-naczyniowy, podnosi ciśnienie serca oraz działa toksycznie na ludzki organizm. Wraz z liczbą palonych papierosów oraz okresem palenia zwiększa się ryzyko wystąpienia m.in. choroby wieńcowej.</span>
<span id="cb70-1408"><a href="#cb70-1408" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-1409"><a href="#cb70-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1410"><a href="#cb70-1410" aria-hidden="true" tabindex="-1"></a><span class="fu">### Relacja pomiędzy zmienną `age`, a zmienną `cigsPerDay`</span></span>
<span id="cb70-1411"><a href="#cb70-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1414"><a href="#cb70-1414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1415"><a href="#cb70-1415" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: smoking_byAge</span></span>
<span id="cb70-1416"><a href="#cb70-1416" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-1417"><a href="#cb70-1417" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1418"><a href="#cb70-1418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> age, <span class="at">color =</span> currentSmoker)) <span class="sc">+</span></span>
<span id="cb70-1419"><a href="#cb70-1419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">lwd =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb70-1420"><a href="#cb70-1420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1421"><a href="#cb70-1421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-1422"><a href="#cb70-1422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb70-1423"><a href="#cb70-1423" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb70-1424"><a href="#cb70-1424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of age"</span>)</span>
<span id="cb70-1425"><a href="#cb70-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1426"><a href="#cb70-1426" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1427"><a href="#cb70-1427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">color =</span> currentSmoker)) <span class="sc">+</span></span>
<span id="cb70-1428"><a href="#cb70-1428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">lwd =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-1429"><a href="#cb70-1429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span> </span>
<span id="cb70-1430"><a href="#cb70-1430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#6AAED9"</span>, <span class="st">"#F2A391"</span>)) <span class="sc">+</span></span>
<span id="cb70-1431"><a href="#cb70-1431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of age"</span>)</span>
<span id="cb70-1432"><a href="#cb70-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1433"><a href="#cb70-1433" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/smoking_byAge_1.png"</span>, p1)</span>
<span id="cb70-1434"><a href="#cb70-1434" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/smoking_byAge_2.png"</span>, p2)</span>
<span id="cb70-1435"><a href="#cb70-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1436"><a href="#cb70-1436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1437"><a href="#cb70-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1438"><a href="#cb70-1438" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb70-1439"><a href="#cb70-1439" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Boxplot</span></span>
<span id="cb70-1440"><a href="#cb70-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1441"><a href="#cb70-1441" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/smoking_byAge_1.png)</span>{fig-align="center"}</span>
<span id="cb70-1442"><a href="#cb70-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1443"><a href="#cb70-1443" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Density</span></span>
<span id="cb70-1444"><a href="#cb70-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1445"><a href="#cb70-1445" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/smoking_byAge_2.png)</span>{fig-align="center"}</span>
<span id="cb70-1446"><a href="#cb70-1446" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb70-1447"><a href="#cb70-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1450"><a href="#cb70-1450" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1451"><a href="#cb70-1451" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-1452"><a href="#cb70-1452" aria-hidden="true" tabindex="-1"></a>paczki_mean <span class="ot">&lt;-</span> badania <span class="sc">|&gt;</span> </span>
<span id="cb70-1453"><a href="#cb70-1453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cigsPerDay) <span class="sc">|&gt;</span> </span>
<span id="cb70-1454"><a href="#cb70-1454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb70-1455"><a href="#cb70-1455" aria-hidden="true" tabindex="-1"></a>    <span class="at">cigsSum =</span> <span class="fu">n</span>(),</span>
<span id="cb70-1456"><a href="#cb70-1456" aria-hidden="true" tabindex="-1"></a>    <span class="at">sysBP_mean =</span> <span class="fu">mean</span>(sysBP),</span>
<span id="cb70-1457"><a href="#cb70-1457" aria-hidden="true" tabindex="-1"></a>    <span class="at">diaBP_mean =</span> <span class="fu">mean</span>(diaBP)</span>
<span id="cb70-1458"><a href="#cb70-1458" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb70-1459"><a href="#cb70-1459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(cigsSum <span class="sc">&gt;</span> <span class="dv">50</span>)</span>
<span id="cb70-1460"><a href="#cb70-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1461"><a href="#cb70-1461" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> paczki_mean <span class="sc">|&gt;</span> </span>
<span id="cb70-1462"><a href="#cb70-1462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> cigsPerDay)) <span class="sc">+</span></span>
<span id="cb70-1463"><a href="#cb70-1463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> diaBP_mean), <span class="at">lwd =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">"#6AAED9"</span>) <span class="sc">+</span></span>
<span id="cb70-1464"><a href="#cb70-1464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> sysBP_mean), <span class="at">lwd =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">"#F2A391"</span>) <span class="sc">+</span></span>
<span id="cb70-1465"><a href="#cb70-1465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum_rc</span>() <span class="sc">+</span></span>
<span id="cb70-1466"><a href="#cb70-1466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Mean values of sysBP and diaBP including smoking"</span>)</span>
<span id="cb70-1467"><a href="#cb70-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1468"><a href="#cb70-1468" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/mean_BP.png"</span>, p)</span>
<span id="cb70-1469"><a href="#cb70-1469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1470"><a href="#cb70-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1471"><a href="#cb70-1471" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/mean_BP.png)</span>{fig-align="center"}</span>
<span id="cb70-1472"><a href="#cb70-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1475"><a href="#cb70-1475" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1476"><a href="#cb70-1476" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: concatenation</span></span>
<span id="cb70-1477"><a href="#cb70-1477" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb70-1478"><a href="#cb70-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1479"><a href="#cb70-1479" aria-hidden="true" tabindex="-1"></a> p <span class="ot">&lt;-</span> <span class="fu">ggVennDiagram</span>(<span class="fu">list</span>(</span>
<span id="cb70-1480"><a href="#cb70-1480" aria-hidden="true" tabindex="-1"></a>  <span class="at">Udar =</span> <span class="fu">which</span>(badania<span class="sc">$</span>prevalentStroke <span class="sc">==</span> <span class="st">"Yes"</span>),</span>
<span id="cb70-1481"><a href="#cb70-1481" aria-hidden="true" tabindex="-1"></a>  <span class="at">Nadcisnienie =</span> <span class="fu">which</span>(badania<span class="sc">$</span>prevalentHyp <span class="sc">==</span> <span class="st">"Yes"</span>),</span>
<span id="cb70-1482"><a href="#cb70-1482" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ryzyko =</span> <span class="fu">which</span>(badania<span class="sc">$</span>TenYearCHD<span class="sc">==</span> <span class="st">"Yes"</span>)</span>
<span id="cb70-1483"><a href="#cb70-1483" aria-hidden="true" tabindex="-1"></a>), <span class="at">set_size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb70-1484"><a href="#cb70-1484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb70-1485"><a href="#cb70-1485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"#6AAED9"</span>, <span class="at">high =</span> <span class="st">"#F2A391"</span>) <span class="sc">+</span></span>
<span id="cb70-1486"><a href="#cb70-1486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb70-1487"><a href="#cb70-1487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Concatenation of dangerous diseases"</span>)</span>
<span id="cb70-1488"><a href="#cb70-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1489"><a href="#cb70-1489" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/plots/concatenation.png"</span>, p)</span>
<span id="cb70-1490"><a href="#cb70-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1491"><a href="#cb70-1491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1492"><a href="#cb70-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1493"><a href="#cb70-1493" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/plots/concatenation.png)</span>{fig-align="center"}</span>
<span id="cb70-1494"><a href="#cb70-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1495"><a href="#cb70-1495" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model regresji logistycznej</span></span>
<span id="cb70-1496"><a href="#cb70-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1497"><a href="#cb70-1497" aria-hidden="true" tabindex="-1"></a>::DO PRZENIESIENIA !!!::</span>
<span id="cb70-1498"><a href="#cb70-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1501"><a href="#cb70-1501" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1502"><a href="#cb70-1502" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(badania)</span>
<span id="cb70-1503"><a href="#cb70-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1504"><a href="#cb70-1504" aria-hidden="true" tabindex="-1"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(TenYearCHD <span class="sc">~</span> age <span class="sc">+</span> sex <span class="sc">+</span> education <span class="sc">+</span> sysBP <span class="sc">+</span> diaBP <span class="sc">+</span> heartRate <span class="sc">+</span> BMI <span class="sc">+</span></span>
<span id="cb70-1505"><a href="#cb70-1505" aria-hidden="true" tabindex="-1"></a>                     totChol <span class="sc">+</span> glucose <span class="sc">+</span> diabetes <span class="sc">+</span> cigsPerDay <span class="sc">+</span> currentSmoker <span class="sc">+</span> BPMeds <span class="sc">+</span></span>
<span id="cb70-1506"><a href="#cb70-1506" aria-hidden="true" tabindex="-1"></a>                     prevalentStroke <span class="sc">+</span> prevalentHyp,</span>
<span id="cb70-1507"><a href="#cb70-1507" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> badania,</span>
<span id="cb70-1508"><a href="#cb70-1508" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb70-1509"><a href="#cb70-1509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1510"><a href="#cb70-1510" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_model)</span>
<span id="cb70-1511"><a href="#cb70-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1512"><a href="#cb70-1512" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(logit_model))</span>
<span id="cb70-1513"><a href="#cb70-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1514"><a href="#cb70-1514" aria-hidden="true" tabindex="-1"></a>step_model <span class="ot">&lt;-</span> <span class="fu">step</span>(logit_model, <span class="at">direction =</span> <span class="st">"both"</span>)</span>
<span id="cb70-1515"><a href="#cb70-1515" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(step_model)</span>
<span id="cb70-1516"><a href="#cb70-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1517"><a href="#cb70-1517" aria-hidden="true" tabindex="-1"></a>badania<span class="sc">$</span>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_model, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb70-1518"><a href="#cb70-1518" aria-hidden="true" tabindex="-1"></a>badania<span class="sc">$</span>pred_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(badania<span class="sc">$</span>pred_prob <span class="sc">&gt;</span> <span class="fl">0.2</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb70-1519"><a href="#cb70-1519" aria-hidden="true" tabindex="-1"></a>badania<span class="sc">$</span>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(badania<span class="sc">$</span>pred_class, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>))</span>
<span id="cb70-1520"><a href="#cb70-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1521"><a href="#cb70-1521" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb70-1522"><a href="#cb70-1522" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(badania<span class="sc">$</span>TenYearCHD, badania<span class="sc">$</span>pred_prob)</span>
<span id="cb70-1523"><a href="#cb70-1523" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj)</span>
<span id="cb70-1524"><a href="#cb70-1524" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc_obj)</span>
<span id="cb70-1525"><a href="#cb70-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1526"><a href="#cb70-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1527"><a href="#cb70-1527" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb70-1528"><a href="#cb70-1528" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(logit_model)</span>
<span id="cb70-1529"><a href="#cb70-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1530"><a href="#cb70-1530" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="at">Predicted =</span> badania<span class="sc">$</span>pred_class, <span class="at">Actual =</span> badania<span class="sc">$</span>TenYearCHD)</span>
<span id="cb70-1531"><a href="#cb70-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1532"><a href="#cb70-1532" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">mean</span>(badania<span class="sc">$</span>pred_class <span class="sc">==</span> badania<span class="sc">$</span>TenYearCHD)</span>
<span id="cb70-1533"><a href="#cb70-1533" aria-hidden="true" tabindex="-1"></a>accuracy</span>
<span id="cb70-1534"><a href="#cb70-1534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1535"><a href="#cb70-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1538"><a href="#cb70-1538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-1539"><a href="#cb70-1539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-1540"><a href="#cb70-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1541"><a href="#cb70-1541" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb70-1542"><a href="#cb70-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1543"><a href="#cb70-1543" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/article/picture_2.png)</span>{style="margin-top: 25px;" fig-align="center"}</span>
<span id="cb70-1544"><a href="#cb70-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1545"><a href="#cb70-1545" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
</code></pre></div><button title="Kopiuj do schowka" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 IAD III 2026
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Projekt z Zakresu Analizy Danych
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2026 Tomasz Golecki | Tomasz Hanusek | Damian Spodar
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>